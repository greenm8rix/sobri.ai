const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browser-B8H7QXCo.js","assets/vendor-u5qoJQA0.js","assets/web-CR1bmKxy.js","assets/utils-ROlyYH3i.js"])))=>i.map(i=>d[i]);
import{r as e,a as t,g as s,c as r,b as i,d as n,m as a,A as o,u as l}from"./vendor-u5qoJQA0.js";import{f as c,i as d,a as h,s as u,e as m,b as g,g as p,c as f}from"./utils-ROlyYH3i.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var y={exports:{}},x={},v=e,b=Symbol.for("react.element"),w=Symbol.for("react.fragment"),j=Object.prototype.hasOwnProperty,k=v.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,s){var r,i={},n=null,a=null;for(r in void 0!==s&&(n=""+s),void 0!==t.key&&(n=""+t.key),void 0!==t.ref&&(a=t.ref),t)j.call(t,r)&&!_.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:b,type:e,key:n,ref:a,props:i,_owner:k.current}}x.Fragment=w,x.jsx=S,x.jsxs=S,y.exports=x;var N,C=y.exports,E=t;N=E.createRoot,E.hydrateRoot;const T={},I=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),s=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));r=Promise.allSettled(t.map((e=>{if((e=function(e){return"/"+e}(e))in T)return;T[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const i=document.createElement("link");return i.rel=t?"stylesheet":"modulepreload",t||(i.as="script"),i.crossOrigin="",i.href=e,s&&i.setAttribute("nonce",s),document.head.appendChild(i),t?new Promise(((t,s)=>{i.addEventListener("load",t),i.addEventListener("error",(()=>s(new Error(`Unable to preload CSS for ${e}`))))})):void 0})))}function i(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then((t=>{for(const e of t||[])"rejected"===e.status&&i(e.reason);return e().catch(i)}))},A=[];for(let jl=0;jl<256;++jl)A.push((jl+256).toString(16).slice(1));let P;const O=new Uint8Array(16);const R={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function D(e,t,s){var r;if(R.randomUUID&&!t&&!e)return R.randomUUID();const i=(e=e||{}).random??(null==(r=e.rng)?void 0:r.call(e))??function(){if(!P){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");P=crypto.getRandomValues.bind(crypto)}return P(O)}();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=15&i[6]|64,i[8]=63&i[8]|128,function(e,t=0){return(A[e[t+0]]+A[e[t+1]]+A[e[t+2]]+A[e[t+3]]+"-"+A[e[t+4]]+A[e[t+5]]+"-"+A[e[t+6]]+A[e[t+7]]+"-"+A[e[t+8]]+A[e[t+9]]+"-"+A[e[t+10]]+A[e[t+11]]+A[e[t+12]]+A[e[t+13]]+A[e[t+14]]+A[e[t+15]]).toLowerCase()}(i)}const $=(e,t)=>t.some((t=>e instanceof t));let L,M;const B=new WeakMap,z=new WeakMap,U=new WeakMap;let H={get(e,t,s){if(e instanceof IDBTransaction){if("done"===t)return B.get(e);if("store"===t)return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return J(e[t])},set:(e,t,s)=>(e[t]=s,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function F(e){H=e(H)}function q(e){return(M||(M=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(K(this),t),J(this.request)}:function(...t){return J(e.apply(K(this),t))}}function W(e){return"function"==typeof e?q(e):(e instanceof IDBTransaction&&function(e){if(B.has(e))return;const t=new Promise(((t,s)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",n),e.removeEventListener("abort",n)},i=()=>{t(),r()},n=()=>{s(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",n),e.addEventListener("abort",n)}));B.set(e,t)}(e),$(e,L||(L=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,H):e)}function J(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,s)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",n)},i=()=>{t(J(e.result)),r()},n=()=>{s(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",n)}));return U.set(t,e),t}(e);if(z.has(e))return z.get(e);const t=W(e);return t!==e&&(z.set(e,t),U.set(t,e)),t}const K=e=>U.get(e);const G=["get","getKey","getAll","getAllKeys","count"],V=["put","add","delete","clear"],Y=new Map;function X(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Y.get(t))return Y.get(t);const s=t.replace(/FromIndex$/,""),r=t!==s,i=V.includes(s);if(!(s in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!G.includes(s))return;const n=async function(e,...t){const n=this.transaction(e,i?"readwrite":"readonly");let a=n.store;return r&&(a=a.index(t.shift())),(await Promise.all([a[s](...t),i&&n.done]))[0]};return Y.set(t,n),n}F((e=>({...e,get:(t,s,r)=>X(t,s)||e.get(t,s,r),has:(t,s)=>!!X(t,s)||e.has(t,s)})));const Z=["continue","continuePrimaryKey","advance"],Q={},ee=new WeakMap,te=new WeakMap,se={get(e,t){if(!Z.includes(t))return e[t];let s=Q[t];return s||(s=Q[t]=function(...e){ee.set(this,te.get(this)[t](...e))}),s}};async function*re(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;const s=new Proxy(t,se);for(te.set(s,t),U.set(s,K(t));t;)yield s,t=await(ee.get(s)||t.continue()),ee.delete(s)}function ie(e,t){return t===Symbol.asyncIterator&&$(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&$(e,[IDBIndex,IDBObjectStore])}F((e=>({...e,get:(t,s,r)=>ie(t,s)?re:e.get(t,s,r),has:(t,s)=>ie(t,s)||e.has(t,s)})));var ne={exports:{}};var ae={exports:{}};const oe=s(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var le;function ce(){return le||(le=1,ae.exports=(e=e||function(e,t){var s;if("undefined"!=typeof window&&window.crypto&&(s=window.crypto),"undefined"!=typeof self&&self.crypto&&(s=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(s=globalThis.crypto),!s&&"undefined"!=typeof window&&window.msCrypto&&(s=window.msCrypto),!s&&void 0!==r&&r.crypto&&(s=r.crypto),!s)try{s=oe}catch(f){}var i=function(){if(s){if("function"==typeof s.getRandomValues)try{return s.getRandomValues(new Uint32Array(1))[0]}catch(f){}if("function"==typeof s.randomBytes)try{return s.randomBytes(4).readInt32LE()}catch(f){}}throw new Error("Native crypto module could not be used to get secure random number.")},n=Object.create||function(){function e(){}return function(t){var s;return e.prototype=t,s=new e,e.prototype=null,s}}(),a={},o=a.lib={},l=o.Base=function(){return{extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),c=o.WordArray=l.extend({init:function(e,s){e=this.words=e||[],this.sigBytes=s!=t?s:4*e.length},toString:function(e){return(e||h).stringify(this)},concat:function(e){var t=this.words,s=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(var n=0;n<i;n++){var a=s[n>>>2]>>>24-n%4*8&255;t[r+n>>>2]|=a<<24-(r+n)%4*8}else for(var o=0;o<i;o+=4)t[r+o>>>2]=s[o>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,s=this.sigBytes;t[s>>>2]&=4294967295<<32-s%4*8,t.length=e.ceil(s/4)},clone:function(){var e=l.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],s=0;s<e;s+=4)t.push(i());return new c.init(t,e)}}),d=a.enc={},h=d.Hex={stringify:function(e){for(var t=e.words,s=e.sigBytes,r=[],i=0;i<s;i++){var n=t[i>>>2]>>>24-i%4*8&255;r.push((n>>>4).toString(16)),r.push((15&n).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,s=[],r=0;r<t;r+=2)s[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new c.init(s,t/2)}},u=d.Latin1={stringify:function(e){for(var t=e.words,s=e.sigBytes,r=[],i=0;i<s;i++){var n=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(n))}return r.join("")},parse:function(e){for(var t=e.length,s=[],r=0;r<t;r++)s[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new c.init(s,t)}},m=d.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},g=o.BufferedBlockAlgorithm=l.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=m.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var s,r=this._data,i=r.words,n=r.sigBytes,a=this.blockSize,o=n/(4*a),l=(o=t?e.ceil(o):e.max((0|o)-this._minBufferSize,0))*a,d=e.min(4*l,n);if(l){for(var h=0;h<l;h+=a)this._doProcessBlock(i,h);s=i.splice(0,l),r.sigBytes-=d}return new c.init(s,d)},clone:function(){var e=l.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});o.Hasher=g.extend({cfg:l.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){g.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,s){return new e.init(s).finalize(t)}},_createHmacHelper:function(e){return function(t,s){return new p.HMAC.init(e,s).finalize(t)}}});var p=a.algo={};return a}(Math),e)),ae.exports;var e}var de,he={exports:{}};function ue(){return de?he.exports:(de=1,he.exports=(a=ce(),s=(t=a).lib,r=s.Base,i=s.WordArray,(n=t.x64={}).Word=r.extend({init:function(e,t){this.high=e,this.low=t}}),n.WordArray=r.extend({init:function(t,s){t=this.words=t||[],this.sigBytes=s!=e?s:8*t.length},toX32:function(){for(var e=this.words,t=e.length,s=[],r=0;r<t;r++){var n=e[r];s.push(n.high),s.push(n.low)}return i.create(s,this.sigBytes)},clone:function(){for(var e=r.clone.call(this),t=e.words=this.words.slice(0),s=t.length,i=0;i<s;i++)t[i]=t[i].clone();return e}}),a));var e,t,s,r,i,n,a}var me,ge={exports:{}};function pe(){return me||(me=1,ge.exports=(e=ce(),function(){if("function"==typeof ArrayBuffer){var t=e.lib.WordArray,s=t.init,r=t.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var t=e.byteLength,r=[],i=0;i<t;i++)r[i>>>2]|=e[i]<<24-i%4*8;s.call(this,r,t)}else s.apply(this,arguments)};r.prototype=t}}(),e.lib.WordArray)),ge.exports;var e}var fe,ye={exports:{}};function xe(){return fe?ye.exports:(fe=1,ye.exports=(e=ce(),function(){var t=e,s=t.lib.WordArray,r=t.enc;function i(e){return e<<8&4278255360|e>>>8&16711935}r.Utf16=r.Utf16BE={stringify:function(e){for(var t=e.words,s=e.sigBytes,r=[],i=0;i<s;i+=2){var n=t[i>>>2]>>>16-i%4*8&65535;r.push(String.fromCharCode(n))}return r.join("")},parse:function(e){for(var t=e.length,r=[],i=0;i<t;i++)r[i>>>1]|=e.charCodeAt(i)<<16-i%2*16;return s.create(r,2*t)}},r.Utf16LE={stringify:function(e){for(var t=e.words,s=e.sigBytes,r=[],n=0;n<s;n+=2){var a=i(t[n>>>2]>>>16-n%4*8&65535);r.push(String.fromCharCode(a))}return r.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>1]|=i(e.charCodeAt(n)<<16-n%2*16);return s.create(r,2*t)}}}(),e.enc.Utf16));var e}var ve,be={exports:{}};function we(){return ve?be.exports:(ve=1,be.exports=(e=ce(),function(){var t=e,s=t.lib.WordArray;function r(e,t,r){for(var i=[],n=0,a=0;a<t;a++)if(a%4){var o=r[e.charCodeAt(a-1)]<<a%4*2|r[e.charCodeAt(a)]>>>6-a%4*2;i[n>>>2]|=o<<24-n%4*8,n++}return s.create(i,n)}t.enc.Base64={stringify:function(e){var t=e.words,s=e.sigBytes,r=this._map;e.clamp();for(var i=[],n=0;n<s;n+=3)for(var a=(t[n>>>2]>>>24-n%4*8&255)<<16|(t[n+1>>>2]>>>24-(n+1)%4*8&255)<<8|t[n+2>>>2]>>>24-(n+2)%4*8&255,o=0;o<4&&n+.75*o<s;o++)i.push(r.charAt(a>>>6*(3-o)&63));var l=r.charAt(64);if(l)for(;i.length%4;)i.push(l);return i.join("")},parse:function(e){var t=e.length,s=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var n=0;n<s.length;n++)i[s.charCodeAt(n)]=n}var a=s.charAt(64);if(a){var o=e.indexOf(a);-1!==o&&(t=o)}return r(e,t,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64));var e}var je,ke={exports:{}};function _e(){return je?ke.exports:(je=1,ke.exports=(e=ce(),function(){var t=e,s=t.lib.WordArray;function r(e,t,r){for(var i=[],n=0,a=0;a<t;a++)if(a%4){var o=r[e.charCodeAt(a-1)]<<a%4*2|r[e.charCodeAt(a)]>>>6-a%4*2;i[n>>>2]|=o<<24-n%4*8,n++}return s.create(i,n)}t.enc.Base64url={stringify:function(e,t){void 0===t&&(t=!0);var s=e.words,r=e.sigBytes,i=t?this._safe_map:this._map;e.clamp();for(var n=[],a=0;a<r;a+=3)for(var o=(s[a>>>2]>>>24-a%4*8&255)<<16|(s[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|s[a+2>>>2]>>>24-(a+2)%4*8&255,l=0;l<4&&a+.75*l<r;l++)n.push(i.charAt(o>>>6*(3-l)&63));var c=i.charAt(64);if(c)for(;n.length%4;)n.push(c);return n.join("")},parse:function(e,t){void 0===t&&(t=!0);var s=e.length,i=t?this._safe_map:this._map,n=this._reverseMap;if(!n){n=this._reverseMap=[];for(var a=0;a<i.length;a++)n[i.charCodeAt(a)]=a}var o=i.charAt(64);if(o){var l=e.indexOf(o);-1!==l&&(s=l)}return r(e,s,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"}}(),e.enc.Base64url));var e}var Se,Ne={exports:{}};function Ce(){return Se?Ne.exports:(Se=1,Ne.exports=(e=ce(),function(t){var s=e,r=s.lib,i=r.WordArray,n=r.Hasher,a=s.algo,o=[];!function(){for(var e=0;e<64;e++)o[e]=4294967296*t.abs(t.sin(e+1))|0}();var l=a.MD5=n.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var s=0;s<16;s++){var r=t+s,i=e[r];e[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var n=this._hash.words,a=e[t+0],l=e[t+1],m=e[t+2],g=e[t+3],p=e[t+4],f=e[t+5],y=e[t+6],x=e[t+7],v=e[t+8],b=e[t+9],w=e[t+10],j=e[t+11],k=e[t+12],_=e[t+13],S=e[t+14],N=e[t+15],C=n[0],E=n[1],T=n[2],I=n[3];C=c(C,E,T,I,a,7,o[0]),I=c(I,C,E,T,l,12,o[1]),T=c(T,I,C,E,m,17,o[2]),E=c(E,T,I,C,g,22,o[3]),C=c(C,E,T,I,p,7,o[4]),I=c(I,C,E,T,f,12,o[5]),T=c(T,I,C,E,y,17,o[6]),E=c(E,T,I,C,x,22,o[7]),C=c(C,E,T,I,v,7,o[8]),I=c(I,C,E,T,b,12,o[9]),T=c(T,I,C,E,w,17,o[10]),E=c(E,T,I,C,j,22,o[11]),C=c(C,E,T,I,k,7,o[12]),I=c(I,C,E,T,_,12,o[13]),T=c(T,I,C,E,S,17,o[14]),C=d(C,E=c(E,T,I,C,N,22,o[15]),T,I,l,5,o[16]),I=d(I,C,E,T,y,9,o[17]),T=d(T,I,C,E,j,14,o[18]),E=d(E,T,I,C,a,20,o[19]),C=d(C,E,T,I,f,5,o[20]),I=d(I,C,E,T,w,9,o[21]),T=d(T,I,C,E,N,14,o[22]),E=d(E,T,I,C,p,20,o[23]),C=d(C,E,T,I,b,5,o[24]),I=d(I,C,E,T,S,9,o[25]),T=d(T,I,C,E,g,14,o[26]),E=d(E,T,I,C,v,20,o[27]),C=d(C,E,T,I,_,5,o[28]),I=d(I,C,E,T,m,9,o[29]),T=d(T,I,C,E,x,14,o[30]),C=h(C,E=d(E,T,I,C,k,20,o[31]),T,I,f,4,o[32]),I=h(I,C,E,T,v,11,o[33]),T=h(T,I,C,E,j,16,o[34]),E=h(E,T,I,C,S,23,o[35]),C=h(C,E,T,I,l,4,o[36]),I=h(I,C,E,T,p,11,o[37]),T=h(T,I,C,E,x,16,o[38]),E=h(E,T,I,C,w,23,o[39]),C=h(C,E,T,I,_,4,o[40]),I=h(I,C,E,T,a,11,o[41]),T=h(T,I,C,E,g,16,o[42]),E=h(E,T,I,C,y,23,o[43]),C=h(C,E,T,I,b,4,o[44]),I=h(I,C,E,T,k,11,o[45]),T=h(T,I,C,E,N,16,o[46]),C=u(C,E=h(E,T,I,C,m,23,o[47]),T,I,a,6,o[48]),I=u(I,C,E,T,x,10,o[49]),T=u(T,I,C,E,S,15,o[50]),E=u(E,T,I,C,f,21,o[51]),C=u(C,E,T,I,k,6,o[52]),I=u(I,C,E,T,g,10,o[53]),T=u(T,I,C,E,w,15,o[54]),E=u(E,T,I,C,l,21,o[55]),C=u(C,E,T,I,v,6,o[56]),I=u(I,C,E,T,N,10,o[57]),T=u(T,I,C,E,y,15,o[58]),E=u(E,T,I,C,_,21,o[59]),C=u(C,E,T,I,p,6,o[60]),I=u(I,C,E,T,j,10,o[61]),T=u(T,I,C,E,m,15,o[62]),E=u(E,T,I,C,b,21,o[63]),n[0]=n[0]+C|0,n[1]=n[1]+E|0,n[2]=n[2]+T|0,n[3]=n[3]+I|0},_doFinalize:function(){var e=this._data,s=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;s[i>>>5]|=128<<24-i%32;var n=t.floor(r/4294967296),a=r;s[15+(i+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),s[14+(i+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),e.sigBytes=4*(s.length+1),this._process();for(var o=this._hash,l=o.words,c=0;c<4;c++){var d=l[c];l[c]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8)}return o},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}});function c(e,t,s,r,i,n,a){var o=e+(t&s|~t&r)+i+a;return(o<<n|o>>>32-n)+t}function d(e,t,s,r,i,n,a){var o=e+(t&r|s&~r)+i+a;return(o<<n|o>>>32-n)+t}function h(e,t,s,r,i,n,a){var o=e+(t^s^r)+i+a;return(o<<n|o>>>32-n)+t}function u(e,t,s,r,i,n,a){var o=e+(s^(t|~r))+i+a;return(o<<n|o>>>32-n)+t}s.MD5=n._createHelper(l),s.HmacMD5=n._createHmacHelper(l)}(Math),e.MD5));var e}var Ee,Te={exports:{}};function Ie(){return Ee?Te.exports:(Ee=1,Te.exports=(o=ce(),t=(e=o).lib,s=t.WordArray,r=t.Hasher,i=e.algo,n=[],a=i.SHA1=r.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var s=this._hash.words,r=s[0],i=s[1],a=s[2],o=s[3],l=s[4],c=0;c<80;c++){if(c<16)n[c]=0|e[t+c];else{var d=n[c-3]^n[c-8]^n[c-14]^n[c-16];n[c]=d<<1|d>>>31}var h=(r<<5|r>>>27)+l+n[c];h+=c<20?1518500249+(i&a|~i&o):c<40?1859775393+(i^a^o):c<60?(i&a|i&o|a&o)-1894007588:(i^a^o)-899497514,l=o,o=a,a=i<<30|i>>>2,i=r,r=h}s[0]=s[0]+r|0,s[1]=s[1]+i|0,s[2]=s[2]+a|0,s[3]=s[3]+o|0,s[4]=s[4]+l|0},_doFinalize:function(){var e=this._data,t=e.words,s=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(s/4294967296),t[15+(r+64>>>9<<4)]=s,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}}),e.SHA1=r._createHelper(a),e.HmacSHA1=r._createHmacHelper(a),o.SHA1));var e,t,s,r,i,n,a,o}var Ae,Pe={exports:{}};function Oe(){return Ae?Pe.exports:(Ae=1,Pe.exports=(e=ce(),function(t){var s=e,r=s.lib,i=r.WordArray,n=r.Hasher,a=s.algo,o=[],l=[];!function(){function e(e){for(var s=t.sqrt(e),r=2;r<=s;r++)if(!(e%r))return!1;return!0}function s(e){return 4294967296*(e-(0|e))|0}for(var r=2,i=0;i<64;)e(r)&&(i<8&&(o[i]=s(t.pow(r,.5))),l[i]=s(t.pow(r,1/3)),i++),r++}();var c=[],d=a.SHA256=n.extend({_doReset:function(){this._hash=new i.init(o.slice(0))},_doProcessBlock:function(e,t){for(var s=this._hash.words,r=s[0],i=s[1],n=s[2],a=s[3],o=s[4],d=s[5],h=s[6],u=s[7],m=0;m<64;m++){if(m<16)c[m]=0|e[t+m];else{var g=c[m-15],p=(g<<25|g>>>7)^(g<<14|g>>>18)^g>>>3,f=c[m-2],y=(f<<15|f>>>17)^(f<<13|f>>>19)^f>>>10;c[m]=p+c[m-7]+y+c[m-16]}var x=r&i^r&n^i&n,v=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),b=u+((o<<26|o>>>6)^(o<<21|o>>>11)^(o<<7|o>>>25))+(o&d^~o&h)+l[m]+c[m];u=h,h=d,d=o,o=a+b|0,a=n,n=i,i=r,r=b+(v+x)|0}s[0]=s[0]+r|0,s[1]=s[1]+i|0,s[2]=s[2]+n|0,s[3]=s[3]+a|0,s[4]=s[4]+o|0,s[5]=s[5]+d|0,s[6]=s[6]+h|0,s[7]=s[7]+u|0},_doFinalize:function(){var e=this._data,s=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;return s[i>>>5]|=128<<24-i%32,s[14+(i+64>>>9<<4)]=t.floor(r/4294967296),s[15+(i+64>>>9<<4)]=r,e.sigBytes=4*s.length,this._process(),this._hash},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}});s.SHA256=n._createHelper(d),s.HmacSHA256=n._createHmacHelper(d)}(Math),e.SHA256));var e}var Re,De={exports:{}};var $e,Le={exports:{}};function Me(){return $e||($e=1,Le.exports=(e=ce(),ue(),function(){var t=e,s=t.lib.Hasher,r=t.x64,i=r.Word,n=r.WordArray,a=t.algo;function o(){return i.create.apply(i,arguments)}var l=[o(1116352408,3609767458),o(1899447441,602891725),o(3049323471,3964484399),o(3921009573,2173295548),o(961987163,4081628472),o(1508970993,3053834265),o(2453635748,2937671579),o(2870763221,3664609560),o(3624381080,2734883394),o(310598401,1164996542),o(607225278,1323610764),o(1426881987,3590304994),o(1925078388,4068182383),o(2162078206,991336113),o(2614888103,633803317),o(3248222580,3479774868),o(3835390401,2666613458),o(4022224774,944711139),o(264347078,2341262773),o(604807628,2007800933),o(770255983,1495990901),o(1249150122,1856431235),o(1555081692,3175218132),o(1996064986,2198950837),o(2554220882,3999719339),o(2821834349,766784016),o(2952996808,2566594879),o(3210313671,3203337956),o(3336571891,1034457026),o(3584528711,2466948901),o(113926993,3758326383),o(338241895,168717936),o(666307205,1188179964),o(773529912,1546045734),o(1294757372,1522805485),o(1396182291,2643833823),o(1695183700,2343527390),o(1986661051,1014477480),o(2177026350,1206759142),o(2456956037,344077627),o(2730485921,1290863460),o(2820302411,3158454273),o(3259730800,3505952657),o(3345764771,106217008),o(3516065817,3606008344),o(3600352804,1432725776),o(4094571909,1467031594),o(275423344,851169720),o(430227734,3100823752),o(506948616,1363258195),o(659060556,3750685593),o(883997877,3785050280),o(958139571,3318307427),o(1322822218,3812723403),o(1537002063,2003034995),o(1747873779,3602036899),o(1955562222,1575990012),o(2024104815,1125592928),o(2227730452,2716904306),o(2361852424,442776044),o(2428436474,593698344),o(2756734187,3733110249),o(3204031479,2999351573),o(3329325298,3815920427),o(3391569614,3928383900),o(3515267271,566280711),o(3940187606,3454069534),o(4118630271,4000239992),o(116418474,1914138554),o(174292421,2731055270),o(289380356,3203993006),o(460393269,320620315),o(685471733,587496836),o(852142971,1086792851),o(1017036298,365543100),o(1126000580,2618297676),o(1288033470,3409855158),o(1501505948,4234509866),o(1607167915,987167468),o(1816402316,1246189591)],c=[];!function(){for(var e=0;e<80;e++)c[e]=o()}();var d=a.SHA512=s.extend({_doReset:function(){this._hash=new n.init([new i.init(1779033703,4089235720),new i.init(3144134277,2227873595),new i.init(1013904242,4271175723),new i.init(2773480762,1595750129),new i.init(1359893119,2917565137),new i.init(2600822924,725511199),new i.init(528734635,4215389547),new i.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var s=this._hash.words,r=s[0],i=s[1],n=s[2],a=s[3],o=s[4],d=s[5],h=s[6],u=s[7],m=r.high,g=r.low,p=i.high,f=i.low,y=n.high,x=n.low,v=a.high,b=a.low,w=o.high,j=o.low,k=d.high,_=d.low,S=h.high,N=h.low,C=u.high,E=u.low,T=m,I=g,A=p,P=f,O=y,R=x,D=v,$=b,L=w,M=j,B=k,z=_,U=S,H=N,F=C,q=E,W=0;W<80;W++){var J,K,G=c[W];if(W<16)K=G.high=0|e[t+2*W],J=G.low=0|e[t+2*W+1];else{var V=c[W-15],Y=V.high,X=V.low,Z=(Y>>>1|X<<31)^(Y>>>8|X<<24)^Y>>>7,Q=(X>>>1|Y<<31)^(X>>>8|Y<<24)^(X>>>7|Y<<25),ee=c[W-2],te=ee.high,se=ee.low,re=(te>>>19|se<<13)^(te<<3|se>>>29)^te>>>6,ie=(se>>>19|te<<13)^(se<<3|te>>>29)^(se>>>6|te<<26),ne=c[W-7],ae=ne.high,oe=ne.low,le=c[W-16],ce=le.high,de=le.low;K=(K=(K=Z+ae+((J=Q+oe)>>>0<Q>>>0?1:0))+re+((J+=ie)>>>0<ie>>>0?1:0))+ce+((J+=de)>>>0<de>>>0?1:0),G.high=K,G.low=J}var he,ue=L&B^~L&U,me=M&z^~M&H,ge=T&A^T&O^A&O,pe=I&P^I&R^P&R,fe=(T>>>28|I<<4)^(T<<30|I>>>2)^(T<<25|I>>>7),ye=(I>>>28|T<<4)^(I<<30|T>>>2)^(I<<25|T>>>7),xe=(L>>>14|M<<18)^(L>>>18|M<<14)^(L<<23|M>>>9),ve=(M>>>14|L<<18)^(M>>>18|L<<14)^(M<<23|L>>>9),be=l[W],we=be.high,je=be.low,ke=F+xe+((he=q+ve)>>>0<q>>>0?1:0),_e=ye+pe;F=U,q=H,U=B,H=z,B=L,z=M,L=D+(ke=(ke=(ke=ke+ue+((he+=me)>>>0<me>>>0?1:0))+we+((he+=je)>>>0<je>>>0?1:0))+K+((he+=J)>>>0<J>>>0?1:0))+((M=$+he|0)>>>0<$>>>0?1:0)|0,D=O,$=R,O=A,R=P,A=T,P=I,T=ke+(fe+ge+(_e>>>0<ye>>>0?1:0))+((I=he+_e|0)>>>0<he>>>0?1:0)|0}g=r.low=g+I,r.high=m+T+(g>>>0<I>>>0?1:0),f=i.low=f+P,i.high=p+A+(f>>>0<P>>>0?1:0),x=n.low=x+R,n.high=y+O+(x>>>0<R>>>0?1:0),b=a.low=b+$,a.high=v+D+(b>>>0<$>>>0?1:0),j=o.low=j+M,o.high=w+L+(j>>>0<M>>>0?1:0),_=d.low=_+z,d.high=k+B+(_>>>0<z>>>0?1:0),N=h.low=N+H,h.high=S+U+(N>>>0<H>>>0?1:0),E=u.low=E+q,u.high=C+F+(E>>>0<q>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,s=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[30+(r+128>>>10<<5)]=Math.floor(s/4294967296),t[31+(r+128>>>10<<5)]=s,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});t.SHA512=s._createHelper(d),t.HmacSHA512=s._createHmacHelper(d)}(),e.SHA512)),Le.exports;var e}var Be,ze={exports:{}};var Ue,He={exports:{}};function Fe(){return Ue?He.exports:(Ue=1,He.exports=(e=ce(),ue(),function(t){var s=e,r=s.lib,i=r.WordArray,n=r.Hasher,a=s.x64.Word,o=s.algo,l=[],c=[],d=[];!function(){for(var e=1,t=0,s=0;s<24;s++){l[e+5*t]=(s+1)*(s+2)/2%64;var r=(2*e+3*t)%5;e=t%5,t=r}for(e=0;e<5;e++)for(t=0;t<5;t++)c[e+5*t]=t+(2*e+3*t)%5*5;for(var i=1,n=0;n<24;n++){for(var o=0,h=0,u=0;u<7;u++){if(1&i){var m=(1<<u)-1;m<32?h^=1<<m:o^=1<<m-32}128&i?i=i<<1^113:i<<=1}d[n]=a.create(o,h)}}();var h=[];!function(){for(var e=0;e<25;e++)h[e]=a.create()}();var u=o.SHA3=n.extend({cfg:n.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var s=this._state,r=this.blockSize/2,i=0;i<r;i++){var n=e[t+2*i],a=e[t+2*i+1];n=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),a=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),(E=s[i]).high^=a,E.low^=n}for(var o=0;o<24;o++){for(var u=0;u<5;u++){for(var m=0,g=0,p=0;p<5;p++)m^=(E=s[u+5*p]).high,g^=E.low;var f=h[u];f.high=m,f.low=g}for(u=0;u<5;u++){var y=h[(u+4)%5],x=h[(u+1)%5],v=x.high,b=x.low;for(m=y.high^(v<<1|b>>>31),g=y.low^(b<<1|v>>>31),p=0;p<5;p++)(E=s[u+5*p]).high^=m,E.low^=g}for(var w=1;w<25;w++){var j=(E=s[w]).high,k=E.low,_=l[w];_<32?(m=j<<_|k>>>32-_,g=k<<_|j>>>32-_):(m=k<<_-32|j>>>64-_,g=j<<_-32|k>>>64-_);var S=h[c[w]];S.high=m,S.low=g}var N=h[0],C=s[0];for(N.high=C.high,N.low=C.low,u=0;u<5;u++)for(p=0;p<5;p++){var E=s[w=u+5*p],T=h[w],I=h[(u+1)%5+5*p],A=h[(u+2)%5+5*p];E.high=T.high^~I.high&A.high,E.low=T.low^~I.low&A.low}E=s[0];var P=d[o];E.high^=P.high,E.low^=P.low}},_doFinalize:function(){var e=this._data,s=e.words;this._nDataBytes;var r=8*e.sigBytes,n=32*this.blockSize;s[r>>>5]|=1<<24-r%32,s[(t.ceil((r+1)/n)*n>>>5)-1]|=128,e.sigBytes=4*s.length,this._process();for(var a=this._state,o=this.cfg.outputLength/8,l=o/8,c=[],d=0;d<l;d++){var h=a[d],u=h.high,m=h.low;u=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8),m=16711935&(m<<8|m>>>24)|4278255360&(m<<24|m>>>8),c.push(m),c.push(u)}return new i.init(c,o)},clone:function(){for(var e=n.clone.call(this),t=e._state=this._state.slice(0),s=0;s<25;s++)t[s]=t[s].clone();return e}});s.SHA3=n._createHelper(u),s.HmacSHA3=n._createHmacHelper(u)}(Math),e.SHA3));var e}var qe,We={exports:{}};var Je,Ke={exports:{}};function Ge(){return Je?Ke.exports:(Je=1,Ke.exports=(e=ce(),s=(t=e).lib.Base,r=t.enc.Utf8,void(t.algo.HMAC=s.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=r.parse(t));var s=e.blockSize,i=4*s;t.sigBytes>i&&(t=e.finalize(t)),t.clamp();for(var n=this._oKey=t.clone(),a=this._iKey=t.clone(),o=n.words,l=a.words,c=0;c<s;c++)o[c]^=1549556828,l[c]^=909522486;n.sigBytes=a.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,s=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(s))}}))));var e,t,s,r}var Ve,Ye={exports:{}};var Xe,Ze={exports:{}};function Qe(){return Xe?Ze.exports:(Xe=1,Ze.exports=(o=ce(),Ie(),Ge(),t=(e=o).lib,s=t.Base,r=t.WordArray,i=e.algo,n=i.MD5,a=i.EvpKDF=s.extend({cfg:s.extend({keySize:4,hasher:n,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var s,i=this.cfg,n=i.hasher.create(),a=r.create(),o=a.words,l=i.keySize,c=i.iterations;o.length<l;){s&&n.update(s),s=n.update(e).finalize(t),n.reset();for(var d=1;d<c;d++)s=n.finalize(s),n.reset();a.concat(s)}return a.sigBytes=4*l,a}}),e.EvpKDF=function(e,t,s){return a.create(s).compute(e,t)},o.EvpKDF));var e,t,s,r,i,n,a,o}var et,tt={exports:{}};function st(){return et?tt.exports:(et=1,tt.exports=(e=ce(),Qe(),void(e.lib.Cipher||function(t){var s=e,r=s.lib,i=r.Base,n=r.WordArray,a=r.BufferedBlockAlgorithm,o=s.enc;o.Utf8;var l=o.Base64,c=s.algo.EvpKDF,d=r.Cipher=a.extend({cfg:i.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,s){this.cfg=this.cfg.extend(s),this._xformMode=e,this._key=t,this.reset()},reset:function(){a.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?v:y}return function(t){return{encrypt:function(s,r,i){return e(r).encrypt(t,s,r,i)},decrypt:function(s,r,i){return e(r).decrypt(t,s,r,i)}}}}()});r.StreamCipher=d.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var h=s.mode={},u=r.BlockCipherMode=i.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),m=h.CBC=function(){var e=u.extend();function s(e,s,r){var i,n=this._iv;n?(i=n,this._iv=t):i=this._prevBlock;for(var a=0;a<r;a++)e[s+a]^=i[a]}return e.Encryptor=e.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize;s.call(this,e,t,i),r.encryptBlock(e,t),this._prevBlock=e.slice(t,t+i)}}),e.Decryptor=e.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize,n=e.slice(t,t+i);r.decryptBlock(e,t),s.call(this,e,t,i),this._prevBlock=n}}),e}(),g=(s.pad={}).Pkcs7={pad:function(e,t){for(var s=4*t,r=s-e.sigBytes%s,i=r<<24|r<<16|r<<8|r,a=[],o=0;o<r;o+=4)a.push(i);var l=n.create(a,r);e.concat(l)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}};r.BlockCipher=d.extend({cfg:d.cfg.extend({mode:m,padding:g}),reset:function(){var e;d.reset.call(this);var t=this.cfg,s=t.iv,r=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=r.createEncryptor:(e=r.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,s&&s.words):(this._mode=e.call(r,this,s&&s.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4});var p=r.CipherParams=i.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),f=(s.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,s=e.salt;return(s?n.create([1398893684,1701076831]).concat(s).concat(t):t).toString(l)},parse:function(e){var t,s=l.parse(e),r=s.words;return 1398893684==r[0]&&1701076831==r[1]&&(t=n.create(r.slice(2,4)),r.splice(0,4),s.sigBytes-=16),p.create({ciphertext:s,salt:t})}},y=r.SerializableCipher=i.extend({cfg:i.extend({format:f}),encrypt:function(e,t,s,r){r=this.cfg.extend(r);var i=e.createEncryptor(s,r),n=i.finalize(t),a=i.cfg;return p.create({ciphertext:n,key:s,iv:a.iv,algorithm:e,mode:a.mode,padding:a.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,s,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(s,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),x=(s.kdf={}).OpenSSL={execute:function(e,t,s,r,i){if(r||(r=n.random(8)),i)a=c.create({keySize:t+s,hasher:i}).compute(e,r);else var a=c.create({keySize:t+s}).compute(e,r);var o=n.create(a.words.slice(t),4*s);return a.sigBytes=4*t,p.create({key:a,iv:o,salt:r})}},v=r.PasswordBasedCipher=y.extend({cfg:y.cfg.extend({kdf:x}),encrypt:function(e,t,s,r){var i=(r=this.cfg.extend(r)).kdf.execute(s,e.keySize,e.ivSize,r.salt,r.hasher);r.iv=i.iv;var n=y.encrypt.call(this,e,t,i.key,r);return n.mixIn(i),n},decrypt:function(e,t,s,r){r=this.cfg.extend(r),t=this._parse(t,r.format);var i=r.kdf.execute(s,e.keySize,e.ivSize,t.salt,r.hasher);return r.iv=i.iv,y.decrypt.call(this,e,t,i.key,r)}})}())));var e}var rt,it={exports:{}};var nt,at={exports:{}};var ot,lt={exports:{}};function ct(){return ot?lt.exports:(ot=1,lt.exports=(e=ce(),st(),
/** @preserve
       * Counter block mode compatible with  Dr Brian Gladman fileenc.c
       * derived from CryptoJS.mode.CTR
       * Jan Hruby jhruby.web@gmail.com
       */
e.mode.CTRGladman=function(){var t=e.lib.BlockCipherMode.extend();function s(e){if(255&~(e>>24))e+=1<<24;else{var t=e>>16&255,s=e>>8&255,r=255&e;255===t?(t=0,255===s?(s=0,255===r?r=0:++r):++s):++t,e=0,e+=t<<16,e+=s<<8,e+=r}return e}function r(e){return 0===(e[0]=s(e[0]))&&(e[1]=s(e[1])),e}var i=t.Encryptor=t.extend({processBlock:function(e,t){var s=this._cipher,i=s.blockSize,n=this._iv,a=this._counter;n&&(a=this._counter=n.slice(0),this._iv=void 0),r(a);var o=a.slice(0);s.encryptBlock(o,0);for(var l=0;l<i;l++)e[t+l]^=o[l]}});return t.Decryptor=i,t}(),e.mode.CTRGladman));var e}var dt,ht={exports:{}};var ut,mt={exports:{}};var gt,pt={exports:{}};var ft,yt={exports:{}};var xt,vt={exports:{}};var bt,wt={exports:{}};var jt,kt={exports:{}};var _t,St={exports:{}};var Nt,Ct={exports:{}};var Et,Tt={exports:{}};function It(){return Et?Tt.exports:(Et=1,Tt.exports=(e=ce(),we(),Ce(),Qe(),st(),function(){var t=e,s=t.lib,r=s.WordArray,i=s.BlockCipher,n=t.algo,a=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],o=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],l=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],d=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],h=n.DES=i.extend({_doReset:function(){for(var e=this._key.words,t=[],s=0;s<56;s++){var r=a[s]-1;t[s]=e[r>>>5]>>>31-r%32&1}for(var i=this._subKeys=[],n=0;n<16;n++){var c=i[n]=[],d=l[n];for(s=0;s<24;s++)c[s/6|0]|=t[(o[s]-1+d)%28]<<31-s%6,c[4+(s/6|0)]|=t[28+(o[s+24]-1+d)%28]<<31-s%6;for(c[0]=c[0]<<1|c[0]>>>31,s=1;s<7;s++)c[s]=c[s]>>>4*(s-1)+3;c[7]=c[7]<<5|c[7]>>>27}var h=this._invSubKeys=[];for(s=0;s<16;s++)h[s]=i[15-s]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,s){this._lBlock=e[t],this._rBlock=e[t+1],u.call(this,4,252645135),u.call(this,16,65535),m.call(this,2,858993459),m.call(this,8,16711935),u.call(this,1,1431655765);for(var r=0;r<16;r++){for(var i=s[r],n=this._lBlock,a=this._rBlock,o=0,l=0;l<8;l++)o|=c[l][((a^i[l])&d[l])>>>0];this._lBlock=a,this._rBlock=n^o}var h=this._lBlock;this._lBlock=this._rBlock,this._rBlock=h,u.call(this,1,1431655765),m.call(this,8,16711935),m.call(this,2,858993459),u.call(this,16,65535),u.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function u(e,t){var s=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=s,this._lBlock^=s<<e}function m(e,t){var s=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=s,this._rBlock^=s<<e}t.DES=i._createHelper(h);var g=n.TripleDES=i.extend({_doReset:function(){var e=this._key.words;if(2!==e.length&&4!==e.length&&e.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var t=e.slice(0,2),s=e.length<4?e.slice(0,2):e.slice(2,4),i=e.length<6?e.slice(0,2):e.slice(4,6);this._des1=h.createEncryptor(r.create(t)),this._des2=h.createEncryptor(r.create(s)),this._des3=h.createEncryptor(r.create(i))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});t.TripleDES=i._createHelper(g)}(),e.TripleDES));var e}var At,Pt={exports:{}};var Ot,Rt={exports:{}};var Dt,$t={exports:{}};var Lt,Mt,Bt,zt,Ut,Ht,Ft,qt={exports:{}};function Wt(){return Lt?qt.exports:(Lt=1,qt.exports=(e=ce(),we(),Ce(),Qe(),st(),function(){var t=e,s=t.lib.BlockCipher,r=t.algo;const i=16,n=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],a=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var o={pbox:[],sbox:[]};function l(e,t){let s=t>>24&255,r=t>>16&255,i=t>>8&255,n=255&t,a=e.sbox[0][s]+e.sbox[1][r];return a^=e.sbox[2][i],a+=e.sbox[3][n],a}function c(e,t,s){let r,n=t,a=s;for(let o=0;o<i;++o)n^=e.pbox[o],a=l(e,n)^a,r=n,n=a,a=r;return r=n,n=a,a=r,a^=e.pbox[i],n^=e.pbox[i+1],{left:n,right:a}}function d(e,t,s){let r,n=t,a=s;for(let o=i+1;o>1;--o)n^=e.pbox[o],a=l(e,n)^a,r=n,n=a,a=r;return r=n,n=a,a=r,a^=e.pbox[1],n^=e.pbox[0],{left:n,right:a}}function h(e,t,s){for(let i=0;i<4;i++){e.sbox[i]=[];for(let t=0;t<256;t++)e.sbox[i][t]=a[i][t]}let r=0;for(let a=0;a<i+2;a++)e.pbox[a]=n[a]^t[r],r++,r>=s&&(r=0);let o=0,l=0,d=0;for(let n=0;n<i+2;n+=2)d=c(e,o,l),o=d.left,l=d.right,e.pbox[n]=o,e.pbox[n+1]=l;for(let i=0;i<4;i++)for(let t=0;t<256;t+=2)d=c(e,o,l),o=d.left,l=d.right,e.sbox[i][t]=o,e.sbox[i][t+1]=l;return!0}var u=r.Blowfish=s.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var e=this._keyPriorReset=this._key,t=e.words,s=e.sigBytes/4;h(o,t,s)}},encryptBlock:function(e,t){var s=c(o,e[t],e[t+1]);e[t]=s.left,e[t+1]=s.right},decryptBlock:function(e,t){var s=d(o,e[t],e[t+1]);e[t]=s.left,e[t+1]=s.right},blockSize:2,keySize:4,ivSize:2});t.Blowfish=s._createHelper(u)}(),e.Blowfish));var e}const Jt=i(ne.exports=function(e){return e}(ce(),ue(),pe(),xe(),we(),_e(),Ce(),Ie(),Oe(),Re||(Re=1,De.exports=(Ft=ce(),Oe(),Bt=(Mt=Ft).lib.WordArray,zt=Mt.algo,Ut=zt.SHA256,Ht=zt.SHA224=Ut.extend({_doReset:function(){this._hash=new Bt.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=Ut._doFinalize.call(this);return e.sigBytes-=4,e}}),Mt.SHA224=Ut._createHelper(Ht),Mt.HmacSHA224=Ut._createHmacHelper(Ht),Ft.SHA224)),Me(),function(){return Be?ze.exports:(Be=1,ze.exports=(o=ce(),ue(),Me(),t=(e=o).x64,s=t.Word,r=t.WordArray,i=e.algo,n=i.SHA512,a=i.SHA384=n.extend({_doReset:function(){this._hash=new r.init([new s.init(3418070365,3238371032),new s.init(1654270250,914150663),new s.init(2438529370,812702999),new s.init(355462360,4144912697),new s.init(1731405415,4290775857),new s.init(2394180231,1750603025),new s.init(3675008525,1694076839),new s.init(1203062813,3204075428)])},_doFinalize:function(){var e=n._doFinalize.call(this);return e.sigBytes-=16,e}}),e.SHA384=n._createHelper(a),e.HmacSHA384=n._createHmacHelper(a),o.SHA384));var e,t,s,r,i,n,a,o}(),Fe(),function(){return qe?We.exports:(qe=1,We.exports=(e=ce(),
/** @preserve
      			(c) 2012 by Cdric Mesnil. All rights reserved.
      
      			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
      
      			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
      			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
      
      			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
      			*/
function(){var t=e,s=t.lib,r=s.WordArray,i=s.Hasher,n=t.algo,a=r.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),o=r.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),l=r.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),c=r.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),d=r.create([0,1518500249,1859775393,2400959708,2840853838]),h=r.create([1352829926,1548603684,1836072691,2053994217,0]),u=n.RIPEMD160=i.extend({_doReset:function(){this._hash=r.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var s=0;s<16;s++){var r=t+s,i=e[r];e[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var n,u,v,b,w,j,k,_,S,N,C,E=this._hash.words,T=d.words,I=h.words,A=a.words,P=o.words,O=l.words,R=c.words;for(j=n=E[0],k=u=E[1],_=v=E[2],S=b=E[3],N=w=E[4],s=0;s<80;s+=1)C=n+e[t+A[s]]|0,C+=s<16?m(u,v,b)+T[0]:s<32?g(u,v,b)+T[1]:s<48?p(u,v,b)+T[2]:s<64?f(u,v,b)+T[3]:y(u,v,b)+T[4],C=(C=x(C|=0,O[s]))+w|0,n=w,w=b,b=x(v,10),v=u,u=C,C=j+e[t+P[s]]|0,C+=s<16?y(k,_,S)+I[0]:s<32?f(k,_,S)+I[1]:s<48?p(k,_,S)+I[2]:s<64?g(k,_,S)+I[3]:m(k,_,S)+I[4],C=(C=x(C|=0,R[s]))+N|0,j=N,N=S,S=x(_,10),_=k,k=C;C=E[1]+v+S|0,E[1]=E[2]+b+N|0,E[2]=E[3]+w+j|0,E[3]=E[4]+n+k|0,E[4]=E[0]+u+_|0,E[0]=C},_doFinalize:function(){var e=this._data,t=e.words,s=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),e.sigBytes=4*(t.length+1),this._process();for(var i=this._hash,n=i.words,a=0;a<5;a++){var o=n[a];n[a]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}return i},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function m(e,t,s){return e^t^s}function g(e,t,s){return e&t|~e&s}function p(e,t,s){return(e|~t)^s}function f(e,t,s){return e&s|t&~s}function y(e,t,s){return e^(t|~s)}function x(e,t){return e<<t|e>>>32-t}t.RIPEMD160=i._createHelper(u),t.HmacRIPEMD160=i._createHmacHelper(u)}(),e.RIPEMD160));var e}(),Ge(),function(){return Ve?Ye.exports:(Ve=1,Ye.exports=(l=ce(),Oe(),Ge(),t=(e=l).lib,s=t.Base,r=t.WordArray,i=e.algo,n=i.SHA256,a=i.HMAC,o=i.PBKDF2=s.extend({cfg:s.extend({keySize:4,hasher:n,iterations:25e4}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var s=this.cfg,i=a.create(s.hasher,e),n=r.create(),o=r.create([1]),l=n.words,c=o.words,d=s.keySize,h=s.iterations;l.length<d;){var u=i.update(t).finalize(o);i.reset();for(var m=u.words,g=m.length,p=u,f=1;f<h;f++){p=i.finalize(p),i.reset();for(var y=p.words,x=0;x<g;x++)m[x]^=y[x]}n.concat(u),c[0]++}return n.sigBytes=4*d,n}}),e.PBKDF2=function(e,t,s){return o.create(s).compute(e,t)},l.PBKDF2));var e,t,s,r,i,n,a,o,l}(),Qe(),st(),function(){return rt?it.exports:(rt=1,it.exports=(e=ce(),st(),e.mode.CFB=function(){var t=e.lib.BlockCipherMode.extend();function s(e,t,s,r){var i,n=this._iv;n?(i=n.slice(0),this._iv=void 0):i=this._prevBlock,r.encryptBlock(i,0);for(var a=0;a<s;a++)e[t+a]^=i[a]}return t.Encryptor=t.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize;s.call(this,e,t,i,r),this._prevBlock=e.slice(t,t+i)}}),t.Decryptor=t.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize,n=e.slice(t,t+i);s.call(this,e,t,i,r),this._prevBlock=n}}),t}(),e.mode.CFB));var e}(),function(){return nt?at.exports:(nt=1,at.exports=(s=ce(),st(),s.mode.CTR=(e=s.lib.BlockCipherMode.extend(),t=e.Encryptor=e.extend({processBlock:function(e,t){var s=this._cipher,r=s.blockSize,i=this._iv,n=this._counter;i&&(n=this._counter=i.slice(0),this._iv=void 0);var a=n.slice(0);s.encryptBlock(a,0),n[r-1]=n[r-1]+1|0;for(var o=0;o<r;o++)e[t+o]^=a[o]}}),e.Decryptor=t,e),s.mode.CTR));var e,t,s}(),ct(),function(){return dt?ht.exports:(dt=1,ht.exports=(s=ce(),st(),s.mode.OFB=(e=s.lib.BlockCipherMode.extend(),t=e.Encryptor=e.extend({processBlock:function(e,t){var s=this._cipher,r=s.blockSize,i=this._iv,n=this._keystream;i&&(n=this._keystream=i.slice(0),this._iv=void 0),s.encryptBlock(n,0);for(var a=0;a<r;a++)e[t+a]^=n[a]}}),e.Decryptor=t,e),s.mode.OFB));var e,t,s}(),function(){return ut?mt.exports:(ut=1,mt.exports=(t=ce(),st(),t.mode.ECB=((e=t.lib.BlockCipherMode.extend()).Encryptor=e.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),e.Decryptor=e.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),e),t.mode.ECB));var e,t}(),function(){return gt?pt.exports:(gt=1,pt.exports=(e=ce(),st(),e.pad.AnsiX923={pad:function(e,t){var s=e.sigBytes,r=4*t,i=r-s%r,n=s+i-1;e.clamp(),e.words[n>>>2]|=i<<24-n%4*8,e.sigBytes+=i},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Ansix923));var e}(),function(){return ft?yt.exports:(ft=1,yt.exports=(e=ce(),st(),e.pad.Iso10126={pad:function(t,s){var r=4*s,i=r-t.sigBytes%r;t.concat(e.lib.WordArray.random(i-1)).concat(e.lib.WordArray.create([i<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Iso10126));var e}(),function(){return xt?vt.exports:(xt=1,vt.exports=(e=ce(),st(),e.pad.Iso97971={pad:function(t,s){t.concat(e.lib.WordArray.create([2147483648],1)),e.pad.ZeroPadding.pad(t,s)},unpad:function(t){e.pad.ZeroPadding.unpad(t),t.sigBytes--}},e.pad.Iso97971));var e}(),function(){return bt?wt.exports:(bt=1,wt.exports=(e=ce(),st(),e.pad.ZeroPadding={pad:function(e,t){var s=4*t;e.clamp(),e.sigBytes+=s-(e.sigBytes%s||s)},unpad:function(e){var t=e.words,s=e.sigBytes-1;for(s=e.sigBytes-1;s>=0;s--)if(t[s>>>2]>>>24-s%4*8&255){e.sigBytes=s+1;break}}},e.pad.ZeroPadding));var e}(),function(){return jt?kt.exports:(jt=1,kt.exports=(e=ce(),st(),e.pad.NoPadding={pad:function(){},unpad:function(){}},e.pad.NoPadding));var e}(),function(){return _t?St.exports:(_t=1,St.exports=(r=ce(),st(),t=(e=r).lib.CipherParams,s=e.enc.Hex,e.format.Hex={stringify:function(e){return e.ciphertext.toString(s)},parse:function(e){var r=s.parse(e);return t.create({ciphertext:r})}},r.format.Hex));var e,t,s,r}(),function(){return Nt?Ct.exports:(Nt=1,Ct.exports=(e=ce(),we(),Ce(),Qe(),st(),function(){var t=e,s=t.lib.BlockCipher,r=t.algo,i=[],n=[],a=[],o=[],l=[],c=[],d=[],h=[],u=[],m=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var s=0,r=0;for(t=0;t<256;t++){var g=r^r<<1^r<<2^r<<3^r<<4;g=g>>>8^255&g^99,i[s]=g,n[g]=s;var p=e[s],f=e[p],y=e[f],x=257*e[g]^16843008*g;a[s]=x<<24|x>>>8,o[s]=x<<16|x>>>16,l[s]=x<<8|x>>>24,c[s]=x,x=16843009*y^65537*f^257*p^16843008*s,d[g]=x<<24|x>>>8,h[g]=x<<16|x>>>16,u[g]=x<<8|x>>>24,m[g]=x,s?(s=p^e[e[e[y^p]]],r^=e[e[r]]):s=r=1}}();var g=[0,1,2,4,8,16,32,64,128,27,54],p=r.AES=s.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,s=e.sigBytes/4,r=4*((this._nRounds=s+6)+1),n=this._keySchedule=[],a=0;a<r;a++)a<s?n[a]=t[a]:(c=n[a-1],a%s?s>6&&a%s==4&&(c=i[c>>>24]<<24|i[c>>>16&255]<<16|i[c>>>8&255]<<8|i[255&c]):(c=i[(c=c<<8|c>>>24)>>>24]<<24|i[c>>>16&255]<<16|i[c>>>8&255]<<8|i[255&c],c^=g[a/s|0]<<24),n[a]=n[a-s]^c);for(var o=this._invKeySchedule=[],l=0;l<r;l++){if(a=r-l,l%4)var c=n[a];else c=n[a-4];o[l]=l<4||a<=4?c:d[i[c>>>24]]^h[i[c>>>16&255]]^u[i[c>>>8&255]]^m[i[255&c]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,a,o,l,c,i)},decryptBlock:function(e,t){var s=e[t+1];e[t+1]=e[t+3],e[t+3]=s,this._doCryptBlock(e,t,this._invKeySchedule,d,h,u,m,n),s=e[t+1],e[t+1]=e[t+3],e[t+3]=s},_doCryptBlock:function(e,t,s,r,i,n,a,o){for(var l=this._nRounds,c=e[t]^s[0],d=e[t+1]^s[1],h=e[t+2]^s[2],u=e[t+3]^s[3],m=4,g=1;g<l;g++){var p=r[c>>>24]^i[d>>>16&255]^n[h>>>8&255]^a[255&u]^s[m++],f=r[d>>>24]^i[h>>>16&255]^n[u>>>8&255]^a[255&c]^s[m++],y=r[h>>>24]^i[u>>>16&255]^n[c>>>8&255]^a[255&d]^s[m++],x=r[u>>>24]^i[c>>>16&255]^n[d>>>8&255]^a[255&h]^s[m++];c=p,d=f,h=y,u=x}p=(o[c>>>24]<<24|o[d>>>16&255]<<16|o[h>>>8&255]<<8|o[255&u])^s[m++],f=(o[d>>>24]<<24|o[h>>>16&255]<<16|o[u>>>8&255]<<8|o[255&c])^s[m++],y=(o[h>>>24]<<24|o[u>>>16&255]<<16|o[c>>>8&255]<<8|o[255&d])^s[m++],x=(o[u>>>24]<<24|o[c>>>16&255]<<16|o[d>>>8&255]<<8|o[255&h])^s[m++],e[t]=p,e[t+1]=f,e[t+2]=y,e[t+3]=x},keySize:8});t.AES=s._createHelper(p)}(),e.AES));var e}(),It(),function(){return At?Pt.exports:(At=1,Pt.exports=(e=ce(),we(),Ce(),Qe(),st(),function(){var t=e,s=t.lib.StreamCipher,r=t.algo,i=r.RC4=s.extend({_doReset:function(){for(var e=this._key,t=e.words,s=e.sigBytes,r=this._S=[],i=0;i<256;i++)r[i]=i;i=0;for(var n=0;i<256;i++){var a=i%s,o=t[a>>>2]>>>24-a%4*8&255;n=(n+r[i]+o)%256;var l=r[i];r[i]=r[n],r[n]=l}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=n.call(this)},keySize:8,ivSize:0});function n(){for(var e=this._S,t=this._i,s=this._j,r=0,i=0;i<4;i++){s=(s+e[t=(t+1)%256])%256;var n=e[t];e[t]=e[s],e[s]=n,r|=e[(e[t]+e[s])%256]<<24-8*i}return this._i=t,this._j=s,r}t.RC4=s._createHelper(i);var a=r.RC4Drop=i.extend({cfg:i.cfg.extend({drop:192}),_doReset:function(){i._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)n.call(this)}});t.RC4Drop=s._createHelper(a)}(),e.RC4));var e}(),function(){return Ot?Rt.exports:(Ot=1,Rt.exports=(e=ce(),we(),Ce(),Qe(),st(),function(){var t=e,s=t.lib.StreamCipher,r=t.algo,i=[],n=[],a=[],o=r.Rabbit=s.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,s=0;s<4;s++)e[s]=16711935&(e[s]<<8|e[s]>>>24)|4278255360&(e[s]<<24|e[s]>>>8);var r=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],i=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,s=0;s<4;s++)l.call(this);for(s=0;s<8;s++)i[s]^=r[s+4&7];if(t){var n=t.words,a=n[0],o=n[1],c=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),d=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),h=c>>>16|4294901760&d,u=d<<16|65535&c;for(i[0]^=c,i[1]^=h,i[2]^=d,i[3]^=u,i[4]^=c,i[5]^=h,i[6]^=d,i[7]^=u,s=0;s<4;s++)l.call(this)}},_doProcessBlock:function(e,t){var s=this._X;l.call(this),i[0]=s[0]^s[5]>>>16^s[3]<<16,i[1]=s[2]^s[7]>>>16^s[5]<<16,i[2]=s[4]^s[1]>>>16^s[7]<<16,i[3]=s[6]^s[3]>>>16^s[1]<<16;for(var r=0;r<4;r++)i[r]=16711935&(i[r]<<8|i[r]>>>24)|4278255360&(i[r]<<24|i[r]>>>8),e[t+r]^=i[r]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,s=0;s<8;s++)n[s]=t[s];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<n[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<n[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<n[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<n[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<n[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<n[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<n[6]>>>0?1:0)|0,this._b=t[7]>>>0<n[7]>>>0?1:0,s=0;s<8;s++){var r=e[s]+t[s],i=65535&r,o=r>>>16,l=((i*i>>>17)+i*o>>>15)+o*o,c=((4294901760&r)*r|0)+((65535&r)*r|0);a[s]=l^c}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}t.Rabbit=s._createHelper(o)}(),e.Rabbit));var e}(),function(){return Dt?$t.exports:(Dt=1,$t.exports=(e=ce(),we(),Ce(),Qe(),st(),function(){var t=e,s=t.lib.StreamCipher,r=t.algo,i=[],n=[],a=[],o=r.RabbitLegacy=s.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,s=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],r=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var i=0;i<4;i++)l.call(this);for(i=0;i<8;i++)r[i]^=s[i+4&7];if(t){var n=t.words,a=n[0],o=n[1],c=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),d=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),h=c>>>16|4294901760&d,u=d<<16|65535&c;for(r[0]^=c,r[1]^=h,r[2]^=d,r[3]^=u,r[4]^=c,r[5]^=h,r[6]^=d,r[7]^=u,i=0;i<4;i++)l.call(this)}},_doProcessBlock:function(e,t){var s=this._X;l.call(this),i[0]=s[0]^s[5]>>>16^s[3]<<16,i[1]=s[2]^s[7]>>>16^s[5]<<16,i[2]=s[4]^s[1]>>>16^s[7]<<16,i[3]=s[6]^s[3]>>>16^s[1]<<16;for(var r=0;r<4;r++)i[r]=16711935&(i[r]<<8|i[r]>>>24)|4278255360&(i[r]<<24|i[r]>>>8),e[t+r]^=i[r]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,s=0;s<8;s++)n[s]=t[s];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<n[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<n[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<n[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<n[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<n[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<n[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<n[6]>>>0?1:0)|0,this._b=t[7]>>>0<n[7]>>>0?1:0,s=0;s<8;s++){var r=e[s]+t[s],i=65535&r,o=r>>>16,l=((i*i>>>17)+i*o>>>15)+o*o,c=((4294901760&r)*r|0)+((65535&r)*r|0);a[s]=l^c}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}t.RabbitLegacy=s._createHelper(o)}(),e.RabbitLegacy));var e}(),Wt()));function Kt(e){return!!Array.isArray(e)&&(0!==e.length&&e.every((e=>"number"==typeof e&&!isNaN(e)&&isFinite(e))))}function Gt(e,t){return Array.isArray(e)&&(e=e.map((e=>{if(e.embedding&&Array.isArray(e.embedding)&&!Kt(e.embedding)){const{embedding:t,...s}=e;return s}return e}))),Jt.AES.encrypt(JSON.stringify(e),t).toString()}function Vt(e,t){const s=Jt.AES.decrypt(e,t).toString(Jt.enc.Utf8),r=JSON.parse(s);if(Array.isArray(r)){return r.map((e=>{if(e.embedding&&Array.isArray(e.embedding)){if(!Kt(e.embedding)){const{embedding:t,...s}=e;return s}e.embedding=e.embedding.map((e=>Number(e)))}return e}))}return r}const Yt=new class{constructor(){this.db=null}async init(){try{this.db=await function(e,t,{blocked:s,upgrade:r,blocking:i,terminated:n}={}){const a=indexedDB.open(e,t),o=J(a);return r&&a.addEventListener("upgradeneeded",(e=>{r(J(a.result),e.oldVersion,e.newVersion,J(a.transaction),e)})),s&&a.addEventListener("blocked",(e=>s(e.oldVersion,e.newVersion,e))),o.then((e=>{n&&e.addEventListener("close",(()=>n())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),o}("SobriDB",1,{upgrade(e){e.objectStoreNames.contains("checkIns")||e.createObjectStore("checkIns"),e.objectStoreNames.contains("journal")||e.createObjectStore("journal"),e.objectStoreNames.contains("messages")||e.createObjectStore("messages"),e.objectStoreNames.contains("progress")||e.createObjectStore("progress"),e.objectStoreNames.contains("triggers")||e.createObjectStore("triggers"),e.objectStoreNames.contains("tasks")||e.createObjectStore("tasks"),e.objectStoreNames.contains("insights")||e.createObjectStore("insights"),e.objectStoreNames.contains("memory")||e.createObjectStore("memory"),e.objectStoreNames.contains("summaries")||e.createObjectStore("summaries"),e.objectStoreNames.contains("appState")||e.createObjectStore("appState")}})}catch(e){throw e}}async ensureDB(){return this.db||await this.init(),this.db}async getStorageUsage(){if("storage"in navigator&&"estimate"in navigator.storage){const e=await navigator.storage.estimate(),t=e.usage||0,s=e.quota||0,r=s>0?t/s*100:0;return{usage:t,quota:s,percentage:r}}return{usage:0,quota:0,percentage:0}}async safeStore(e,t,s){try{const r=await this.ensureDB();await r.put(e,s,t)}catch(r){if("QuotaExceededError"!==r.name)throw r;await this.handleQuotaExceeded(e);try{const r=await this.ensureDB();await r.put(e,s,t)}catch(i){throw new Error("Failed to store data even after cleanup: "+i.message)}}}async handleQuotaExceeded(e){switch(e){case"messages":await this.evictOldMessages();break;case"insights":await this.evictOldInsights();break;case"journal":await this.evictOldJournalEntries()}}async evictOldMessages(){const e=(await this.ensureDB()).transaction("messages","readwrite").objectStore("messages"),t=await e.getAllKeys(),s=await this.getCurrentUserId();if(!s||0===t.length)return;const r=[];for(const o of t){const t=await e.get(o);if(t)try{const e=Vt(t,s);r.push(...e)}catch(a){}}r.sort(((e,t)=>t.timestamp-e.timestamp));const i=r.slice(0,300);await e.clear();const n=Gt(i,s);await e.put(n,s)}async evictOldInsights(){const e=await this.ensureDB(),t=await this.getCurrentUserId();if(!t)return;const s=await e.get("insights",t);if(s)try{const r=Vt(s,t).sort(((e,t)=>e.shown!==t.shown?e.shown?1:-1:new Date(t.date).getTime()-new Date(e.date).getTime())),i=Gt(r.slice(0,100),t);await e.put("insights",i,t)}catch(r){}}async evictOldJournalEntries(){const e=await this.ensureDB(),t=await this.getCurrentUserId();if(!t)return;const s=await e.get("journal",t);if(s)try{const r=Vt(s,t).sort(((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())),i=Gt(r.slice(0,200),t);await e.put("journal",i,t)}catch(r){}}async getCurrentUserId(){try{const e=await this.ensureDB(),t=await e.get("appState","userId");if(t)return t}catch(e){}return localStorage.getItem("Soberi_userId")}async saveCheckIn(e,t){const s=Gt([...(await this.getCheckIns(t)).filter((t=>t.date!==e.date)),e],t);await this.safeStore("checkIns",t,s)}async getCheckIns(e){try{const t=await this.ensureDB(),s=await t.get("checkIns",e);return s?Vt(s,e):[]}catch(t){return[]}}async saveJournalEntry(e,t){const s=Gt([...(await this.getJournalEntries(t)).filter((t=>t.id!==e.id)),e],t);await this.safeStore("journal",t,s)}async getJournalEntries(e){try{const t=await this.ensureDB(),s=await t.get("journal",e);return s?Vt(s,e):[]}catch(t){return[]}}async deleteJournalEntry(e,t){const s=Gt((await this.getJournalEntries(t)).filter((t=>t.id!==e)),t);await this.safeStore("journal",t,s)}async saveMessage(e,t){const s=Gt([...await this.getMessages(t),e],t);await this.safeStore("messages",t,s)}async getMessages(e){try{const t=await this.ensureDB(),s=await t.get("messages",e);return s?Vt(s,e):[]}catch(t){return[]}}async clearMessages(e){const t=await this.ensureDB();await t.delete("messages",e)}async getProgress(e){try{const t=await this.ensureDB(),s=await t.get("progress",e);return s?Vt(s,e):{currentStreak:0,longestStreak:0,startDate:null,lastCheckInDate:null,totalDaysClean:0,relapseCount:0,milestones:[]}}catch(t){return{currentStreak:0,longestStreak:0,startDate:null,lastCheckInDate:null,totalDaysClean:0,relapseCount:0,milestones:[]}}}async updateProgress(e,t){const s={...await this.getProgress(t),...e},r=Gt(s,t);return await this.safeStore("progress",t,r),s}async saveTriggerLog(e,t){const s=Gt([...(await this.getTriggerLogs(t)).filter((t=>t.id!==e.id)),e],t);await this.safeStore("triggers",t,s)}async getTriggerLogs(e){try{const t=await this.ensureDB(),s=await t.get("triggers",e);return s?Vt(s,e):[]}catch(t){return[]}}async deleteTriggerLog(e,t){const s=Gt((await this.getTriggerLogs(t)).filter((t=>t.id!==e)),t);await this.safeStore("triggers",t,s)}async saveTask(e,t){const s=Gt([...(await this.getTasks(t)).filter((t=>t.id!==e.id)),e],t);await this.safeStore("tasks",t,s)}async getTasks(e){try{const t=await this.ensureDB(),s=await t.get("tasks",e);return s?Vt(s,e):[]}catch(t){return[]}}async deleteTask(e,t){const s=Gt((await this.getTasks(t)).filter((t=>t.id!==e)),t);await this.safeStore("tasks",t,s)}async completeTask(e,t){const s=Gt((await this.getTasks(t)).map((t=>t.id===e?{...t,completed:!0,completedAt:(new Date).toISOString()}:t)),t);await this.safeStore("tasks",t,s)}async saveInsight(e,t){const s=Gt([...(await this.getInsights(t)).filter((t=>t.id!==e.id)),e],t);await this.safeStore("insights",t,s)}async getInsights(e){try{const t=await this.ensureDB(),s=await t.get("insights",e);return s?Vt(s,e):[]}catch(t){return[]}}async markInsightAsShown(e,t){const s=Gt((await this.getInsights(t)).map((t=>t.id===e?{...t,shown:!0}:t)),t);await this.safeStore("insights",t,s)}async saveMemoryEntry(e,t){const s=Gt([...(await this.getMemoryEntries(t)).filter((t=>t.id!==e.id)),e],t);await this.safeStore("memory",t,s)}async getMemoryEntries(e){try{const t=await this.ensureDB(),s=await t.get("memory",e);return s?Vt(s,e):[]}catch(t){return[]}}async deleteMemoryEntry(e,t){const s=Gt((await this.getMemoryEntries(t)).filter((t=>t.id!==e)),t);await this.safeStore("memory",t,s)}async saveConversationSummary(e,t){const s=Gt([...(await this.getConversationSummaries(t)).filter((t=>t.id!==e.id)),e],t);await this.safeStore("summaries",t,s)}async getConversationSummaries(e){try{const t=await this.ensureDB(),s=await t.get("summaries",e);return s?Vt(s,e):[]}catch(t){return[]}}async deleteConversationSummary(e,t){const s=Gt((await this.getConversationSummaries(t)).filter((t=>t.id!==e)),t);await this.safeStore("summaries",t,s)}async saveAppState(e,t){const s=Gt(e,t);await this.safeStore("appState",t,s),await this.safeStore("appState","userId",t)}async getAppState(e){try{const t=await this.ensureDB(),s=await t.get("appState",e);return s?Vt(s,e):null}catch(t){return null}}async migrateFromLocalStorage(e){const t={CHECKINS:"Soberi_checkins",JOURNAL:"Soberi_journal",MESSAGES:"Soberi_messages",PROGRESS:"Soberi_progress",TRIGGERS:"Soberi_triggers",TASKS:"Soberi_tasks",INSIGHTS:"Soberi_insights",MEMORY:"Soberi_memory",SUMMARIES:"Soberi_conversation_summaries",APP_STATE:"Soberiai-storage"};try{for(const[s,r]of Object.entries(t)){const t=localStorage.getItem(r);if(t){const r=s.toLowerCase();await this.safeStore("app_state"===r?"appState":r,e,t)}}}catch(s){throw s}}async cleanup(){this.db&&(this.db.close(),this.db=null)}},Xt=e=>Yt.getCheckIns(e),Zt=e=>Yt.getJournalEntries(e),Qt=(e,t)=>Yt.saveMessage(e,t),es=e=>Yt.getMessages(e),ts=e=>Yt.getProgress(e),ss=(e,t)=>Yt.updateProgress(e,t),rs=e=>Yt.getTriggerLogs(e),is=(e,t)=>Yt.saveTask(e,t),ns=e=>Yt.getTasks(e),as=e=>Yt.getInsights(e),os=e=>Yt.getMemoryEntries(e),ls=e=>Yt.getConversationSummaries(e),cs=(e,t)=>Yt.saveAppState(e,t),ds=e=>{const t="string"==typeof e?new Date(e):e;return d(t)?"Today":h(t)?"Yesterday":c(t,"MMM d, yyyy")},hs=e=>{const t="number"==typeof e||"string"==typeof e?new Date(e):e;return c(t,"h:mm a")},us=()=>c(new Date,"yyyy-MM-dd");const ms=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),gs=(e,t)=>{let s;return s=t<30?{"self-care":[{title:"Practice 5-minute mindfulness",description:"Sit quietly and focus on your breath for just 5 minutes. Notice when your mind wanders and gently return to your breathing.",timeEstimate:5},{title:"Take a hot shower or bath",description:"Use this time to practice being present with physical sensations rather than caught in thoughts.",timeEstimate:20},{title:"Drink water throughout the day",description:"Set a goal to drink at least 64oz of water today. Proper hydration supports brain function and physical healing.",timeEstimate:5}],physical:[{title:"Go for a 10-minute walk",description:"Even brief exercise releases endorphins that can reduce cravings and improve mood.",timeEstimate:10},{title:"Stretch for 5 minutes",description:"Simple stretching can reduce physical tension that might be triggering cravings or negative emotions.",timeEstimate:5},{title:"Get 30 minutes of sunlight",description:"Sunlight exposure helps regulate your body's natural rhythm and improves vitamin D production, both helpful for mood.",timeEstimate:30}],social:[{title:"Text one supportive person",description:"Send a message to someone who knows about and supports your recovery. Even brief connection helps.",timeEstimate:5},{title:"Identify recovery meeting options",description:"Find three in-person or online recovery meetings you could potentially attend this week.",timeEstimate:20},{title:"Practice saying no",description:"Write down and practice three different ways to decline if someone offers you substances.",timeEstimate:15}],productive:[{title:"Clean one small space",description:"Choose a drawer, shelf, or surface and organize it completely. Small accomplishments build confidence.",timeEstimate:15},{title:"Make your bed",description:"This simple act of order can provide a sense of accomplishment first thing in the morning.",timeEstimate:5},{title:"Create a daily schedule",description:"Plan tomorrow's activities hour by hour to provide structure and reduce decision fatigue.",timeEstimate:20}],recovery:[{title:"Write down 3 triggers",description:"Identify three specific situations, emotions, or people that trigger cravings for you.",timeEstimate:15},{title:"List your reasons for recovery",description:"Write down at least 5 specific reasons why you want to maintain your sobriety.",timeEstimate:20},{title:"Create a crisis card",description:"Write down 3 people you can call and 3 actions you can take when experiencing severe cravings.",timeEstimate:15}]}[e]:t<90?{"self-care":[{title:"Practice 15-minute meditation",description:"Extend your mindfulness practice to 15 minutes, focusing on acceptance of thoughts and feelings.",timeEstimate:15},{title:"Identify one boundary to set",description:"Reflect on a relationship or situation where you need to establish or reinforce a healthy boundary.",timeEstimate:20},{title:"Create a sleep routine",description:"Establish a consistent bedtime ritual to improve sleep quality, which supports recovery.",timeEstimate:30}],physical:[{title:"30-minute exercise session",description:"Choose any physical activity you enjoy and engage in it for at least 30 minutes.",timeEstimate:30},{title:"Prepare a nutritious meal",description:"Cook a balanced meal with protein, complex carbs, and vegetables to support brain healing.",timeEstimate:45},{title:"Check in with your body",description:"Do a full body scan and note any physical sensations, tension, or discomfort without judgment.",timeEstimate:10}],social:[{title:"Attend a recovery meeting",description:"Participate in an in-person or online recovery support meeting of your choice.",timeEstimate:60},{title:"Have a substance-free social interaction",description:"Connect with someone in a setting that doesn't involve substances (coffee, walk, activity).",timeEstimate:60},{title:"Practice sharing feelings",description:"Have a conversation where you honestly share how your recovery is going with someone you trust.",timeEstimate:30}],productive:[{title:"Set one small goal for the week",description:"Choose one achievable objective related to work, home, or personal development.",timeEstimate:15},{title:"Learn something new for 20 minutes",description:"Spend time reading, watching educational content, or practicing a new skill.",timeEstimate:20},{title:"Complete one postponed task",description:"Choose one task you've been avoiding and complete it to reduce background stress.",timeEstimate:30}],recovery:[{title:"Identify a recurring thought pattern",description:"Notice and write down a thought pattern that often precedes cravings or negative emotions.",timeEstimate:20},{title:"Practice a new coping strategy",description:"Choose and try a coping technique you haven't used before from the Coping Skills library.",timeEstimate:30},{title:"Reflect on recovery progress",description:"Write about how your relationship with substances has changed since beginning recovery.",timeEstimate:25}]}[e]:{"self-care":[{title:"Explore personal values",description:"Identify 3-5 core values that are important to you now and how recovery helps honor them.",timeEstimate:30},{title:"Practice self-compassion meditation",description:"Do a guided self-compassion meditation focused on extending kindness to yourself.",timeEstimate:20},{title:"Create a wellness plan",description:"Develop a written plan that addresses physical, emotional, social and spiritual well-being.",timeEstimate:45}],physical:[{title:"Try a new physical activity",description:"Experiment with a form of movement you haven't tried before or haven't done recently.",timeEstimate:45},{title:"Complete a fitness challenge",description:"Set a specific, measurable physical goal and complete it (specific number of reps, distance, etc).",timeEstimate:40},{title:"Practice progressive relaxation",description:"Systematically tense and relax each muscle group to release physical tension.",timeEstimate:20}],social:[{title:"Reach out to support someone else",description:"Contact someone else in recovery and offer encouragement or assistance.",timeEstimate:20},{title:"Share your recovery story",description:"Consider sharing some aspect of your journey with someone who might benefit from hearing it.",timeEstimate:30},{title:"Expand your social circle",description:"Identify one new social opportunity that aligns with your interests and values.",timeEstimate:60}],productive:[{title:"Work on a meaningful project",description:"Spend time on a project that gives you a sense of purpose and accomplishment.",timeEstimate:60},{title:"Organize digital or physical spaces",description:"Clear clutter from your email, files, or physical spaces to reduce background stress.",timeEstimate:45},{title:"Research a topic of interest",description:"Explore a subject you're curious about through reading, listening, or watching content.",timeEstimate:40}],recovery:[{title:"Create a relapse prevention plan",description:"Develop a detailed written plan for handling high-risk situations and warning signs.",timeEstimate:60},{title:"Practice a difficult conversation",description:"Write out or role play a challenging conversation related to your recovery.",timeEstimate:30},{title:"Review and update recovery goals",description:"Reflect on your initial recovery goals and adjust them based on what you've learned.",timeEstimate:45}]}[e],s[Math.floor(Math.random()*s.length)]};const ps=new class{constructor(){this.enabled=!0;const e="true"===localStorage.getItem("Soberi_analytics_disabled");this.enabled=!e,this.trackEvent("page_view",{path:window.location.pathname,referrer:document.referrer||"direct"})}trackEvent(e,t={}){if(!this.enabled)return;const s={event:e,timestamp:(new Date).toISOString(),sessionId:this.getSessionId(),...t};this.storeEvent(s)}optOut(){this.enabled=!1,localStorage.setItem("Soberi_analytics_disabled","true")}optIn(){this.enabled=!0,localStorage.removeItem("Soberi_analytics_disabled")}getSessionId(){let e=sessionStorage.getItem("Soberi_session_id");return e||(e=crypto.randomUUID?crypto.randomUUID():this.generateSimpleId(),sessionStorage.setItem("Soberi_session_id",e)),e}generateSimpleId(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}storeEvent(e){try{const t=JSON.parse(localStorage.getItem("Soberi_analytics_events")||"[]");t.push(e),t.length>100&&t.shift(),localStorage.setItem("Soberi_analytics_events",JSON.stringify(t))}catch(t){}}},fs={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_API_KEY:"sk-proj-sssssdffsdfwerwrwerdhhjmnvdfd2133443",VITE_APP_DESCRIPTION:"Your AI companion for addiction recovery and mental wellbeing",VITE_APP_NAME:"MyBoo.ai",VITE_APP_VERSION:"1.0.0"},ys=new Map,xs=e=>{const t=ys.get(e);return t?Object.fromEntries(Object.entries(t.stores).map((([e,t])=>[e,t.getState()]))):{}},vs=(e,t={})=>(s,r,i)=>{const{enabled:n,anonymousActionType:a,store:o,...l}=t;let c;try{c=(null!=n?n:"production"!==(fs?"production":void 0))&&window.__REDUX_DEVTOOLS_EXTENSION__}catch(p){}if(!c)return e(s,r,i);const{connection:d,...h}=((e,t,s)=>{if(void 0===e)return{type:"untracked",connection:t.connect(s)};const r=ys.get(s.name);if(r)return{type:"tracked",store:e,...r};const i={connection:t.connect(s),stores:{}};return ys.set(s.name,i),{type:"tracked",store:e,...i}})(o,c,l);let u=!0;i.setState=(e,t,n)=>{const c=s(e,t);if(!u)return c;const h=void 0===n?{type:a||"anonymous"}:"string"==typeof n?{type:n}:n;return void 0===o?(null==d||d.send(h,r()),c):(null==d||d.send({...h,type:`${o}/${h.type}`},{...xs(l.name),[o]:i.getState()}),c)};const m=(...e)=>{const t=u;u=!1,s(...e),u=t},g=e(i.setState,r,i);if("untracked"===h.type?null==d||d.init(g):(h.stores[h.store]=i,null==d||d.init(Object.fromEntries(Object.entries(h.stores).map((([e,t])=>[e,e===h.store?g:t.getState()]))))),i.dispatchFromDevtools&&"function"==typeof i.dispatch){let e=!1;const t=i.dispatch;i.dispatch=(...s)=>{"production"===(fs?"production":void 0)||"__setState"!==s[0].type||e||(e=!0),t(...s)}}return d.subscribe((e=>{var t;switch(e.type){case"ACTION":if("string"!=typeof e.payload)return;return bs(e.payload,(e=>{if("__setState"!==e.type)i.dispatchFromDevtools&&"function"==typeof i.dispatch&&i.dispatch(e);else{if(void 0===o)return void m(e.state);Object.keys(e.state).length;const t=e.state[o];if(null==t)return;JSON.stringify(i.getState())!==JSON.stringify(t)&&m(t)}}));case"DISPATCH":switch(e.payload.type){case"RESET":return m(g),void 0===o?null==d?void 0:d.init(i.getState()):null==d?void 0:d.init(xs(l.name));case"COMMIT":return void 0===o?void(null==d||d.init(i.getState())):null==d?void 0:d.init(xs(l.name));case"ROLLBACK":return bs(e.state,(e=>{if(void 0===o)return m(e),void(null==d||d.init(i.getState()));m(e[o]),null==d||d.init(xs(l.name))}));case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return bs(e.state,(e=>{void 0!==o?JSON.stringify(i.getState())!==JSON.stringify(e[o])&&m(e[o]):m(e)}));case"IMPORT_STATE":{const{nextLiftedState:s}=e.payload,r=null==(t=s.computedStates.slice(-1)[0])?void 0:t.state;if(!r)return;return m(void 0===o?r:r[o]),void(null==d||d.send(null,s))}case"PAUSE_RECORDING":return u=!u}return}})),g},bs=(e,t)=>{let s;try{s=JSON.parse(e)}catch(r){}void 0!==s&&t(s)};function ws(e,t){let s;try{s=e()}catch(r){return}return{getItem:e=>{var t;const r=e=>null===e?null:JSON.parse(e,void 0),i=null!=(t=s.getItem(e))?t:null;return i instanceof Promise?i.then(r):r(i)},setItem:(e,t)=>s.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>s.removeItem(e)}}const js=e=>t=>{try{const s=e(t);return s instanceof Promise?s:{then:e=>js(e)(s),catch(e){return this}}}catch(s){return{then(e){return this},catch:e=>js(e)(s)}}},ks=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((e,t)=>(s,r,i)=>{let n={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},a=!1;const o=new Set,l=new Set;let c;try{c=n.getStorage()}catch(f){}if(!c)return e(((...e)=>{s(...e)}),r,i);const d=js(n.serialize),h=()=>{const e=n.partialize({...r()});let t;const s=d({state:e,version:n.version}).then((e=>c.setItem(n.name,e))).catch((e=>{t=e}));if(t)throw t;return s},u=i.setState;i.setState=(e,t)=>{u(e,t),h()};const m=e(((...e)=>{s(...e),h()}),r,i);let g;const p=()=>{var e;if(!c)return;a=!1,o.forEach((e=>e(r())));const t=(null==(e=n.onRehydrateStorage)?void 0:e.call(n,r()))||void 0;return js(c.getItem.bind(c))(n.name).then((e=>{if(e)return n.deserialize(e)})).then((e=>{if(e){if("number"!=typeof e.version||e.version===n.version)return e.state;if(n.migrate)return n.migrate(e.state,e.version)}})).then((e=>{var t;return g=n.merge(e,null!=(t=r())?t:m),s(g,!0),h()})).then((()=>{null==t||t(g,void 0),a=!0,l.forEach((e=>e(g)))})).catch((e=>{null==t||t(void 0,e)}))};return i.persist={setOptions:e=>{n={...n,...e},e.getStorage&&(c=e.getStorage())},clearStorage:()=>{null==c||c.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>p(),hasHydrated:()=>a,onHydrate:e=>(o.add(e),()=>{o.delete(e)}),onFinishHydration:e=>(l.add(e),()=>{l.delete(e)})},p(),g||m})(e,t):((e,t)=>(s,r,i)=>{let n={storage:ws((()=>localStorage)),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},a=!1;const o=new Set,l=new Set;let c=n.storage;if(!c)return e(((...e)=>{s(...e)}),r,i);const d=()=>{const e=n.partialize({...r()});return c.setItem(n.name,{state:e,version:n.version})},h=i.setState;i.setState=(e,t)=>{h(e,t),d()};const u=e(((...e)=>{s(...e),d()}),r,i);let m;i.getInitialState=()=>u;const g=()=>{var e,t;if(!c)return;a=!1,o.forEach((e=>{var t;return e(null!=(t=r())?t:u)}));const i=(null==(t=n.onRehydrateStorage)?void 0:t.call(n,null!=(e=r())?e:u))||void 0;return js(c.getItem.bind(c))(n.name).then((e=>{if(e){if("number"!=typeof e.version||e.version===n.version)return[!1,e.state];if(n.migrate)return[!0,n.migrate(e.state,e.version)]}return[!1,void 0]})).then((e=>{var t;const[i,a]=e;if(m=n.merge(a,null!=(t=r())?t:u),s(m,!0),i)return d()})).then((()=>{null==i||i(m,void 0),m=r(),a=!0,l.forEach((e=>e(m)))})).catch((e=>{null==i||i(void 0,e)}))};return i.persist={setOptions:e=>{n={...n,...e},e.storage&&(c=e.storage)},clearStorage:()=>{null==c||c.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>g(),hasHydrated:()=>a,onHydrate:e=>(o.add(e),()=>{o.delete(e)}),onFinishHydration:e=>(l.add(e),()=>{l.delete(e)})},n.skipHydration||g(),m||u})(e,t),_s="Soberi_checkins",Ss="Soberi_insights",Ns="Soberi_memory",Cs=e=>(e=>{const t=localStorage.getItem(_s);if(!t)return[];try{return Vt(t,e)}catch(s){return[]}})().find((t=>t.date===e)),Es=3072;function Ts(e){return Array.isArray(e)&&e.length===Es&&e.every((e=>"number"==typeof e&&!isNaN(e)&&isFinite(e)))}async function Is(e){if(!e||"string"!=typeof e||0===e.trim().length)return[];const t=e.length>18e3?e.substring(0,18e3):e;try{const e=await fetch("https://api.openai.com/v1/embeddings",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer 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"},body:JSON.stringify({input:t,model:"text-embedding-3-large"})});if(!e.ok){await e.json();return[]}const s=await e.json();if(!s||!s.data||!Array.isArray(s.data)||0===s.data.length)return[];const r=s.data[0].embedding;return Ts(r)?r:[]}catch(s){return[]}}const As=Object.freeze(Object.defineProperty({__proto__:null,generateFallbackEmbedding:function(e){let t=0;for(let i=0;i<e.length;i++){t=(t<<5)-t+e.charCodeAt(i),t&=t}const s=new Array(Es);let r=Math.abs(t);for(let i=0;i<Es;i++)r=(9301*r+49297)%233280,s[i]=r/233280*2-1;return s},getOpenAIEmbedding:Is,validateEmbedding:Ts},Symbol.toStringTag,{value:"Module"})),Ps=e=>{const t=[/I (?:feel|am feeling) (.*?)(?:\.|\?|!|$)/i,/I'm (?:feeling) (.*?)(?:\.|\?|!|$)/i,/I (?:want|need|wish) (.*?)(?:\.|\?|!|$)/i,/I'm (?:trying to|attempting to) (.*?)(?:\.|\?|!|$)/i,/I (?:used to|would) (.*?)(?:\.|\?|!|$)/i,/I've (?:been|had|experienced) (.*?)(?:\.|\?|!|$)/i,/[Mm]y (?:family|friend|partner|spouse|boyfriend|girlfriend|wife|husband|father|mother|dad|mom|brother|sister|child|son|daughter) (.*?)(?:\.|\?|!|$)/i,/I (?:like|love|enjoy|prefer) (.*?)(?:\.|\?|!|$)/i,/I (?:hate|dislike|can't stand|don't like) (.*?)(?:\.|\?|!|$)/i,/I (?:relapsed|slipped|used|took) (.*?)(?:\.|\?|!|$)/i,/I've been (?:sober|clean|in recovery) (.*?)(?:\.|\?|!|$)/i,/(?:triggers|makes me want to use|makes me crave) (.*?)(?:\.|\?|!|$)/i,/(?:helps me|works for me|coping strategy) (.*?)(?:\.|\?|!|$)/i],s=[];for(const r of t){const t=e.match(r);t&&t.length>0&&s.push(t[0])}return s},Os=e=>{const t={relapse:["relapse","slip","used again","fell off","back to square one","using again","took","drank"],craving:["craving","urge","want to use","tempted","thinking about using","desire","need"],triggers:["trigger","makes me want","when I see","around people who","reminded","places","situations"],emotions:["feel","emotion","sad","angry","happy","anxious","depressed","joy","shame","guilt"],recovery:["sober","clean","recovery","journey","path","healing","sobriety","abstinence","program"],relationships:["friend","family","partner","spouse","relationship","people","support","social"],health:["sleep","eat","exercise","health","physical","doctor","medication","energy","fatigue"],goals:["goal","plan","future","aim","want to","trying to","hope","aspire","dream"],coping:["cope","strategy","technique","method","way to handle","deal with","manage","tool"],celebration:["proud","achievement","milestone","celebrate","success","victory","accomplishment"],challenge:["difficult","hard","challenge","struggle","tough","obstacle","hurdle","problem"]},s=[];for(const[r,i]of Object.entries(t))i.some((t=>e.toLowerCase().includes(t)))&&s.push(r);return s},Rs=e=>{const t={joyful:["happy","joy","excited","thrilled","great","wonderful","fantastic","ecstatic","pleased"],sad:["sad","down","depressed","unhappy","miserable","blue","melancholy","heartbroken"],angry:["angry","mad","furious","irritated","annoyed","frustrated","rage","resent"],anxious:["anxious","worried","nervous","scared","afraid","panic","stress","tense","fear"],hopeful:["hope","hopeful","optimistic","looking forward","positive","encouraged","bright"],ashamed:["shame","ashamed","embarrassed","guilty","regret","remorse","sorry"],grateful:["grateful","thankful","appreciate","blessed","fortunate","lucky"],proud:["proud","accomplished","satisfied","achievement","fulfilled"],neutral:["okay","fine","alright","neutral","so-so","meh","average"]};let s="neutral",r=0;for(const[i,n]of Object.entries(t)){const t=n.filter((t=>e.toLowerCase().includes(t))).length;t>r&&(r=t,s=i)}return s};function Ds(e){if(!e||!Array.isArray(e))return;if(1536!==e.length)return;const t=e.map((e=>{const t=Number(e);return isNaN(t)||!isFinite(t)?0:t}));return t.filter((e=>0===e)).length>.1*e.length?void 0:t}function $s(e,t){if(!e||!t||e.length!==t.length)return 0;let s=0,r=0,i=0;for(let n=0;n<e.length;n++)s+=e[n]*t[n],r+=e[n]*e[n],i+=t[n]*t[n];return 0===r||0===i?0:s/(Math.sqrt(r)*Math.sqrt(i))}const Ls=async(e,t=5,s)=>{const r=(e=>{const t=localStorage.getItem(Ns);if(!t)return[];try{return Vt(t,e)}catch(s){return[]}})(s);if(0===r.length)return[];const i=r.map((e=>({...e,embedding:Ds(e.embedding)}))),n=i.filter((e=>void 0!==e.embedding)).length>=.8*r.length;let a;if(n)try{const t=await Is(e);a=Ds(t)}catch(d){a=void 0}if(n&&a){const e=i.filter((e=>void 0!==e.embedding)).map((e=>({memory:e,score:$s(a,e.embedding)}))).filter((e=>e.score>0));if(e.sort(((e,t)=>t.score-e.score)),e.length>=t)return e.slice(0,t).map((e=>{const t=e.memory;return t.lastAccessed=Date.now(),t.accessCount=(t.accessCount||0)+1,t}))}const o=Os(e),l=Rs(e),c=i.map((e=>{let t=0;const s=Os(e.content);t+=s.filter((e=>o.includes(e))).length/Math.max(s.length,1)*10;Rs(e.content)===l&&(t+=5),t+=e.importance;const r=(Date.now()-new Date(e.date).getTime())/864e5;return{memory:e,score:.4*t+.4*Math.max(0,10-Math.min(r,10))+.2*e.importance+.2*e.accessCount}}));return c.sort(((e,t)=>t.score-e.score)),c.slice(0,t).map((e=>e.memory))},Ms=async(e,t)=>{const s=await Ls(e,void 0,t),r=(e=>{const t=localStorage.getItem(Ss);if(!t)return[];try{return Vt(t,e)}catch(s){return[]}})(t),i=r.filter((e=>"insight"===e.type&&"ai"===e.source)).sort(((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()))[0];let n=[...s];if(i){s.some((e=>e.content.includes(i.content)))||n.unshift({id:`ai-insight-${i.id}`,date:i.date,content:i.content,type:"breakthrough",importance:8,tags:["insight","ai"],accessCount:0})}if(0===n.length)return"";let a="--- User's Relevant Personal Memories ---\n";return n.forEach((e=>{a+=`Type: ${e.type}\n`,a+=`Date: ${new Date(e.date).toLocaleString()}\n`,a+=`Content: ${e.content}\n`,e.tags&&e.tags.length>0&&(a+=`Tags: ${e.tags.join(", ")}\n`),a+="---\n"})),a+="--------------------------------------",a},Bs=()=>{let e=localStorage.getItem("Soberi_userId");return null===e&&(e=D(),localStorage.setItem("Soberi_userId",e)),e},zs=n()(vs(ks(((e,t)=>({activeTab:"chat",isLoading:!1,checkIns:[],journalEntries:[],messages:[],triggerLogs:[],tasks:[],insights:[],memories:[],conversationSummaries:[],userProgress:{currentStreak:0,longestStreak:0,startDate:null,lastCheckInDate:null,totalDaysClean:0,relapseCount:0,milestones:[]},setActiveTab:t=>{ps.trackEvent("page_view",{tab:t}),e({activeTab:t})},setIsLoading:t=>e({isLoading:t}),submitCheckIn:async(s,r,i)=>{const n=Bs(),a=us();if(await Xt(n).then((e=>e.find((e=>e.date===a)))))return;const o={id:ms(),date:a,mood:s,cravingLevel:r,notes:i};await((e,t)=>Yt.saveCheckIn(e,t))(o,n);const l=`Check-in: Mood was ${s}, craving level was ${r}.${i?` Notes: ${i}`:""}`,c={id:ms(),date:(new Date).toISOString(),content:l,type:"personal_detail",importance:"extreme"===r||"severe"===r?9:7,tags:["mood","craving",s,r],accessCount:0};await t().addMemory(c);const d=(await Xt(n)).map((e=>e.date)),h=Array.from(new Set(d.map((e=>e.slice(0,10))))),u=function(e){if(!e||0===e.length)return 0;const t=Array.from(new Set(e.map((e=>e.slice(0,10))))).sort(((e,t)=>new Date(t).getTime()-new Date(e).getTime())),s=new Date;let r=0;new Date(t[0]);let i=0;const n=t[0]===s.toISOString().slice(0,10),a=t[0]===new Date(s.getTime()-864e5).toISOString().slice(0,10);if(!n&&!a)return 0;for(;i<t.length;){const e=new Date(s.getTime()-864e5*r).toISOString().slice(0,10);if(t[i]!==e)break;r++,i++}return r}(d),m=await ts(n),g=!m.startDate,p={...m,lastCheckInDate:a,startDate:m.startDate||a,currentStreak:u,longestStreak:Math.max(u,m.longestStreak),totalDaysClean:h.length};if(await ss(p,n),ps.trackEvent("check_in_completed",{mood:s,cravingLevel:r,hasNotes:i.length>0,isFirstCheckIn:g}),u>0&&u%7==0){const e={id:ms(),date:(new Date).toISOString(),type:"streak",value:u,description:`${u} day streak achieved!`},s=[...m.milestones||[],e];await ss({...p,milestones:s},n);const r={id:ms(),date:(new Date).toISOString(),content:`User reached a ${u} day streak milestone`,type:"breakthrough",importance:8,tags:["streak","milestone","achievement"],accessCount:0};await t().addMemory(r),ps.trackEvent("streak_milestone",{days:u,isLongestStreak:u>=m.longestStreak})}await t().suggestTasks(),e({checkIns:await Xt(n),userProgress:await ts(n)})},addJournalEntry:async(s,r)=>{const i=Bs(),n={id:ms(),date:(new Date).toISOString(),content:s,tags:r};await((e,t)=>Yt.saveJournalEntry(e,t))(n,i);const a=Ps(s).length>0?8:6,o={id:ms(),date:(new Date).toISOString(),content:s,type:"personal_detail",importance:a,tags:[...r,"journal"],accessCount:0};await t().addMemory(o),ps.trackEvent("journal_entry_created",{wordCount:s.split(/\s+/).length,tagCount:r.length,hasTags:r.length>0}),e({journalEntries:await Zt(i)})},removeJournalEntry:async t=>{const s=Bs();await((e,t)=>Yt.deleteJournalEntry(e,t))(t,s),e({journalEntries:await Zt(s)})},addTriggerLog:async(s,r,i,n,a)=>{const o=Bs(),l={id:ms(),date:(new Date).toISOString(),trigger:s,intensity:r,strategy:i,successful:n,notes:a};await((e,t)=>Yt.saveTriggerLog(e,t))(l,o);const c=`Trigger: ${s} (intensity: ${r}/10). Strategy used: ${i}. ${n?"Strategy was successful":"Strategy was not successful"}.${a?` Notes: ${a}`:""}`,d={id:ms(),date:(new Date).toISOString(),content:c,type:"trigger",importance:r>=7?9:7,tags:["trigger",n?"successful_strategy":"unsuccessful_strategy"],accessCount:0};if(await t().addMemory(d),n){const e={id:ms(),date:(new Date).toISOString(),content:`Effective coping strategy: ${i} for trigger: ${s}`,type:"coping_strategy",importance:8,tags:["strategy","effective"],accessCount:0};await t().addMemory(e)}ps.trackEvent("trigger_log_created",{intensity:r,successful:n,hasNotes:a.length>0}),e({triggerLogs:await rs(o)})},removeTriggerLog:async t=>{const s=Bs();await((e,t)=>Yt.deleteTriggerLog(e,t))(t,s),e({triggerLogs:await rs(s)})},addTask:async(s,r,i,n,a,o)=>{const l=Bs(),c={id:ms(),title:s,description:r,completed:!1,date:i,priority:n,category:a,timeEstimate:o};await is(c,l);const d={id:ms(),date:(new Date).toISOString(),content:`User set a goal: ${s}${r?` - ${r}`:""}`,type:"goal",importance:"high"===n||"recovery"===a?7:5,tags:["goal",a],accessCount:0};await t().addMemory(d),ps.trackEvent("task_created",{priority:n,category:a,hasTimeEstimate:!!o}),e({tasks:await ns(l)})},removeTask:async t=>{const s=Bs();await((e,t)=>Yt.deleteTask(e,t))(t,s),e({tasks:await ns(s)})},markTaskComplete:async s=>{const r=Bs();await((e,t)=>Yt.completeTask(e,t))(s,r);const i=(await ns(r)).find((e=>e.id===s));if(i){const e={id:ms(),date:(new Date).toISOString(),content:`User completed the task: ${i.title}`,type:"breakthrough",importance:"high"===i.priority||"recovery"===i.category?7:5,tags:["achievement","completed_task"],accessCount:0};await t().addMemory(e)}ps.trackEvent("task_completed",{taskId:s}),e({tasks:await ns(r)})},suggestTasks:async()=>{const t=Bs(),s=us(),r=(await ts(t)).currentStreak;if((await ns(t)).filter((e=>e.date===s)).length<3){const i=Math.floor(3*Math.random())+3,n=["self-care","physical","social","productive","recovery"],a=["high","medium","low"];for(let e=0;e<i;e++){const e=n[Math.floor(Math.random()*n.length)],i=a[Math.floor(Math.random()*a.length)],{title:o,description:l,timeEstimate:c}=gs(e,r),d={id:ms(),title:o,description:l,completed:!1,date:s,priority:i,category:e,timeEstimate:c};await is(d,t)}e({tasks:await ns(t)})}},addInsight:async(s,r,i)=>{const n=Bs(),a={id:ms(),date:(new Date).toISOString(),content:s,type:r,source:i,shown:!1};if(await((e,t)=>Yt.saveInsight(e,t))(a,n),"insight"===r){const e={id:ms(),date:(new Date).toISOString(),content:`Recovery insight: ${s}`,type:"breakthrough",importance:7,tags:["insight","recovery_knowledge"],accessCount:0};await t().addMemory(e)}e({insights:await as(n)})},markInsightSeen:async t=>{const s=Bs();await((e,t)=>Yt.markInsightAsShown(e,t))(t,s),e({insights:await as(s)})},updateInsightNote:async(t,s)=>{const r=Bs();await(async(e,t,s)=>{const r=(await Yt.getInsights(s)).map((s=>s.id===e?{...s,userNote:t}:s));for(const i of r)if(i.id===e){await Yt.saveInsight(i,s);break}})(t,s,r),e({insights:await as(r)})},addMemory:async t=>{const s=Bs();if(!t.embedding)try{if(t.embedding=await Is(t.content),!t.embedding||1536!==t.embedding.length){const{generateFallbackEmbedding:e}=await I((async()=>{const{generateFallbackEmbedding:e}=await Promise.resolve().then((()=>As));return{generateFallbackEmbedding:e}}),void 0);t.embedding=e(t.content)}}catch(r){const{generateFallbackEmbedding:e}=await I((async()=>{const{generateFallbackEmbedding:e}=await Promise.resolve().then((()=>As));return{generateFallbackEmbedding:e}}),void 0);t.embedding=e(t.content)}await((e,t)=>Yt.saveMemoryEntry(e,t))(t,s),e({memories:await os(s)})},removeMemory:async t=>{const s=Bs();await((e,t)=>Yt.deleteMemoryEntry(e,t))(t,s),e({memories:await os(s)})},addConversationSummary:async t=>{const s=Bs();await((e,t)=>Yt.saveConversationSummary(e,t))(t,s),e({conversationSummaries:await ls(s)})},getRelevantMemoriesForContext:async(e,t=5)=>{const s=Bs();return await Ls(e,t,s)},generateContextFromMemories:async e=>{const t=Bs();return await Ms(e,t)},sendMessage:async(s,r)=>{const i=Bs();if(e({isLoading:!0}),!r){e({isLoading:!1});const t={id:ms(),content:"Error: Could not send message. User identification failed.",sender:"ai",timestamp:Date.now()};return Qt(t,i),void e((e=>({messages:[...e.messages,t],isLoading:!1})))}const n={id:ms(),content:s,sender:"user",timestamp:Date.now()};Qt(n,i);const a=Os(s),o=Rs(s),l=Ps(s);if(l.length>0)for(const e of l){const s={id:ms(),date:(new Date).toISOString(),content:e,type:"personal_detail",importance:8,tags:[...a,o],accessCount:0};await t().addMemory(s)}if(s.toLowerCase().includes("relapse")||s.toLowerCase().includes("slip")||s.toLowerCase().includes("used again")){const e={id:ms(),date:(new Date).toISOString(),content:`User mentioned potential relapse: ${s.substring(0,100)}${s.length>100?"...":""}`,type:"relapse",importance:10,tags:["relapse","setback"],accessCount:0};await t().addMemory(e)}ps.trackEvent("chat_message_sent",{messageLength:s.length,wordCount:s.split(/\s+/).length,messageType:"user"}),e((e=>({messages:[...e.messages,n]})));const c=t().messages,d=c.length-1,h=d>4&&d%4==0;let u=null;const m="https://soberi-backend-service-280233666207.europe-west1.run.app",g="sk-proj-sssssdffsdfwerwrwerdhhjmnvdfd2133443";if(4===d||h){e({isLoading:!0});const s=c.slice(d-4,d);let i="Summarize the following conversation concisely, capturing key points, decisions, and emotional tone. Focus on creating a brief that can inform future interactions:\n";if(s.forEach((e=>{i+=`${"user"===e.sender?"User":"AI"}: ${e.content}\n`})),h){const e=t().conversationSummaries.filter((e=>"ai_generated"===e.summaryType));if(e.length>0){const t=e[e.length-1];i=`Previous summary: "${t.summary}"\n\nBased on this previous summary and the following new messages, provide an updated and comprehensive summary of the entire conversation so far. The summary should be concise and highlight key developments:\n${s.map((e=>`${"user"===e.sender?"User":"AI"}: ${e.content}`)).join("\n")}`}}try{const e=t().userProgress,n={message:i,recentMessages:[],userId:r,contextBriefing:"This is a request to summarize the conversation provided in the main message. Please focus on that task. you are to generate a summary that can inform future interactions and make the user feel more connected to you",userProgress:e},a=await fetch(`${m}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json","X-API-KEY":g},body:JSON.stringify(n)});if(!a.ok){const e=await a.json();throw new Error(e.error||`AI Summary request failed with status ${a.status}`)}const o=(await a.json()).response;u={id:ms(),date:(new Date).toISOString(),summary:o,messageIds:s.map((e=>e.id)),topics:Os(o),emotionalState:Rs(o),keyInsights:Ps(o),summaryType:"ai_generated"},t().addConversationSummary(u)}catch(j){}}const p=(e=>{const t=Date.now()-6048e5,s=e.checkIns.filter((e=>new Date(e.date).getTime()>=t)).slice(-2),r=e.journalEntries.filter((e=>new Date(e.date).getTime()>=t)).slice(-2),i=e.triggerLogs.filter((e=>new Date(e.date).getTime()>=t)).slice(-2),n=e.tasks.filter((e=>e.date&&new Date(e.date).getTime()>=t)).slice(-2),a=e.insights.filter((e=>new Date(e.date).getTime()>=t)).slice(-2);let o="--- User's Recent Activity Summary (Last 7 Days) ---\n";s.length>0&&(o+=`\nRecent Check-ins (${s.length}):\n`,s.forEach((e=>{o+=`- On ${new Date(e.date).toLocaleDateString()}: Mood - ${e.mood}, Cravings - ${e.cravingLevel}${e.notes?`, Notes: ${e.notes.substring(0,50)}...`:""}\n`}))),r.length>0&&(o+=`\nRecent Journal Entries (${r.length}):\n`,r.forEach((e=>{o+=`- On ${new Date(e.date).toLocaleDateString()}: ${e.content.substring(0,100)}...\n`}))),i.length>0&&(o+=`\nRecent Trigger Logs (${i.length}):\n`,i.forEach((e=>{o+=`- On ${new Date(e.date).toLocaleDateString()}: Trigger - ${e.trigger}, Intensity - ${e.intensity}${e.successful?", Strategy Successful":", Strategy Failed"}${e.notes?`, Notes: ${e.notes.substring(0,50)}...`:""}\n`})));const l=n.filter((e=>e.completed)),c=n.filter((e=>!e.completed));return n.length>0&&(o+=`\nRecent Tasks (${n.length}):\n`,c.length>0&&(o+=`Pending (${c.length}):\n`,c.slice(-2).forEach((e=>{o+=`- ${e.title}${e.date?` (Due ${new Date(e.date).toLocaleDateString()})`:""}\n`}))),l.length>0&&(o+=`Completed (${l.length}):\n`,l.slice(-2).forEach((e=>{o+=`- ${e.title} (Completed)\n`})))),a.length>0&&(o+=`\nRecent Insights (${a.length}):\n`,a.forEach((e=>{o+=`- ${e.content.substring(0,100)}...\n`}))),o+="--------------------------------------------",o})(t()),f=t().userProgress,y=await t().generateContextFromMemories(s),x=c.slice(-4).map((e=>({sender:e.sender,content:e.content}))),v=t().conversationSummaries.filter((e=>"ai_generated"===e.summaryType)),b=u||(v.length>0?v[v.length-1]:null),w=Gt({userId:r,message:s,chatSummary:(null==b?void 0:b.summary)||"",recentMessages:x,clientMemoryContext:y,userProgress:f,recentActivitySummary:p},i);try{const s=await fetch(`${m}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json","X-API-KEY":g},body:JSON.stringify({encryptedPayload:w,userId:i})});if(!s.ok){const e=await s.json();throw new Error(e.error||`API chat request failed with status ${s.status}`)}const r=(await s.json()).response,n=r.match(/<SOBERI_INSIGHT>(.*?)<\/SOBERI_INSIGHT>/s);let a=r,o=null;n&&n[1]&&(o=n[1].trim(),a=r.replace(n[0],"").trim());const l={id:ms(),content:a,sender:"ai",timestamp:Date.now()};Qt(l,i),o&&t().addInsight(o,"insight","ai"),e((e=>({messages:[...e.messages,l],isLoading:!1})))}catch(j){let t="An unknown error occurred with the AI backend.";j instanceof Error?t=j.message:"string"==typeof j&&(t=j);const s={id:ms(),content:`Error: ${t}`,sender:"ai",timestamp:Date.now()};Qt(s,i),e((e=>({messages:[...e.messages,s],isLoading:!1})))}},resetProgress:async()=>{const s=Bs();await(async e=>{const t=await Yt.getProgress(e),s={...t,currentStreak:0,relapseCount:t.relapseCount+1};return await Yt.updateProgress(s,e)})(s);const r={id:ms(),date:(new Date).toISOString(),content:"User reset their progress counter",type:"relapse",importance:10,tags:["relapse","reset"],accessCount:0};await t().addMemory(r),e({userProgress:await ts(s)})},markRelapse:async()=>{const s=Bs(),r=await ts(s),i={...r,currentStreak:0,relapseCount:r.relapseCount+1};await ss(i,s);const n={id:ms(),date:(new Date).toISOString(),content:`User experienced a relapse after ${r.currentStreak} days`,type:"relapse",importance:10,tags:["relapse","setback"],accessCount:0};await t().addMemory(n),e({userProgress:i})},initializeStore:async()=>{const s=Bs();if(s)try{const[r,i,n,a,o,l,c,d,h]=await Promise.all([Xt(s),Zt(s),es(s),ts(s),rs(s),ns(s),as(s),os(s),ls(s)]);e({checkIns:r,journalEntries:i,messages:n,userProgress:a,triggerLogs:o,tasks:l,insights:c,memories:d,conversationSummaries:h});const u=us();0===l.filter((e=>e.date===u)).length&&await t().suggestTasks()}catch(r){}}})),{name:"Soberiai-storage",partialize:e=>({checkIns:e.checkIns,journalEntries:e.journalEntries,messages:e.messages,userProgress:e.userProgress,triggerLogs:e.triggerLogs,tasks:e.tasks,insights:e.insights,memories:e.memories,conversationSummaries:e.conversationSummaries}),storage:{getItem:async e=>{const t=localStorage.getItem("Soberi_userId");if(!t)return null;const s=await(e=>Yt.getAppState(e))(t);return s||null},setItem:async(e,t)=>{const s=localStorage.getItem("Soberi_userId");s&&await cs(t,s)},removeItem:async e=>{const t=localStorage.getItem("Soberi_userId");t&&await cs(null,t)}}})));class Us extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class Hs extends Us{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Fs extends Us{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class qs extends Us{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Ws,Js;(Js=Ws||(Ws={})).Any="any",Js.ApNortheast1="ap-northeast-1",Js.ApNortheast2="ap-northeast-2",Js.ApSouth1="ap-south-1",Js.ApSoutheast1="ap-southeast-1",Js.ApSoutheast2="ap-southeast-2",Js.CaCentral1="ca-central-1",Js.EuCentral1="eu-central-1",Js.EuWest1="eu-west-1",Js.EuWest2="eu-west-2",Js.EuWest3="eu-west-3",Js.SaEast1="sa-east-1",Js.UsEast1="us-east-1",Js.UsWest1="us-west-1",Js.UsWest2="us-west-2";var Ks=function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function a(e){try{l(r.next(e))}catch(t){n(t)}}function o(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};class Gs{constructor(e,{headers:t={},customFetch:s,region:r=Ws.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=(e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>I((async()=>{const{default:e}=await Promise.resolve().then((()=>or));return{default:e}}),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)})(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return Ks(this,void 0,void 0,(function*(){try{const{headers:r,method:i,body:n}=t;let a,o={},{region:l}=t;l||(l=this.region),l&&"any"!==l&&(o["x-region"]=l),n&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&("undefined"!=typeof Blob&&n instanceof Blob||n instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",a=n):"string"==typeof n?(o["Content-Type"]="text/plain",a=n):"undefined"!=typeof FormData&&n instanceof FormData?a=n:(o["Content-Type"]="application/json",a=JSON.stringify(n)));const c=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),r),body:a}).catch((e=>{throw new Hs(e)})),d=c.headers.get("x-relay-error");if(d&&"true"===d)throw new Fs(c);if(!c.ok)throw new qs(c);let h,u=(null!==(s=c.headers.get("Content-Type"))&&void 0!==s?s:"text/plain").split(";")[0].trim();return h="application/json"===u?yield c.json():"application/octet-stream"===u?yield c.blob():"text/event-stream"===u?c:"multipart/form-data"===u?yield c.formData():yield c.text(),{data:h,error:null}}catch(r){return{data:null,error:r}}}))}}var Vs={},Ys={},Xs={},Zs={},Qs={},er={},tr=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();const sr=tr.fetch,rr=tr.fetch.bind(tr),ir=tr.Headers,nr=tr.Request,ar=tr.Response,or=Object.freeze(Object.defineProperty({__proto__:null,Headers:ir,Request:nr,Response:ar,default:rr,fetch:sr},Symbol.toStringTag,{value:"Module"})),lr=s(or);var cr={};Object.defineProperty(cr,"__esModule",{value:!0});let dr=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};cr.default=dr;var hr=r&&r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(er,"__esModule",{value:!0});const ur=hr(lr),mr=hr(cr);er.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=ur.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let s=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((async e=>{var t,s,r;let i=null,n=null,a=null,o=e.status,l=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(n="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const r=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),c=null===(s=e.headers.get("content-range"))||void 0===s?void 0:s.split("/");r&&c&&c.length>1&&(a=parseInt(c[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(n)&&(n.length>1?(i={code:"PGRST116",details:`Results contain ${n.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},n=null,a=null,o=406,l="Not Acceptable"):n=1===n.length?n[0]:null)}else{const t=await e.text();try{i=JSON.parse(t),Array.isArray(i)&&404===e.status&&(n=[],i=null,o=200,l="OK")}catch(c){404===e.status&&""===t?(o=204,l="No Content"):i={message:t}}if(i&&this.isMaybeSingle&&(null===(r=null==i?void 0:i.details)||void 0===r?void 0:r.includes("0 rows"))&&(i=null,o=200,l="OK"),i&&this.shouldThrowOnError)throw new mr.default(i)}return{error:i,data:n,count:a,status:o,statusText:l}}));return this.shouldThrowOnError||(s=s.catch((e=>{var t,s,r;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(s=null==e?void 0:e.stack)&&void 0!==s?s:""}`,hint:"",code:`${null!==(r=null==e?void 0:e.code)&&void 0!==r?r:""}`},data:null,count:null,status:0,statusText:""}}))),s.then(e,t)}returns(){return this}overrideTypes(){return this}};var gr=r&&r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Qs,"__esModule",{value:!0});const pr=gr(er);let fr=class extends pr.default{select(e){let t=!1;const s=(null!=e?e:"*").split("").map((e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e))).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:r,referencedTable:i=r}={}){const n=i?`${i}.order`:"order",a=this.url.searchParams.get(n);return this.url.searchParams.set(n,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${void 0===s?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const r=void 0===s?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:r=s}={}){const i=void 0===r?"offset":`${r}.offset`,n=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(n,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:r=!1,wal:i=!1,format:n="text"}={}){var a;const o=[e?"analyze":null,t?"verbose":null,s?"settings":null,r?"buffers":null,i?"wal":null].filter(Boolean).join("|"),l=null!==(a=this.headers.Accept)&&void 0!==a?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${n}; for="${l}"; options=${o};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Qs.default=fr;var yr=r&&r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Zs,"__esModule",{value:!0});const xr=yr(Qs);let vr=class extends xr.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map((e=>"string"==typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`)).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:r}={}){let i="";"plain"===r?i="pl":"phrase"===r?i="ph":"websearch"===r&&(i="w");const n=void 0===s?"":`(${s})`;return this.url.searchParams.append(e,`${i}fts${n}.${t}`),this}match(e){return Object.entries(e).forEach((([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)})),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const r=s?`${s}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};Zs.default=vr;var br=r&&r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Xs,"__esModule",{value:!0});const wr=br(Zs);Xs.default=class{constructor(e,{headers:t={},schema:s,fetch:r}){this.url=e,this.headers=t,this.schema=s,this.fetch=r}select(e,{head:t=!1,count:s}={}){const r=t?"HEAD":"GET";let i=!1;const n=(null!=e?e:"*").split("").map((e=>/\s/.test(e)&&!i?"":('"'===e&&(i=!i),e))).join("");return this.url.searchParams.set("select",n),s&&(this.headers.Prefer=`count=${s}`),new wr.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:s=!0}={}){const r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),s||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new wr.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:r,defaultToNull:i=!0}={}){const n=[`resolution=${s?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&n.push(this.headers.Prefer),r&&n.push(`count=${r}`),i||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new wr.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new wr.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new wr.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};var jr={},kr={};Object.defineProperty(kr,"__esModule",{value:!0}),kr.version=void 0,kr.version="0.0.0-automated",Object.defineProperty(jr,"__esModule",{value:!0}),jr.DEFAULT_HEADERS=void 0;const _r=kr;jr.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${_r.version}`};var Sr=r&&r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ys,"__esModule",{value:!0});const Nr=Sr(Xs),Cr=Sr(Zs),Er=jr;Ys.default=class e{constructor(e,{headers:t={},schema:s,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},Er.DEFAULT_HEADERS),t),this.schemaName=s,this.fetch=r}from(e){const t=new URL(`${this.url}/${e}`);return new Nr.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:r=!1,count:i}={}){let n;const a=new URL(`${this.url}/rpc/${e}`);let o;s||r?(n=s?"HEAD":"GET",Object.entries(t).filter((([e,t])=>void 0!==t)).map((([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`])).forEach((([e,t])=>{a.searchParams.append(e,t)}))):(n="POST",o=t);const l=Object.assign({},this.headers);return i&&(l.Prefer=`count=${i}`),new Cr.default({method:n,url:a,headers:l,schema:this.schemaName,body:o,fetch:this.fetch,allowEmpty:!1})}};var Tr=r&&r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Vs,"__esModule",{value:!0}),Vs.PostgrestError=Vs.PostgrestBuilder=Vs.PostgrestTransformBuilder=Vs.PostgrestFilterBuilder=Vs.PostgrestQueryBuilder=Vs.PostgrestClient=void 0;const Ir=Tr(Ys);Vs.PostgrestClient=Ir.default;const Ar=Tr(Xs);Vs.PostgrestQueryBuilder=Ar.default;const Pr=Tr(Zs);Vs.PostgrestFilterBuilder=Pr.default;const Or=Tr(Qs);Vs.PostgrestTransformBuilder=Or.default;const Rr=Tr(er);Vs.PostgrestBuilder=Rr.default;const Dr=Tr(cr);Vs.PostgrestError=Dr.default;var $r=Vs.default={PostgrestClient:Ir.default,PostgrestQueryBuilder:Ar.default,PostgrestFilterBuilder:Pr.default,PostgrestTransformBuilder:Or.default,PostgrestBuilder:Rr.default,PostgrestError:Dr.default};const{PostgrestClient:Lr,PostgrestQueryBuilder:Mr,PostgrestFilterBuilder:Br,PostgrestTransformBuilder:zr,PostgrestBuilder:Ur,PostgrestError:Hr}=$r,Fr={"X-Client-Info":"realtime-js/2.11.2"};var qr,Wr,Jr,Kr,Gr,Vr,Yr,Xr,Zr,Qr,ei;(Wr=qr||(qr={}))[Wr.connecting=0]="connecting",Wr[Wr.open=1]="open",Wr[Wr.closing=2]="closing",Wr[Wr.closed=3]="closed",(Kr=Jr||(Jr={})).closed="closed",Kr.errored="errored",Kr.joined="joined",Kr.joining="joining",Kr.leaving="leaving",(Vr=Gr||(Gr={})).close="phx_close",Vr.error="phx_error",Vr.join="phx_join",Vr.reply="phx_reply",Vr.leave="phx_leave",Vr.access_token="access_token",(Yr||(Yr={})).websocket="websocket",(Zr=Xr||(Xr={})).Connecting="connecting",Zr.Open="open",Zr.Closing="closing",Zr.Closed="closed";class ti{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"==typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const r=t.getUint8(1),i=t.getUint8(2);let n=this.HEADER_LENGTH+2;const a=s.decode(e.slice(n,n+r));n+=r;const o=s.decode(e.slice(n,n+i));n+=i;return{ref:null,topic:a,event:o,payload:JSON.parse(s.decode(e.slice(n,e.byteLength)))}}}class si{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}(ei=Qr||(Qr={})).abstime="abstime",ei.bool="bool",ei.date="date",ei.daterange="daterange",ei.float4="float4",ei.float8="float8",ei.int2="int2",ei.int4="int4",ei.int4range="int4range",ei.int8="int8",ei.int8range="int8range",ei.json="json",ei.jsonb="jsonb",ei.money="money",ei.numeric="numeric",ei.oid="oid",ei.reltime="reltime",ei.text="text",ei.time="time",ei.timestamp="timestamp",ei.timestamptz="timestamptz",ei.timetz="timetz",ei.tsrange="tsrange",ei.tstzrange="tstzrange";const ri=(e,t,s={})=>{var r;const i=null!==(r=s.skipTypes)&&void 0!==r?r:[];return Object.keys(t).reduce(((s,r)=>(s[r]=ii(r,e,t,i),s)),{})},ii=(e,t,s,r)=>{const i=t.find((t=>t.name===e)),n=null==i?void 0:i.type,a=s[e];return n&&!r.includes(n)?ni(n,a):ai(a)},ni=(e,t)=>{if("_"===e.charAt(0)){const s=e.slice(1,e.length);return di(t,s)}switch(e){case Qr.bool:return oi(t);case Qr.float4:case Qr.float8:case Qr.int2:case Qr.int4:case Qr.int8:case Qr.numeric:case Qr.oid:return li(t);case Qr.json:case Qr.jsonb:return ci(t);case Qr.timestamp:return hi(t);case Qr.abstime:case Qr.date:case Qr.daterange:case Qr.int4range:case Qr.int8range:case Qr.money:case Qr.reltime:case Qr.text:case Qr.time:case Qr.timestamptz:case Qr.timetz:case Qr.tsrange:case Qr.tstzrange:default:return ai(t)}},ai=e=>e,oi=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},li=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},ci=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e}return e},di=(e,t)=>{if("string"!=typeof e)return e;const s=e.length-1,r=e[s];if("{"===e[0]&&"}"===r){let r;const n=e.slice(1,s);try{r=JSON.parse("["+n+"]")}catch(i){r=n?n.split(","):[]}return r.map((e=>ni(t,e)))}return e},hi=e=>"string"==typeof e?e.replace(" ","T"):e,ui=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class mi{constructor(e,t,s={},r=1e4){this.channel=e,this.event=t,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t(null===(s=this.receivedResp)||void 0===s?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},(e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter((t=>t.status===e)).forEach((e=>e.callback(t)))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var gi,pi,fi,yi,xi,vi,bi,wi;(pi=gi||(gi={})).SYNC="sync",pi.JOIN="join",pi.LEAVE="leave";class ji{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},(e=>{const{onJoin:t,onLeave:s,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ji.syncState(this.state,e,t,s),this.pendingDiffs.forEach((e=>{this.state=ji.syncDiff(this.state,e,t,s)})),this.pendingDiffs=[],r()})),this.channel._on(s.diff,{},(e=>{const{onJoin:t,onLeave:s,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=ji.syncDiff(this.state,e,t,s),r())})),this.onJoin(((e,t,s)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:s})})),this.onLeave(((e,t,s)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:s})})),this.onSync((()=>{this.channel._trigger("presence",{event:"sync"})}))}static syncState(e,t,s,r){const i=this.cloneDeep(e),n=this.transformState(t),a={},o={};return this.map(i,((e,t)=>{n[e]||(o[e]=t)})),this.map(n,((e,t)=>{const s=i[e];if(s){const r=t.map((e=>e.presence_ref)),i=s.map((e=>e.presence_ref)),n=t.filter((e=>i.indexOf(e.presence_ref)<0)),l=s.filter((e=>r.indexOf(e.presence_ref)<0));n.length>0&&(a[e]=n),l.length>0&&(o[e]=l)}else a[e]=t})),this.syncDiff(i,{joins:a,leaves:o},s,r)}static syncDiff(e,t,s,r){const{joins:i,leaves:n}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(i,((t,r)=>{var i;const n=null!==(i=e[t])&&void 0!==i?i:[];if(e[t]=this.cloneDeep(r),n.length>0){const s=e[t].map((e=>e.presence_ref)),r=n.filter((e=>s.indexOf(e.presence_ref)<0));e[t].unshift(...r)}s(t,n,r)})),this.map(n,((t,s)=>{let i=e[t];if(!i)return;const n=s.map((e=>e.presence_ref));i=i.filter((e=>n.indexOf(e.presence_ref)<0)),e[t]=i,r(t,i,s),0===i.length&&delete e[t]})),e}static map(e,t){return Object.getOwnPropertyNames(e).map((s=>t(s,e[s])))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce(((t,s)=>{const r=e[s];return t[s]="metas"in r?r.metas.map((e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e))):r,t}),{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(yi=fi||(fi={})).ALL="*",yi.INSERT="INSERT",yi.UPDATE="UPDATE",yi.DELETE="DELETE",(vi=xi||(xi={})).BROADCAST="broadcast",vi.PRESENCE="presence",vi.POSTGRES_CHANGES="postgres_changes",vi.SYSTEM="system",(wi=bi||(bi={})).SUBSCRIBED="SUBSCRIBED",wi.TIMED_OUT="TIMED_OUT",wi.CLOSED="CLOSED",wi.CHANNEL_ERROR="CHANNEL_ERROR";class ki{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=Jr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new mi(this,Gr.join,this.params,this.timeout),this.rejoinTimer=new si((()=>this._rejoinUntilConnected()),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(()=>{this.state=Jr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach((e=>e.send())),this.pushBuffer=[]})),this._onClose((()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Jr.closed,this.socket._remove(this)})),this._onError((e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=Jr.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Jr.errored,this.rejoinTimer.scheduleTimeout())})),this._on(Gr.reply,{},((e,t)=>{this._trigger(this._replyEventName(t),e)})),this.presence=new ji(this),this.broadcastEndpointURL=ui(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:n,private:a}}=this.params;this._onError((t=>null==e?void 0:e(bi.CHANNEL_ERROR,t))),this._onClose((()=>null==e?void 0:e(bi.CLOSED)));const o={},l={broadcast:i,presence:n,postgres_changes:null!==(r=null===(s=this.bindings.postgres_changes)||void 0===s?void 0:s.map((e=>e.filter)))&&void 0!==r?r:[],private:a};this.socket.accessTokenValue&&(o.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},o)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",(async({postgres_changes:t})=>{var s;if(this.socket.setAuth(),void 0!==t){const r=this.bindings.postgres_changes,i=null!==(s=null==r?void 0:r.length)&&void 0!==s?s:0,n=[];for(let s=0;s<i;s++){const i=r[s],{filter:{event:a,schema:o,table:l,filter:c}}=i,d=t&&t[s];if(!d||d.event!==a||d.schema!==o||d.table!==l||d.filter!==c)return this.unsubscribe(),void(null==e||e(bi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));n.push(Object.assign(Object.assign({},i),{id:d.id}))}return this.bindings.postgres_changes=n,void(e&&e(bi.SUBSCRIBED))}null==e||e(bi.SUBSCRIBED)})).receive("error",(t=>{null==e||e(bi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))})).receive("timeout",(()=>{null==e||e(bi.TIMED_OUT)}))}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,r;if(this._canPush()||"broadcast"!==e.type)return new Promise((s=>{var r,i,n;const a=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(n=null===(i=null===(r=this.params)||void 0===r?void 0:r.config)||void 0===i?void 0:i.broadcast)||void 0===n?void 0:n.ack)||s("ok"),a.receive("ok",(()=>s("ok"))),a.receive("error",(()=>s("error"))),a.receive("timeout",(()=>s("timed out")))}));{const{event:n,payload:a}=e,o={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:a,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!==(s=t.timeout)&&void 0!==s?s:this.timeout);return await(null===(r=e.body)||void 0===r?void 0:r.cancel()),e.ok?"ok":"error"}catch(i){return"AbortError"===i.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Jr.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Gr.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise((s=>{const r=new mi(this,Gr.leave,{},e);r.receive("ok",(()=>{t(),s("ok")})).receive("timeout",(()=>{t(),s("timed out")})).receive("error",(()=>{s("error")})),r.send(),this._canPush()||r.trigger("ok",{})}))}async _fetchWithTimeout(e,t,s){const r=new AbortController,i=setTimeout((()=>r.abort()),s),n=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(i),n}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new mi(this,e,t,s);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var r,i;const n=e.toLocaleLowerCase(),{close:a,error:o,leave:l,join:c}=Gr;if(s&&[a,o,l,c].indexOf(n)>=0&&s!==this._joinRef())return;let d=this._onMessage(n,t,s);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(n)?null===(r=this.bindings.postgres_changes)||void 0===r||r.filter((e=>{var t,s,r;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(r=null===(s=e.filter)||void 0===s?void 0:s.event)||void 0===r?void 0:r.toLocaleLowerCase())===n})).map((e=>e.callback(d,s))):null===(i=this.bindings[n])||void 0===i||i.filter((e=>{var s,r,i,a,o,l;if(["broadcast","presence","postgres_changes"].includes(n)){if("id"in e){const n=e.id,a=null===(s=e.filter)||void 0===s?void 0:s.event;return n&&(null===(r=t.ids)||void 0===r?void 0:r.includes(n))&&("*"===a||(null==a?void 0:a.toLocaleLowerCase())===(null===(i=t.data)||void 0===i?void 0:i.type.toLocaleLowerCase()))}{const s=null===(o=null===(a=null==e?void 0:e.filter)||void 0===a?void 0:a.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===s||s===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===n})).map((e=>{if("object"==typeof d&&"ids"in d){const e=d.data,{schema:t,table:s,commit_timestamp:r,type:i,errors:n}=e,a={schema:t,table:s,commit_timestamp:r,eventType:i,new:{},old:{},errors:n};d=Object.assign(Object.assign({},a),this._getPayloadRecords(e))}e.callback(d,s)}))}_isClosed(){return this.state===Jr.closed}_isJoined(){return this.state===Jr.joined}_isJoining(){return this.state===Jr.joining}_isLeaving(){return this.state===Jr.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const r=e.toLocaleLowerCase(),i={type:r,filter:t,callback:s};return this.bindings[r]?this.bindings[r].push(i):this.bindings[r]=[i],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter((e=>{var r;return!((null===(r=e.type)||void 0===r?void 0:r.toLocaleLowerCase())===s&&ki.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Gr.close,{},e)}_onError(e){this._on(Gr.error,{},(t=>e(t)))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Jr.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=ri(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=ri(e.columns,e.old_record)),t}}const _i=()=>{},Si="undefined"!=typeof WebSocket;class Ni{constructor(e,t){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=Fr,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=_i,this.conn=null,this.sendBuffer=[],this.serializer=new ti,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>I((async()=>{const{default:e}=await Promise.resolve().then((()=>or));return{default:e}}),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},this.endPoint=`${e}/${Yr.websocket}`,this.httpEndpoint=ui(e),(null==t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null==t?void 0:t.params)&&(this.params=t.params),(null==t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null==t?void 0:t.timeout)&&(this.timeout=t.timeout),(null==t?void 0:t.logger)&&(this.logger=t.logger),(null==t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const r=null===(s=null==t?void 0:t.params)||void 0===s?void 0:s.apikey;if(r&&(this.accessTokenValue=r,this.apiKey=r),this.reconnectAfterMs=(null==t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null==t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null==t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new si((async()=>{this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(null==t?void 0:t.fetch),null==t?void 0:t.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null==t?void 0:t.worker)||!1,this.workerUrl=null==t?void 0:t.workerUrl}this.accessToken=(null==t?void 0:t.accessToken)||null}connect(){if(!this.conn)if(this.transport)this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});else{if(Si)return this.conn=new WebSocket(this.endpointURL()),void this.setupConnection();this.conn=new Ci(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),I((async()=>{const{default:e}=await import("./browser-B8H7QXCo.js").then((e=>e.b));return{default:e}}),__vite__mapDeps([0,1])).then((({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()}))}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map((e=>e.unsubscribe())));return this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case qr.connecting:return Xr.Connecting;case qr.open:return Xr.Open;case qr.closing:return Xr.Closing;default:return Xr.Closed}}isConnected(){return this.connectionState()===Xr.Open}channel(e,t={config:{}}){const s=new ki(`realtime:${e}`,t,this);return this.channels.push(s),s}push(e){const{topic:t,event:s,payload:r,ref:i}=e,n=()=>{this.encode(e,(e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)}))};this.log("push",`${t} ${s} (${i})`,r),this.isConnected()?n():this.sendBuffer.push(n)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let e=null;try{e=JSON.parse(atob(t.split(".")[1]))}catch(s){}if(e&&e.exp){if(!(Math.floor(Date.now()/1e3)-e.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${e.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${e.exp}`)}this.accessTokenValue=t,this.channels.forEach((e=>{t&&e.updateJoinPayload({access_token:t}),e.joinedOnce&&e._isJoined()&&e._push(Gr.access_token,{access_token:t})}))}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((e=>e())),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find((t=>t.topic===e&&(t._isJoined()||t._isJoining())));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter((t=>t._joinRef()!==e._joinRef()))}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,(e=>{let{topic:t,event:s,payload:r,ref:i}=e;i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${r.status||""} ${t} ${s} ${i&&"("+i+")"||""}`,r),this.channels.filter((e=>e._isMember(t))).forEach((e=>e._trigger(s,r,i))),this.stateChangeCallbacks.message.forEach((t=>t(e)))}))}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this.sendHeartbeat()),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach((e=>e()))}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((t=>t(e)))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((t=>t(e)))}_triggerChanError(){this.channels.forEach((e=>e._trigger(Gr.error)))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const s=e.match(/\?/)?"&":"?";return`${e}${s}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class Ci{constructor(e,t,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=qr.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class Ei extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Ti(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class Ii extends Ei{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Ai extends Ei{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Pi=function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function a(e){try{l(r.next(e))}catch(t){n(t)}}function o(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};const Oi=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>I((async()=>{const{default:e}=await Promise.resolve().then((()=>or));return{default:e}}),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},Ri=e=>{if(Array.isArray(e))return e.map((e=>Ri(e)));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach((([e,s])=>{const r=e.replace(/([-_][a-z])/gi,(e=>e.toUpperCase().replace(/[-_]/g,"")));t[r]=Ri(s)})),t};var Di=function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function a(e){try{l(r.next(e))}catch(t){n(t)}}function o(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};const $i=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Li=(e,t,s)=>Di(void 0,void 0,void 0,(function*(){const r=yield Pi(void 0,void 0,void 0,(function*(){return"undefined"==typeof Response?(yield I((()=>Promise.resolve().then((()=>or))),void 0)).Response:Response}));e instanceof r&&!(null==s?void 0:s.noResolveJson)?e.json().then((s=>{t(new Ii($i(s),e.status||500))})).catch((e=>{t(new Ai($i(e),e))})):t(new Ai($i(e),e))}));function Mi(e,t,s,r,i,n){return Di(this,void 0,void 0,(function*(){return new Promise(((a,o)=>{e(s,((e,t,s,r)=>{const i={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),r&&(i.body=JSON.stringify(r)),Object.assign(Object.assign({},i),s))})(t,r,i,n)).then((e=>{if(!e.ok)throw e;return(null==r?void 0:r.noResolveJson)?e:e.json()})).then((e=>a(e))).catch((e=>Li(e,o,r)))}))}))}function Bi(e,t,s,r){return Di(this,void 0,void 0,(function*(){return Mi(e,"GET",t,s,r)}))}function zi(e,t,s,r,i){return Di(this,void 0,void 0,(function*(){return Mi(e,"POST",t,r,i,s)}))}function Ui(e,t,s,r,i){return Di(this,void 0,void 0,(function*(){return Mi(e,"DELETE",t,r,i,s)}))}var Hi=function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function a(e){try{l(r.next(e))}catch(t){n(t)}}function o(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};const Fi={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},qi={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Wi{constructor(e,t={},s,r){this.url=e,this.headers=t,this.bucketId=s,this.fetch=Oi(r)}uploadOrUpdate(e,t,s,r){return Hi(this,void 0,void 0,(function*(){try{let i;const n=Object.assign(Object.assign({},qi),r);let a=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(n.upsert)});const o=n.metadata;"undefined"!=typeof Blob&&s instanceof Blob?(i=new FormData,i.append("cacheControl",n.cacheControl),o&&i.append("metadata",this.encodeMetadata(o)),i.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(i=s,i.append("cacheControl",n.cacheControl),o&&i.append("metadata",this.encodeMetadata(o))):(i=s,a["cache-control"]=`max-age=${n.cacheControl}`,a["content-type"]=n.contentType,o&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null==r?void 0:r.headers)&&(a=Object.assign(Object.assign({},a),r.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:i,headers:a},(null==n?void 0:n.duplex)?{duplex:n.duplex}:{})),h=yield d.json();if(d.ok)return{data:{path:l,id:h.Id,fullPath:h.Key},error:null};return{data:null,error:h}}catch(i){if(Ti(i))return{data:null,error:i};throw i}}))}upload(e,t,s){return Hi(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",e,t,s)}))}uploadToSignedUrl(e,t,s,r){return Hi(this,void 0,void 0,(function*(){const i=this._removeEmptyFolders(e),n=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${n}`);a.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:qi.upsert},r),n=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&s instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(e=s,e.append("cacheControl",t.cacheControl)):(e=s,n["cache-control"]=`max-age=${t.cacheControl}`,n["content-type"]=t.contentType);const o=yield this.fetch(a.toString(),{method:"PUT",body:e,headers:n}),l=yield o.json();if(o.ok)return{data:{path:i,fullPath:l.Key},error:null};return{data:null,error:l}}catch(o){if(Ti(o))return{data:null,error:o};throw o}}))}createSignedUploadUrl(e,t){return Hi(this,void 0,void 0,(function*(){try{let s=this._getFinalPath(e);const r=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(r["x-upsert"]="true");const i=yield zi(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:r}),n=new URL(this.url+i.url),a=n.searchParams.get("token");if(!a)throw new Ei("No token returned by API");return{data:{signedUrl:n.toString(),path:e,token:a},error:null}}catch(s){if(Ti(s))return{data:null,error:s};throw s}}))}update(e,t,s){return Hi(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",e,t,s)}))}move(e,t,s){return Hi(this,void 0,void 0,(function*(){try{return{data:yield zi(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(Ti(r))return{data:null,error:r};throw r}}))}copy(e,t,s){return Hi(this,void 0,void 0,(function*(){try{return{data:{path:(yield zi(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(Ti(r))return{data:null,error:r};throw r}}))}createSignedUrl(e,t,s){return Hi(this,void 0,void 0,(function*(){try{let r=this._getFinalPath(e),i=yield zi(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},(null==s?void 0:s.transform)?{transform:s.transform}:{}),{headers:this.headers});const n=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${n}`)},{data:i,error:null}}catch(r){if(Ti(r))return{data:null,error:r};throw r}}))}createSignedUrls(e,t,s){return Hi(this,void 0,void 0,(function*(){try{const r=yield zi(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return{data:r.map((e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${i}`):null}))),error:null}}catch(r){if(Ti(r))return{data:null,error:r};throw r}}))}download(e,t){return Hi(this,void 0,void 0,(function*(){const s=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",r=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),i=r?`?${r}`:"";try{const t=this._getFinalPath(e),r=yield Bi(this.fetch,`${this.url}/${s}/${t}${i}`,{headers:this.headers,noResolveJson:!0});return{data:yield r.blob(),error:null}}catch(n){if(Ti(n))return{data:null,error:n};throw n}}))}info(e){return Hi(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{const e=yield Bi(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Ri(e),error:null}}catch(s){if(Ti(s))return{data:null,error:s};throw s}}))}exists(e){return Hi(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{return yield function(e,t,s,r){return Di(this,void 0,void 0,(function*(){return Mi(e,"HEAD",t,Object.assign(Object.assign({},s),{noResolveJson:!0}),r)}))}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(Ti(s)&&s instanceof Ai){const e=s.originalError;if([400,404].includes(null==e?void 0:e.status))return{data:!1,error:s}}throw s}}))}getPublicUrl(e,t){const s=this._getFinalPath(e),r=[],i=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==i&&r.push(i);const n=void 0!==(null==t?void 0:t.transform)?"render/image":"object",a=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==a&&r.push(a);let o=r.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${n}/public/${s}${o}`)}}}remove(e){return Hi(this,void 0,void 0,(function*(){try{return{data:yield Ui(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Ti(t))return{data:null,error:t};throw t}}))}list(e,t,s){return Hi(this,void 0,void 0,(function*(){try{const r=Object.assign(Object.assign(Object.assign({},Fi),t),{prefix:e||""});return{data:yield zi(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(r){if(Ti(r))return{data:null,error:r};throw r}}))}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Ji={"X-Client-Info":"storage-js/2.7.1"};var Ki=function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function a(e){try{l(r.next(e))}catch(t){n(t)}}function o(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};class Gi{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},Ji),t),this.fetch=Oi(s)}listBuckets(){return Ki(this,void 0,void 0,(function*(){try{return{data:yield Bi(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Ti(e))return{data:null,error:e};throw e}}))}getBucket(e){return Ki(this,void 0,void 0,(function*(){try{return{data:yield Bi(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Ti(t))return{data:null,error:t};throw t}}))}createBucket(e,t={public:!1}){return Ki(this,void 0,void 0,(function*(){try{return{data:yield zi(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Ti(s))return{data:null,error:s};throw s}}))}updateBucket(e,t){return Ki(this,void 0,void 0,(function*(){try{const s=yield function(e,t,s,r,i){return Di(this,void 0,void 0,(function*(){return Mi(e,"PUT",t,r,i,s)}))}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:s,error:null}}catch(s){if(Ti(s))return{data:null,error:s};throw s}}))}emptyBucket(e){return Ki(this,void 0,void 0,(function*(){try{return{data:yield zi(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Ti(t))return{data:null,error:t};throw t}}))}deleteBucket(e){return Ki(this,void 0,void 0,(function*(){try{return{data:yield Ui(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Ti(t))return{data:null,error:t};throw t}}))}}class Vi extends Gi{constructor(e,t={},s){super(e,t,s)}from(e){return new Wi(this.url,this.headers,e,this.fetch)}}let Yi="";Yi="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const Xi={headers:{"X-Client-Info":`supabase-js-${Yi}/2.49.8`}},Zi={schema:"public"},Qi={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},en={};var tn=function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function a(e){try{l(r.next(e))}catch(t){n(t)}}function o(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};const sn=(e,t,s)=>{const r=(e=>{let t;return t=e||("undefined"==typeof fetch?rr:fetch),(...e)=>t(...e)})(s),i="undefined"==typeof Headers?ir:Headers;return(s,n)=>tn(void 0,void 0,void 0,(function*(){var a;const o=null!==(a=yield t())&&void 0!==a?a:e;let l=new i(null==n?void 0:n.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),r(s,Object.assign(Object.assign({},n),{headers:l}))}))};var rn=function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function a(e){try{l(r.next(e))}catch(t){n(t)}}function o(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};const nn="2.69.1",an=3e4,on=9e4,ln={"X-Client-Info":`gotrue-js/${nn}`},cn="X-Supabase-Api-Version",dn={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},hn=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class un extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function mn(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class gn extends un{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}class pn extends un{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class fn extends un{constructor(e,t,s,r){super(e,s,r),this.name=t,this.status=s}}class yn extends fn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class xn extends fn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class vn extends fn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class bn extends fn{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class wn extends fn{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class jn extends fn{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function kn(e){return mn(e)&&"AuthRetryableFetchError"===e.name}class _n extends fn{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class Sn extends fn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Nn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Cn=" \t\n\r=".split(""),En=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Cn.length;t+=1)e[Cn[t].charCodeAt(0)]=-2;for(let t=0;t<Nn.length;t+=1)e[Nn[t].charCodeAt(0)]=t;return e})();function Tn(e,t,s){const r=En[e];if(!(r>-1)){if(-2===r)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)s(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function In(e){const t=[],s=e=>{t.push(String.fromCodePoint(e))},r={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},n=e=>{!function(e,t,s){if(0===t.utf8seq){if(e<=127)return void s(e);for(let s=1;s<6;s+=1)if(!(e>>7-s&1)){t.utf8seq=s;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&s(t.codepoint)}}(e,r,s)};for(let a=0;a<e.length;a+=1)Tn(e.charCodeAt(a),i,n);return t.join("")}function An(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}t(e)}function Pn(e){const t=[],s={queue:0,queuedBits:0},r=e=>{t.push(e)};for(let i=0;i<e.length;i+=1)Tn(e.charCodeAt(i),s,r);return new Uint8Array(t)}function On(e){const t=[];return function(e,t){for(let s=0;s<e.length;s+=1){let r=e.charCodeAt(s);if(r>55295&&r<=56319){const t=1024*(r-55296)&65535;r=65536+(e.charCodeAt(s+1)-56320&65535|t),s+=1}An(r,t)}}(e,(e=>t.push(e))),new Uint8Array(t)}const Rn=()=>"undefined"!=typeof window&&"undefined"!=typeof document,Dn={tested:!1,writable:!1},$n=()=>{if(!Rn())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(t){return!1}if(Dn.tested)return Dn.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Dn.tested=!0,Dn.writable=!0}catch(t){Dn.tested=!0,Dn.writable=!1}return Dn.writable};const Ln=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>I((async()=>{const{default:e}=await Promise.resolve().then((()=>or));return{default:e}}),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},Mn=async(e,t,s)=>{await e.setItem(t,JSON.stringify(s))},Bn=async(e,t)=>{const s=await e.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch(r){return s}},zn=async(e,t)=>{await e.removeItem(t)};class Un{constructor(){this.promise=new Un.promiseConstructor(((e,t)=>{this.resolve=e,this.reject=t}))}}function Hn(e){const t=e.split(".");if(3!==t.length)throw new Sn("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!hn.test(t[s]))throw new Sn("JWT not in base64url format");return{header:JSON.parse(In(t[0])),payload:JSON.parse(In(t[1])),signature:Pn(t[2]),raw:{header:t[0],payload:t[1]}}}function Fn(e){return("0"+e.toString(16)).substr(-2)}async function qn(e){if(!("undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder))return e;const t=await async function(e){const t=(new TextEncoder).encode(e),s=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(s);return Array.from(r).map((e=>String.fromCharCode(e))).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Wn(e,t,s=!1){const r=function(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let s="";for(let r=0;r<56;r++)s+=e.charAt(Math.floor(Math.random()*t));return s}return crypto.getRandomValues(e),Array.from(e,Fn).join("")}();let i=r;s&&(i+="/PASSWORD_RECOVERY"),await Mn(e,`${t}-code-verifier`,i);const n=await qn(r);return[n,r===n?"plain":"s256"]}Un.promiseConstructor=Promise;const Jn=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const Kn=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Gn=[502,503,504];async function Vn(e){var t,s;if(!("object"==typeof(s=e)&&null!==s&&"status"in s&&"ok"in s&&"json"in s&&"function"==typeof s.json))throw new jn(Kn(e),0);if(Gn.includes(e.status))throw new jn(Kn(e),e.status);let r,i;try{r=await e.json()}catch(a){throw new pn(Kn(a),a)}const n=function(e){const t=e.headers.get(cn);if(!t)return null;if(!t.match(Jn))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(a){return null}}(e);if(n&&n.getTime()>=dn.timestamp&&"object"==typeof r&&r&&"string"==typeof r.code?i=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(i=r.error_code),i){if("weak_password"===i)throw new _n(Kn(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===i)throw new yn}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce(((e,t)=>e&&"string"==typeof t),!0))throw new _n(Kn(r),e.status,r.weak_password.reasons);throw new gn(Kn(r),e.status||500,i)}async function Yn(e,t,s,r){var i;const n=Object.assign({},null==r?void 0:r.headers);n[cn]||(n[cn]=dn.name),(null==r?void 0:r.jwt)&&(n.Authorization=`Bearer ${r.jwt}`);const a=null!==(i=null==r?void 0:r.query)&&void 0!==i?i:{};(null==r?void 0:r.redirectTo)&&(a.redirect_to=r.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await async function(e,t,s,r,i,n){const a=((e,t,s,r)=>{const i={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),s))})(t,r,i,n);let o;try{o=await e(s,Object.assign({},a))}catch(l){throw new jn(Kn(l),0)}o.ok||await Vn(o);if(null==r?void 0:r.noResolveJson)return o;try{return await o.json()}catch(l){await Vn(l)}}(e,t,s+o,{headers:n,noResolveJson:null==r?void 0:r.noResolveJson},{},null==r?void 0:r.body);return(null==r?void 0:r.xform)?null==r?void 0:r.xform(l):{data:Object.assign({},l),error:null}}function Xn(e){var t;let s=null;var r;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(s=Object.assign({},e),e.expires_at||(s.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)));return{data:{session:s,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function Zn(e){const t=Xn(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce(((e,t)=>e&&"string"==typeof t),!0)&&(t.data.weak_password=e.weak_password),t}function Qn(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function ea(e){return{data:e,error:null}}function ta(e){const{action_link:t,email_otp:s,hashed_token:r,redirect_to:i,verification_type:n}=e,a=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(s[r[i]]=e[r[i]])}return s}(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:s,hashed_token:r,redirect_to:i,verification_type:n},user:Object.assign({},a)},error:null}}function sa(e){return e}class ra{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=Ln(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await Yn(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(mn(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await Yn(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Qn})}catch(s){if(mn(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(s[r[i]]=e[r[i]])}return s}(e,["options"]),r=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(r.new_email=null==s?void 0:s.newEmail,delete r.newEmail),await Yn(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:ta,redirectTo:null==t?void 0:t.redirectTo})}catch(t){if(mn(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Yn(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Qn})}catch(t){if(mn(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,r,i,n,a,o;try{const l={nextPage:null,lastPage:0,total:0},c=await Yn(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(s=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==s?s:"",per_page:null!==(i=null===(r=null==e?void 0:e.perPage)||void 0===r?void 0:r.toString())&&void 0!==i?i:""},xform:sa});if(c.error)throw c.error;const d=await c.json(),h=null!==(n=c.headers.get("x-total-count"))&&void 0!==n?n:0,u=null!==(o=null===(a=c.headers.get("link"))||void 0===a?void 0:a.split(","))&&void 0!==o?o:[];return u.length>0&&(u.forEach((e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),s=JSON.parse(e.split(";")[1].split("=")[1]);l[`${s}Page`]=t})),l.total=parseInt(h)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(mn(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){try{return await Yn(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Qn})}catch(t){if(mn(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await Yn(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Qn})}catch(s){if(mn(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){try{return await Yn(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Qn})}catch(s){if(mn(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){try{const{data:t,error:s}=await Yn(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:s}}catch(t){if(mn(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await Yn(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(mn(t))return{data:null,error:t};throw t}}}const ia={getItem:e=>$n()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{$n()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{$n()&&globalThis.localStorage.removeItem(e)}};function na(e={}){return{getItem:t=>e[t]||null,setItem:(t,s)=>{e[t]=s},removeItem:t=>{delete e[t]}}}const aa=!!(globalThis&&$n()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class oa extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class la extends oa{}async function ca(e,t,s){const r=new globalThis.AbortController;return t>0&&setTimeout((()=>{r.abort()}),t),await Promise.resolve().then((()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},(async r=>{if(!r){if(0===t)throw new la(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(aa)try{await globalThis.navigator.locks.query()}catch(i){}return await s()}try{return await s()}finally{}}))))}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();const da={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ln,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function ha(e,t,s){return await s()}class ua{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ua.nextInstanceID,ua.nextInstanceID+=1,this.instanceID>0&&Rn();const r=Object.assign(Object.assign({},da),e);if(this.logDebugMessages=!!r.debug,"function"==typeof r.debug&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new ra({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=Ln(r.fetch),this.lock=r.lock||ha,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Rn()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=ca:this.lock=ha,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:$n()?this.storage=ia:(this.memoryStorage={},this.storage=na(this.memoryStorage)):(this.memoryStorage={},this.storage=na(this.memoryStorage)),Rn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){}null===(s=this.broadcastChannel)||void 0===s||s.addEventListener("message",(async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}))}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${nn}) ${(new Date).toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,(async()=>await this._initialize())))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},s=new URL(e);if(s.hash&&"#"===s.hash[0])try{new URLSearchParams(s.hash.substring(1)).forEach(((e,s)=>{t[s]=e}))}catch(r){}return s.searchParams.forEach(((e,s)=>{t[s]=e})),t}(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),Rn()&&this.detectSessionInUrl&&"none"!==s){const{data:r,error:i}=await this._getSessionFromURL(t,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),function(e){return mn(e)&&"AuthImplicitGrantRedirectError"===e.name}(i)){const t=null===(e=i.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:i}}return await this._removeSession(),{error:i}}const{session:n,redirectType:a}=r;return this._debug("#_initialize()","detected session in URL",n,"redirect type",a),await this._saveSession(n),setTimeout((async()=>{"recovery"===a?await this._notifyAllSubscribers("PASSWORD_RECOVERY",n):await this._notifyAllSubscribers("SIGNED_IN",n)}),0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return mn(t)?{error:t}:{error:new pn("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,r;try{const i=await Yn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(s=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==s?s:{},gotrue_meta_security:{captcha_token:null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken}},xform:Xn}),{data:n,error:a}=i;if(a||!n)return{data:{user:null,session:null},error:a};const o=n.session,l=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(i){if(mn(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,s,r;try{let i;if("email"in e){const{email:s,password:r,options:n}=e;let a=null,o=null;"pkce"===this.flowType&&([a,o]=await Wn(this.storage,this.storageKey)),i=await Yn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==n?void 0:n.emailRedirectTo,body:{email:s,password:r,data:null!==(t=null==n?void 0:n.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:a,code_challenge_method:o},xform:Xn})}else{if(!("phone"in e))throw new vn("You must provide either an email or phone number and a password");{const{phone:t,password:n,options:a}=e;i=await Yn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:n,data:null!==(s=null==a?void 0:a.data)&&void 0!==s?s:{},channel:null!==(r=null==a?void 0:a.channel)&&void 0!==r?r:"sms",gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:Xn})}}const{data:n,error:a}=i;if(a||!n)return{data:{user:null,session:null},error:a};const o=n.session,l=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(i){if(mn(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:s,password:r,options:i}=e;t=await Yn(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:Zn})}else{if(!("phone"in e))throw new vn("You must provide either an email or phone number and a password");{const{phone:s,password:r,options:i}=e;t=await Yn(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:Zn})}}const{data:s,error:r}=t;return r?{data:{user:null,session:null},error:r}:s&&s.session&&s.user?(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r}):{data:{user:null,session:null},error:new xn}}catch(t){if(mn(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,r,i;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(s=e.options)||void 0===s?void 0:s.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:null===(i=e.options)||void 0===i?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,(async()=>this._exchangeCodeForSession(e)))}async _exchangeCodeForSession(e){const t=await Bn(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(null!=t?t:"").split("/");try{const{data:t,error:i}=await Yn(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Xn});if(await zn(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=r?r:null}),error:i}):{data:{user:null,session:null,redirectType:null},error:new xn}}catch(i){if(mn(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:s,token:r,access_token:i,nonce:n}=e,a=await Yn(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:i,nonce:n,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:Xn}),{data:o,error:l}=a;return l?{data:{user:null,session:null},error:l}:o&&o.session&&o.user?(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:o,error:l}):{data:{user:null,session:null},error:new xn}}catch(t){if(mn(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,r,i,n;try{if("email"in e){const{email:r,options:i}=e;let n=null,a=null;"pkce"===this.flowType&&([n,a]=await Wn(this.storage,this.storageKey));const{error:o}=await Yn(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:r,data:null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},create_user:null===(s=null==i?void 0:i.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:n,code_challenge_method:a},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){const{phone:t,options:s}=e,{data:a,error:o}=await Yn(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(r=null==s?void 0:s.data)&&void 0!==r?r:{},create_user:null===(i=null==s?void 0:s.shouldCreateUser)||void 0===i||i,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},channel:null!==(n=null==s?void 0:s.channel)&&void 0!==n?n:"sms"}});return{data:{user:null,session:null,messageId:null==a?void 0:a.message_id},error:o}}throw new vn("You must provide either an email or phone number.")}catch(a){if(mn(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,s;try{let r,i;"options"in e&&(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo,i=null===(s=e.options)||void 0===s?void 0:s.captchaToken);const{data:n,error:a}=await Yn(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:r,xform:Xn});if(a)throw a;if(!n)throw new Error("An error occurred on token verification.");const o=n.session,l=n.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(r){if(mn(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,s,r;try{let i=null,n=null;return"pkce"===this.flowType&&([i,n]=await Wn(this.storage,this.storageKey)),await Yn(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(s=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==s?s:void 0}),(null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:n}),headers:this.headers,xform:ea})}catch(i){if(mn(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._reauthenticate()))}async _reauthenticate(){try{return await this._useSession((async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new yn;const{error:r}=await Yn(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}}))}catch(e){if(mn(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:i}=e,{error:n}=await Yn(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},redirectTo:null==i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:n}}if("phone"in e){const{phone:s,type:r,options:i}=e,{data:n,error:a}=await Yn(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:null==n?void 0:n.message_id},error:a}}throw new vn("You must provide either an email or phone number and a type")}catch(t){if(mn(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,(async()=>this._useSession((async e=>e))))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch(e){}})()),s}return await this.lock(`lock:${this.storageKey}`,e,(async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await Bn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=!!e.expires_at&&1e3*e.expires_at-Date.now()<on;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,s,r)=>(t||"user"!==s||(t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,s,r))})}return{data:{session:e},error:null}}const{session:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,(async()=>await this._getUser()))}async _getUser(e){try{return e?await Yn(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Qn}):await this._useSession((async e=>{var t,s,r;const{data:i,error:n}=e;if(n)throw n;return(null===(t=i.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await Yn(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(r=null===(s=i.session)||void 0===s?void 0:s.access_token)&&void 0!==r?r:void 0,xform:Qn}):{data:{user:null},error:new yn}}))}catch(t){if(mn(t))return function(e){return mn(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await zn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._updateUser(e,t)))}async _updateUser(e,t={}){try{return await this._useSession((async s=>{const{data:r,error:i}=s;if(i)throw i;if(!r.session)throw new yn;const n=r.session;let a=null,o=null;"pkce"===this.flowType&&null!=e.email&&([a,o]=await Wn(this.storage,this.storageKey));const{data:l,error:c}=await Yn(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:o}),jwt:n.access_token,xform:Qn});if(c)throw c;return n.user=l.user,await this._saveSession(n),await this._notifyAllSubscribers("USER_UPDATED",n),{data:{user:n.user},error:null}}))}catch(s){if(mn(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._setSession(e)))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new yn;const t=Date.now()/1e3;let s=t,r=!0,i=null;const{payload:n}=Hn(e.access_token);if(n.exp&&(s=n.exp,r=s<=t),r){const{session:t,error:s}=await this._callRefreshToken(e.refresh_token);if(s)return{data:{user:null,session:null},error:s};if(!t)return{data:{user:null,session:null},error:null};i=t}else{const{data:r,error:n}=await this._getUser(e.access_token);if(n)throw n;i={access_token:e.access_token,refresh_token:e.refresh_token,user:r.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(mn(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._refreshSession(e)))}async _refreshSession(e){try{return await this._useSession((async t=>{var s;if(!e){const{data:r,error:i}=t;if(i)throw i;e=null!==(s=r.session)&&void 0!==s?s:void 0}if(!(null==e?void 0:e.refresh_token))throw new yn;const{session:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}}))}catch(t){if(mn(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Rn())throw new bn("No browser detected.");if(e.error||e.error_description||e.error_code)throw new bn(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new wn("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new bn("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new wn("No code detected.");const{data:t,error:s}=await this._exchangeCodeForSession(e.code);if(s)throw s;const r=new URL(window.location.href);return r.searchParams.delete("code"),window.history.replaceState(window.history.state,"",r.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:i,refresh_token:n,expires_in:a,expires_at:o,token_type:l}=e;if(!(i&&a&&n&&l))throw new bn("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(a);let h=c+d;o&&(h=parseInt(o));const{data:u,error:m}=await this._getUser(i);if(m)throw m;const g={provider_token:s,provider_refresh_token:r,access_token:i,expires_in:d,expires_at:h,refresh_token:n,token_type:l,user:u.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(s){if(mn(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Bn(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._signOut(e)))}async _signOut({scope:e}={scope:"global"}){return await this._useSession((async t=>{var s;const{data:r,error:i}=t;if(i)return{error:i};const n=null===(s=r.session)||void 0===s?void 0:s.access_token;if(n){const{error:t}=await this.admin.signOut(n,e);if(t&&(!function(e){return mn(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await zn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>{await this.initializePromise,await this._acquireLock(-1,(async()=>{this._emitInitialSession(t)}))})(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession((async t=>{var s,r;try{const{data:{session:r},error:i}=t;if(i)throw i;await(null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(i){await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i)}}))}async resetPasswordForEmail(e,t={}){let s=null,r=null;"pkce"===this.flowType&&([s,r]=await Wn(this.storage,this.storageKey,!0));try{return await Yn(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(mn(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(mn(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:r}=await this._useSession((async t=>{var s,r,i,n,a;const{data:o,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(s=e.options)||void 0===s?void 0:s.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(i=e.options)||void 0===i?void 0:i.queryParams,skipBrowserRedirect:!0});return await Yn(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(a=null===(n=o.session)||void 0===n?void 0:n.access_token)&&void 0!==a?a:void 0})}));if(r)throw r;return Rn()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null==s?void 0:s.url),{data:{provider:e.provider,url:null==s?void 0:s.url},error:null}}catch(s){if(mn(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession((async t=>{var s,r;const{data:i,error:n}=t;if(n)throw n;return await Yn(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(r=null===(s=i.session)||void 0===s?void 0:s.access_token)&&void 0!==r?r:void 0})}))}catch(t){if(mn(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const i=Date.now();return await(s=async s=>(s>0&&await async function(e){return await new Promise((t=>{setTimeout((()=>t(null)),e)}))}(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await Yn(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Xn})),r=(e,t)=>{const s=200*Math.pow(2,e);return t&&kn(t)&&Date.now()+s-i<an},new Promise(((e,t)=>{(async()=>{for(let n=0;n<1/0;n++)try{const t=await s(n);if(!r(n,null,t))return void e(t)}catch(i){if(!r(n,i))return void t(i)}})()})))}catch(i){if(this._debug(t,"error",i),mn(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(t,"end")}var s,r}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),Rn()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await Bn(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s))return this._debug(t,"session is not valid"),void(null!==s&&await this._removeSession());const r=1e3*(null!==(e=s.expires_at)&&void 0!==e?e:1/0)-Date.now()<on;if(this._debug(t,`session has${r?"":" not"} expired with margin of 90000s`),r){if(this.autoRefreshToken&&s.refresh_token){const{error:e}=await this._callRefreshToken(s.refresh_token);e&&(kn(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){return void this._debug(t,"error",s)}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new yn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Un;const{data:t,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!t.session)throw new yn;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const r={session:t.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(i){if(this._debug(r,"error",i),mn(i)){const e={session:null,error:i};return kn(i)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(s=this.refreshingDeferred)||void 0===s||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],i=Array.from(this.stateChangeEmitters.values()).map((async s=>{try{await s.callback(e,t)}catch(i){r.push(i)}}));if(await Promise.all(i),r.length>0){for(let e=0;e<r.length;e+=1);throw r[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Mn(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await zn(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Rn()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval((()=>this._autoRefreshTokenTick()),an);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout((async()=>{await this.initializePromise,await this._autoRefreshTokenTick()}),0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,(async()=>{try{const t=Date.now();try{return await this._useSession((async e=>{const{data:{session:s}}=e;if(!s||!s.refresh_token||!s.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const r=Math.floor((1e3*s.expires_at-t)/an);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),r<=3&&await this._callRefreshToken(s.refresh_token)}))}catch(e){}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(!(e.isAcquireTimeout||e instanceof oa))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Rn()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,(async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const r=[`provider=${encodeURIComponent(t)}`];if((null==s?void 0:s.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),(null==s?void 0:s.scopes)&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),"pkce"===this.flowType){const[e,t]=await Wn(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});r.push(s.toString())}if(null==s?void 0:s.queryParams){const e=new URLSearchParams(s.queryParams);r.push(e.toString())}return(null==s?void 0:s.skipBrowserRedirect)&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession((async t=>{var s;const{data:r,error:i}=t;return i?{data:null,error:i}:await Yn(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token})}))}catch(t){if(mn(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession((async t=>{var s,r;const{data:i,error:n}=t;if(n)return{data:null,error:n};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:o,error:l}=await Yn(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:null===(s=null==i?void 0:i.session)||void 0===s?void 0:s.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(r=null==o?void 0:o.totp)||void 0===r?void 0:r.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})}))}catch(t){if(mn(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var s;const{data:r,error:i}=t;if(i)return{data:null,error:i};const{data:n,error:a}=await Yn(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+n.expires_in},n)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",n),{data:n,error:a})}))}catch(t){if(mn(t))return{data:null,error:t};throw t}}))}async _challenge(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var s;const{data:r,error:i}=t;return i?{data:null,error:i}:await Yn(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token})}))}catch(t){if(mn(t))return{data:null,error:t};throw t}}))}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(null==e?void 0:e.factors)||[],r=s.filter((e=>"totp"===e.factor_type&&"verified"===e.status)),i=s.filter((e=>"phone"===e.factor_type&&"verified"===e.status));return{data:{all:s,totp:r,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,(async()=>await this._useSession((async e=>{var t,s;const{data:{session:r},error:i}=e;if(i)return{data:null,error:i};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:n}=Hn(r.access_token);let a=null;n.aal&&(a=n.aal);let o=a;(null!==(s=null===(t=r.user.factors)||void 0===t?void 0:t.filter((e=>"verified"===e.status)))&&void 0!==s?s:[]).length>0&&(o="aal2");return{data:{currentLevel:a,nextLevel:o,currentAuthenticationMethods:n.amr||[]},error:null}}))))}async fetchJwk(e,t={keys:[]}){let s=t.keys.find((t=>t.kid===e));if(s)return s;if(s=this.jwks.keys.find((t=>t.kid===e)),s&&this.jwks_cached_at+6e5>Date.now())return s;const{data:r,error:i}=await Yn(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!r.keys||0===r.keys.length)throw new Sn("JWKS is empty");if(this.jwks=r,this.jwks_cached_at=Date.now(),s=r.keys.find((t=>t.kid===e)),!s)throw new Sn("No matching signing key found in JWKS");return s}async getClaims(e,t={keys:[]}){try{let s=e;if(!s){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};s=e.session.access_token}const{header:r,payload:i,signature:n,raw:{header:a,payload:o}}=Hn(s);if(function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(i.exp),!r.kid||"HS256"===r.alg||!("crypto"in globalThis)||!("subtle"in globalThis.crypto)){const{error:e}=await this.getUser(s);if(e)throw e;return{data:{claims:i,header:r,signature:n},error:null}}const l=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(r.alg),c=await this.fetchJwk(r.kid,t),d=await crypto.subtle.importKey("jwk",c,l,!0,["verify"]);if(!(await crypto.subtle.verify(l,d,n,On(`${a}.${o}`))))throw new Sn("Invalid JWT signature");return{data:{claims:i,header:r,signature:n},error:null}}catch(s){if(mn(s))return{data:null,error:s};throw s}}}ua.nextInstanceID=0;const ma=ua;class ga extends ma{constructor(e){super(e)}}var pa=function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function a(e){try{l(r.next(e))}catch(t){n(t)}}function o(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};class fa{constructor(e,t,s){var r,i,n;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const a=(o=e).endsWith("/")?o:o+"/";var o;const l=new URL(a);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d=function(e,t){var s,r;const{db:i,auth:n,realtime:a,global:o}=e,{db:l,auth:c,realtime:d,global:h}=t,u={db:Object.assign(Object.assign({},l),i),auth:Object.assign(Object.assign({},c),n),realtime:Object.assign(Object.assign({},d),a),global:Object.assign(Object.assign(Object.assign({},h),o),{headers:Object.assign(Object.assign({},null!==(s=null==h?void 0:h.headers)&&void 0!==s?s:{}),null!==(r=null==o?void 0:o.headers)&&void 0!==r?r:{})}),accessToken:()=>rn(this,void 0,void 0,(function*(){return""}))};return e.accessToken?u.accessToken=e.accessToken:delete u.accessToken,u}(null!=s?s:{},{db:Zi,realtime:en,auth:Object.assign(Object.assign({},Qi),{storageKey:c}),global:Xi});this.storageKey=null!==(r=d.auth.storageKey)&&void 0!==r?r:"",this.headers=null!==(i=d.global.headers)&&void 0!==i?i:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(n=d.auth)&&void 0!==n?n:{},this.headers,d.global.fetch),this.fetch=sn(t,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new Lr(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new Gs(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Vi(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return pa(this,void 0,void 0,(function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return null!==(t=null===(e=s.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null}))}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,storageKey:i,flowType:n,lock:a,debug:o},l,c){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ga({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),l),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,flowType:n,lock:a,debug:o,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Ni(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)}))}_handleTokenChanged(e,t,s){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===s?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=s}}const ya=new fa("https://rcpqtgtuuqkkrhzbmksu.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJjcHF0Z3R1dXFra3JoemJta3N1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg0NDczMjUsImV4cCI6MjA2NDAyMzMyNX0.TBiu0kMe-tiMsEUuE9rEVdd3__xyD7ICZaH-rzq0ZRs",xa);var xa;const va=e.createContext({session:null,user:null,signInWithGoogle:async()=>{},signOut:async()=>{},loading:!0,hasPaid:!1,chatSyncEnabled:!1,chatCount:0,refreshUserStatus:async()=>{}}),ba=()=>e.useContext(va),wa=({children:t})=>{const[s,r]=e.useState(null),[i,n]=e.useState(null),[a,o]=e.useState(!0),[l,c]=e.useState(!1),[d,h]=e.useState(!1),[u,m]=e.useState(0),g=async e=>{if(!e)return;const{id:t,email:s}=e;if(!t||!s)return;const{error:r}=await ya.from("users").upsert([{id:t,email:s}],{onConflict:"id"})},p=async e=>{const{data:t,error:s}=await ya.from("users").select("has_paid, chat_sync_enabled, chat_count").eq("id",e).single();if(s)return c(!1),h(!1),void m(0);c(!!t.has_paid),h(!!t.chat_sync_enabled),m(t.chat_count||0)};e.useEffect((()=>{ya.auth.getSession().then((({data:{session:e}})=>{n(e),r((null==e?void 0:e.user)??null),o(!1),(null==e?void 0:e.user)&&(g(e.user),p(e.user.id))}));const{data:{subscription:e}}=ya.auth.onAuthStateChange(((e,t)=>{n(t),r((null==t?void 0:t.user)??null),o(!1),(null==t?void 0:t.user)?(g(t.user),p(t.user.id)):(c(!1),h(!1))}));return()=>{e.unsubscribe()}}),[]);const f={session:i,user:s,signInWithGoogle:async()=>{try{const{error:e}=await ya.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin}});if(e)throw e}catch(e){}},signOut:async()=>{try{const{error:e}=await ya.auth.signOut();if(e)throw e}catch(e){}},loading:a,hasPaid:l,chatSyncEnabled:d,chatCount:u,refreshUserStatus:async()=>{(null==s?void 0:s.id)&&await p(s.id)}};return C.jsx(va.Provider,{value:f,children:t})};
/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var ja={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ka=(t,s)=>{const r=e.forwardRef((({color:r="currentColor",size:i=24,strokeWidth:n=2,absoluteStrokeWidth:a,className:o="",children:l,...c},d)=>{return e.createElement("svg",{ref:d,...ja,width:i,height:i,stroke:r,strokeWidth:a?24*Number(n)/Number(i):n,className:["lucide",`lucide-${h=t,h.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()}`,o].join(" "),...c},[...s.map((([t,s])=>e.createElement(t,s))),...Array.isArray(l)?l:[l]]);var h}));return r.displayName=`${t}`,r},_a=ka("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),Sa=ka("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Na=ka("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Ca=ka("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Ea=ka("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),Ta=ka("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),Ia=ka("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}]]),Aa=ka("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]),Pa=ka("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]),Oa=ka("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),Ra=ka("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Da=ka("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]),$a=ka("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),La=ka("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Ma=ka("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Ba=ka("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),za=ka("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),Ua=ka("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),Ha=ka("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Fa=ka("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]),qa=ka("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),Wa=ka("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Ja=ka("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Ka=ka("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),Ga=ka("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]),Va=ka("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),Ya=ka("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),Xa=ka("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),Za=ka("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Qa=ka("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),eo=ka("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),to=ka("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),so=ka("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),ro=ka("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),io=ka("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]),no=ka("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),ao=ka("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),oo=ka("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),lo=ka("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),co=ka("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),ho=ka("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),uo=ka("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),mo=({icon:e,label:t,isActive:s,onClick:r,vertical:i=!1})=>C.jsxs(a.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:r,className:`\n        relative w-full flex ${i?"flex-row items-center":"flex-col items-center justify-center"} \n        ${s?i?"text-indigo-600 bg-indigo-50 font-medium":"text-indigo-600 font-medium":"text-gray-500 hover:text-gray-700"}\n        ${i?"p-3 rounded-lg":"py-2"}\n        transition-colors duration-200 focus:outline-none\n      `,"aria-label":t,"aria-pressed":s,role:"tab",tabIndex:0,children:[C.jsx(e,{size:i?20:24,className:i?"mr-3":"mb-1","aria-hidden":"true"}),C.jsx("span",{className:i?"text-sm":"text-xs",children:t}),s&&!i&&C.jsx(a.div,{className:"absolute bottom-0 left-1/2 w-1.5 h-1.5 bg-indigo-600 rounded-full transform -translate-x-1/2 mb-0.5",layoutId:"bottom-indicator",transition:{type:"spring",stiffness:300,damping:30},"aria-hidden":"true"})]}),go=({type:e,onClose:t,className:s=""})=>"mini"===e?C.jsx("div",{className:`text-xs text-gray-500 ${s}`,children:C.jsx("span",{children:"AI companion  not medical advice"})}):"medical"===e?C.jsx("div",{className:`bg-blue-50 border border-blue-100 rounded-lg p-4 ${s}`,children:C.jsxs("div",{className:"flex",children:[C.jsx(Ha,{size:20,className:"text-blue-500 flex-shrink-0 mt-0.5 mr-3"}),C.jsxs("div",{className:"flex-1",children:[C.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"Medical Disclaimer"}),C.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Soberi.ai is an informational and self-help tool only. The content and conversations provided by the service do not constitute medical advice, diagnosis, or treatment and do not create a clinicianpatient relationship. Always seek the advice of a qualified health-care professional with any questions you may have regarding a medical condition or mental-health concern."})]}),t&&C.jsx("button",{onClick:t,className:"flex-shrink-0 text-blue-400 hover:text-blue-600 ml-2","aria-label":"Close disclaimer",children:C.jsx(uo,{size:16})})]})}):"emergency"===e?C.jsx("div",{className:`bg-red-50 border border-red-100 rounded-lg p-4 ${s}`,children:C.jsxs("div",{className:"flex",children:[C.jsx(Na,{size:20,className:"text-red-500 flex-shrink-0 mt-0.5 mr-3"}),C.jsxs("div",{className:"flex-1",children:[C.jsx("h4",{className:"text-sm font-medium text-red-800",children:"Emergency Disclaimer"}),C.jsx("p",{className:"text-xs text-red-700 mt-1",children:"If you believe you may harm yourself or others, or are having a medical emergency, call your local emergency number (e.g., 112 in the EU/UK, 911 in the US) immediately. Soberi.ai is not a crisis-response service and cannot contact emergency services on your behalf."})]}),t&&C.jsx("button",{onClick:t,className:"flex-shrink-0 text-red-400 hover:text-red-600 ml-2","aria-label":"Close disclaimer",children:C.jsx(uo,{size:16})})]})}):"ai"===e?C.jsx("div",{className:`bg-amber-50 border border-amber-100 rounded-lg p-4 ${s}`,children:C.jsxs("div",{className:"flex",children:[C.jsx(Ha,{size:20,className:"text-amber-500 flex-shrink-0 mt-0.5 mr-3"}),C.jsxs("div",{className:"flex-1",children:[C.jsx("h4",{className:"text-sm font-medium text-amber-800",children:"AI Disclaimer"}),C.jsx("p",{className:"text-xs text-amber-700 mt-1",children:"Conversations are generated by an artificial-intelligence system and may occasionally produce inaccurate, incomplete, or biased information. You are solely responsible for how you interpret and act on the content."})]}),t&&C.jsx("button",{onClick:t,className:"flex-shrink-0 text-amber-400 hover:text-amber-600 ml-2","aria-label":"Close disclaimer",children:C.jsx(uo,{size:16})})]})}):C.jsxs("div",{className:`space-y-4 ${s}`,children:[C.jsxs("div",{className:"bg-blue-50 border border-blue-100 rounded-lg p-4",children:[C.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"Medical Disclaimer"}),C.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Soberi.ai is an informational and self-help tool only. The content and conversations provided by the service do not constitute medical advice, diagnosis, or treatment and do not create a clinicianpatient relationship."})]}),C.jsxs("div",{className:"bg-red-50 border border-red-100 rounded-lg p-4",children:[C.jsx("h4",{className:"text-sm font-medium text-red-800",children:"Emergency Disclaimer"}),C.jsx("p",{className:"text-xs text-red-700 mt-1",children:"If you believe you may harm yourself or others, or are having a medical emergency, call your local emergency number (911) immediately. Soberi.ai cannot contact emergency services on your behalf."})]}),C.jsxs("div",{className:"bg-amber-50 border border-amber-100 rounded-lg p-4",children:[C.jsx("h4",{className:"text-sm font-medium text-amber-800",children:"AI Disclaimer"}),C.jsx("p",{className:"text-xs text-amber-700 mt-1",children:"Conversations are generated by an artificial-intelligence system and may occasionally produce inaccurate, incomplete, or biased information."})]}),t&&C.jsx("div",{className:"flex justify-end",children:C.jsx("button",{onClick:t,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-200 text-sm",children:"I Understand"})})]}),po=({className:e=""})=>{var t,s;const{user:r,signInWithGoogle:i,signOut:n,loading:a}=ba();return a?C.jsx("button",{className:`flex items-center justify-center bg-gray-200 text-gray-400 py-2 px-4 rounded-lg ${e}`,disabled:!0,children:C.jsx("span",{className:"animate-pulse",children:"Loading..."})}):r?C.jsxs("div",{className:"flex items-center gap-2",children:[(null==(t=r.user_metadata)?void 0:t.avatar_url)&&C.jsx("img",{src:r.user_metadata.avatar_url,alt:"User avatar",className:"w-8 h-8 rounded-full"}),C.jsxs("div",{className:"flex flex-col text-sm",children:[C.jsx("span",{className:"font-medium",children:(null==(s=r.user_metadata)?void 0:s.full_name)||r.email}),C.jsx("button",{onClick:n,className:"text-xs text-red-600 hover:text-red-800 text-left",children:"Sign Out"})]})]}):C.jsxs("button",{onClick:i,className:`flex items-center gap-2 bg-white hover:bg-gray-50 text-gray-800 font-medium py-2 px-4 border border-gray-300 rounded-lg transition-colors duration-200 ${e}`,children:[C.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg",children:C.jsxs("g",{transform:"matrix(1, 0, 0, 1, 27.009001, -39.238998)",children:[C.jsx("path",{fill:"#4285F4",d:"M -3.264 51.509 C -3.264 50.719 -3.334 49.969 -3.454 49.239 L -14.754 49.239 L -14.754 53.749 L -8.284 53.749 C -8.574 55.229 -9.424 56.479 -10.684 57.329 L -10.684 60.329 L -6.824 60.329 C -4.564 58.239 -3.264 55.159 -3.264 51.509 Z"}),C.jsx("path",{fill:"#34A853",d:"M -14.754 63.239 C -11.514 63.239 -8.804 62.159 -6.824 60.329 L -10.684 57.329 C -11.764 58.049 -13.134 58.489 -14.754 58.489 C -17.884 58.489 -20.534 56.379 -21.484 53.529 L -25.464 53.529 L -25.464 56.619 C -23.494 60.539 -19.444 63.239 -14.754 63.239 Z"}),C.jsx("path",{fill:"#FBBC05",d:"M -21.484 53.529 C -21.734 52.809 -21.864 52.039 -21.864 51.239 C -21.864 50.439 -21.724 49.669 -21.484 48.949 L -21.484 45.859 L -25.464 45.859 C -26.284 47.479 -26.754 49.299 -26.754 51.239 C -26.754 53.179 -26.284 54.999 -25.464 56.619 L -21.484 53.529 Z"}),C.jsx("path",{fill:"#EA4335",d:"M -14.754 43.989 C -12.984 43.989 -11.404 44.599 -10.154 45.789 L -6.734 42.369 C -8.804 40.429 -11.514 39.239 -14.754 39.239 C -19.444 39.239 -23.494 41.939 -25.464 45.859 L -21.484 48.949 C -20.534 46.099 -17.884 43.989 -14.754 43.989 Z"})]})}),"Sign in with Google"]})},fo=()=>{const[t,s]=e.useState(null),[r,i]=e.useState(!1);if(e.useEffect((()=>{const e=async()=>{const e=await Yt.getStorageUsage();s(e)};e();const t=setInterval(e,6e4);return()=>clearInterval(t)}),[]),!t||0===t.quota)return null;const n=e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]};return C.jsxs("div",{className:"relative",children:[C.jsxs("button",{onClick:()=>i(!r),className:"p-2 rounded-lg hover:bg-gray-800 transition-colors",title:"Storage Usage",children:[C.jsx(za,{className:"w-5 h-5 "+(a=t.percentage,a<50?"text-green-400":a<80?"text-yellow-400":"text-red-400")}),t.percentage>80&&C.jsx(Na,{className:"w-3 h-3 text-red-400 absolute -top-1 -right-1"})]}),r&&C.jsxs("div",{className:"absolute bottom-full mb-2 right-0 w-64 bg-gray-800 rounded-lg shadow-lg p-4 z-50",children:[C.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Storage Usage"}),C.jsxs("div",{className:"space-y-2",children:[C.jsxs("div",{className:"flex justify-between text-xs text-gray-400",children:[C.jsx("span",{children:"Used"}),C.jsx("span",{children:n(t.usage)})]}),C.jsxs("div",{className:"flex justify-between text-xs text-gray-400",children:[C.jsx("span",{children:"Available"}),C.jsx("span",{children:n(t.quota)})]}),C.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2 mt-2",children:C.jsx("div",{className:`h-2 rounded-full transition-all ${(e=>e<50?"bg-green-500":e<80?"bg-yellow-500":"bg-red-500")(t.percentage)}`,style:{width:`${Math.min(t.percentage,100)}%`}})}),C.jsxs("div",{className:"text-center text-xs text-gray-400 mt-1",children:[t.percentage.toFixed(1),"% used"]}),t.percentage>80&&C.jsxs("div",{className:"mt-3 p-2 bg-red-900/20 border border-red-800 rounded text-xs text-red-400",children:[C.jsx(Na,{className:"w-3 h-3 inline mr-1"}),"Storage is running low. Older messages will be automatically removed if needed."]})]})]})]});var a},yo=({toggleMenu:e,isMenuOpen:t})=>{const{activeTab:s,userProgress:r}=zs();return C.jsxs("header",{className:"bg-white border-b px-4 py-3 flex flex-col lg:px-6",children:[C.jsxs("div",{className:"flex justify-between items-center",children:[C.jsxs("div",{className:"flex items-center",children:[C.jsx("button",{onClick:e,className:"mr-3 p-2 rounded-full hover:bg-gray-100 lg:hidden","aria-label":"Open menu",children:C.jsx(Ka,{size:20,className:"text-gray-600"})}),C.jsxs("div",{children:[C.jsx(a.h1,{className:"text-lg font-semibold text-gray-800",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},children:(()=>{switch(s){case"chat":return"Chat with Soberi";case"checkin":return"Daily Check-In";case"journal":return"Journal";case"progress":return"Your Progress";case"resources":return"Resources";case"tasks":return"Tasks";case"insights":return"Insights";default:return"Soberi.ai"}})()},s),C.jsx(a.p,{className:"text-xs text-gray-500",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3,delay:.1},children:(()=>{switch(s){case"chat":return"Share your thoughts and feelings";case"checkin":return"Track your daily status";case"journal":return"Reflect and record your journey";case"progress":return`${r.currentStreak} day${1!==r.currentStreak?"s":""} clean`;case"resources":return"Support and tools";case"tasks":return"Structure your day";case"insights":return"Reflect on your recovery insights";default:return"Your recovery companion"}})()},`${s}-subtitle`)]})]}),C.jsxs("div",{className:"flex items-center",children:["progress"===s&&C.jsx("div",{className:"hidden sm:block px-3 py-1 bg-indigo-50 text-indigo-600 rounded-full text-xs font-medium",children:r.currentStreak>0?`${r.currentStreak} day streak `:"Start your journey today"}),C.jsx("div",{className:"ml-2",children:C.jsx(fo,{})}),C.jsx("div",{className:"ml-2",children:C.jsx(po,{})})]})]}),"chat"===s&&C.jsx("div",{className:"mt-1 flex justify-end z-50",children:C.jsx(go,{type:"mini"})})]})},xo=({insight:e,onDismiss:t,total:s,current:r})=>{const i=()=>{switch(e.type){case"insight":default:return"text-amber-800";case"encouragement":return"text-pink-800";case"reminder":return"text-blue-800"}};return C.jsxs(a.div,{className:`rounded-lg border p-4 ${(()=>{switch(e.type){case"insight":default:return"bg-amber-50 border-amber-100";case"encouragement":return"bg-pink-50 border-pink-100";case"reminder":return"bg-blue-50 border-blue-100"}})()}`,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:[C.jsxs("div",{className:"flex justify-between items-start",children:[C.jsxs("div",{className:"flex items-center",children:[C.jsx("div",{className:"w-8 h-8 rounded-full bg-white flex items-center justify-center mr-3",children:(()=>{switch(e.type){case"insight":return C.jsx(qa,{className:"text-amber-500\\",size:20});case"encouragement":return C.jsx(Ua,{className:"text-pink-500",size:20});case"reminder":return C.jsx(Sa,{className:"text-blue-500",size:20});default:return C.jsx(qa,{className:"text-amber-500",size:20})}})()}),C.jsxs("h3",{className:`font-medium ${i()}`,children:["insight"===e.type&&"Recovery Insight","encouragement"===e.type&&"Encouragement","reminder"===e.type&&"Helpful Reminder"]})]}),C.jsxs("div",{className:"flex items-center",children:[s>1&&C.jsxs("span",{className:"text-xs mr-3 opacity-75",children:[r," of ",s]}),C.jsx("button",{onClick:t,className:`p-1 rounded-full hover:bg-white/20 ${i()}`,children:C.jsx(uo,{size:16})})]})]}),C.jsx("p",{className:`mt-3 ${i()}`,children:e.content})]})},vo=()=>{const{insights:e,updateInsightNote:t}=zs(),s=[...e].sort(((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()));return C.jsxs("div",{className:"max-w-2xl mx-auto",children:[C.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-2",children:[C.jsx("span",{role:"img","aria-label":"lightbulb",children:""})," Insights"]}),0===s.length?C.jsx("div",{className:"text-gray-500 text-center py-12",children:"No insights yet. Insights from your journey will appear here."}):C.jsx("div",{className:"space-y-8",children:s.map(((e,s)=>C.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[C.jsx(xo,{insight:e,onDismiss:()=>{},total:1,current:1}),C.jsxs("div",{className:"mt-4",children:[C.jsx("label",{htmlFor:`user-note-${e.id}`,className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Reflection"}),C.jsx("textarea",{id:`user-note-${e.id}`,className:"w-full border rounded-lg p-2 text-sm min-h-[60px] focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Write your thoughts about this insight...",value:e.userNote||"",onChange:s=>t(e.id,s.target.value)})]})]},e.id)))})]})},bo=({children:t})=>{const{activeTab:s,setActiveTab:r}=zs(),[i,n]=e.useState(!1),o=()=>{n(!i)},l=[{id:"chat",label:"Chat",icon:Ua,tab:"chat"},{id:"checkin",label:"Check In",icon:Pa,tab:"checkin"},{id:"tasks",label:"Tasks",icon:Da,tab:"tasks"},{id:"journal",label:"Journal",icon:Ta,tab:"journal"},{id:"progress",label:"Progress",icon:ao,tab:"progress"},{id:"insights",label:"Insights",icon:qa,tab:"insights"},{id:"resources",label:"Resources",icon:Fa,tab:"resources"}];return C.jsxs("div",{className:"flex flex-col h-full min-h-screen bg-gradient-to-b from-gray-50 to-white",onKeyDown:e=>{"Escape"===e.key&&i&&n(!1)},children:[C.jsxs("div",{className:"sticky top-0 z-10 w-full",children:[" ",C.jsx(yo,{toggleMenu:o,isMenuOpen:i})]}),C.jsxs("div",{className:"flex flex-1",children:[C.jsx(a.div,{className:"fixed inset-0 backdrop-blur-sm bg-black/30 z-20 lg:hidden",initial:{opacity:0},animate:{opacity:i?1:0},transition:{duration:.2},style:{pointerEvents:i?"auto":"none"},"aria-hidden":!i,children:C.jsxs(a.div,{className:"absolute top-0 left-0 h-full w-64 bg-white shadow-lg",initial:{x:"-100%"},animate:{x:i?0:"-100%"},transition:{duration:.3,ease:"easeInOut"},role:"dialog","aria-modal":"true","aria-label":"Navigation menu",children:[C.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[C.jsx("h2",{className:"text-xl font-semibold text-indigo-600",children:"Soberi.ai"}),C.jsx("button",{onClick:o,className:"p-1 rounded-full hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"Close menu",children:C.jsx(uo,{size:20,className:"text-gray-600"})})]}),C.jsx("nav",{className:"p-4 space-y-2",role:"tablist",children:l.map((e=>C.jsx(mo,{icon:e.icon,label:e.label,isActive:s===e.tab,onClick:()=>{r(e.tab),n(!1)},vertical:!0},e.id)))}),C.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 border-t",children:C.jsxs("button",{onClick:()=>{r("resources"),n(!1)},className:"w-full py-2 px-3 bg-red-50 text-red-700 border border-red-100 rounded-lg flex items-center justify-center hover:bg-red-100 transition-colors duration-200",children:[C.jsx(Fa,{size:16,className:"mr-2"}),C.jsx("span",{className:"text-sm font-medium",children:"Emergency Help"})]})})]})}),C.jsxs("div",{className:"hidden lg:flex lg:flex-col lg:w-64 bg-white/80 backdrop-blur-sm shadow-lg border-r border-gray-100 sticky top-16 z-10 h-[calc(100vh-4rem)] overflow-y-auto",children:[C.jsx("div",{className:"p-4 border-b flex items-center ",children:C.jsx("h2",{className:"text-xl font-semibold text-indigo-600",children:"Soberi.ai"})}),C.jsx("nav",{className:"space-y-2 p-4",role:"tablist","aria-label":"Main navigation",children:l.map((e=>C.jsx(mo,{icon:e.icon,label:e.label,isActive:s===e.tab,onClick:()=>r(e.tab),vertical:!0},e.id)))}),C.jsxs("div",{className:"p-4 border-t",children:[C.jsxs("button",{onClick:()=>r("resources"),className:"w-full py-2 px-3 mb-4 bg-red-50 text-red-700 border border-red-100 rounded-lg flex items-center justify-center hover:bg-red-100 transition-colors duration-200",children:[C.jsx(Fa,{size:16,className:"mr-2"}),C.jsx("span",{className:"text-sm font-medium",children:"Emergency Help"})]}),C.jsx("div",{className:"text-xs text-gray-500",children:C.jsx("p",{className:"mb-1",children:"Version 0.1.0"})})]})]}),C.jsxs("main",{className:"flex-1 pb-20 lg:pb-0 w-full",id:"main-content",children:[" ",C.jsx("div",{className:"container mx-auto p-4",children:"insights"===s?C.jsx(vo,{}):t})]})]})]})},wo=({message:e,sender:t,timestamp:s})=>{const r="user"===t,i=r?"":(n=e,n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>");var n;return C.jsx(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"flex "+(r?"justify-end":"justify-start"),children:C.jsxs("div",{className:`\n        max-w-[85%] md:max-w-[70%]\n        ${r?"bg-gradient-to-br from-indigo-600 to-indigo-700 text-white rounded-2xl shadow-lg":"bg-white/90 backdrop-blur-sm border border-gray-100 text-gray-800 rounded-2xl shadow-md"}\n        px-4 py-3\n      `,children:[r?C.jsx("p",{className:"whitespace-pre-wrap",children:e}):C.jsx("p",{className:"whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:i}}),C.jsx("div",{className:"text-xs mt-2 "+(r?"text-indigo-100/80":"text-gray-400"),children:hs(s)})]})})},jo=({className:e="",width:t="w-full",height:s="h-4"})=>C.jsx("div",{className:`animate-pulse bg-gray-200 rounded ${t} ${s} ${e}`,"aria-hidden":"true"}),ko=()=>C.jsxs("div",{className:"flex flex-col space-y-4 animate-pulse",children:[C.jsx("div",{className:"flex justify-end",children:C.jsxs("div",{className:"max-w-[70%] bg-indigo-600 rounded-tl-lg rounded-tr-lg rounded-bl-lg px-4 py-3",children:[C.jsx(jo,{className:"bg-indigo-400 h-4 w-24 mb-2"}),C.jsx(jo,{className:"bg-indigo-400 h-4 w-32"}),C.jsx("div",{className:"text-xs mt-1 text-indigo-100",children:C.jsx(jo,{className:"bg-indigo-400 h-3 w-12 mt-1"})})]})}),C.jsx("div",{className:"flex justify-start",children:C.jsx("div",{className:"max-w-[70%] bg-white border border-gray-200 rounded-tl-lg rounded-tr-lg rounded-br-lg px-4 py-3 shadow-sm",children:C.jsxs("div",{className:"flex space-x-1",children:[C.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-300 animate-bounce",style:{animationDelay:"0ms"}}),C.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-300 animate-bounce",style:{animationDelay:"150ms"}}),C.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-300 animate-bounce",style:{animationDelay:"300ms"}})]})})})]}),_o=({onSelect:e})=>C.jsxs("div",{children:[C.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Quick responses:"}),C.jsx("div",{className:"flex flex-wrap gap-2",children:["I'm struggling with cravings today","I feel like I might relapse","What coping strategies can help me?","I'm feeling really good today","How do I handle triggers?","I slipped up yesterday"].map(((t,s)=>C.jsx(a.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:()=>e(t),className:"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-full text-xs transition-colors duration-200",children:t},s)))})]}),So=[{priceId:"price_1RUSroFdhzZhnmSKP5fbkOjR",name:"Soberi.ai",description:"If you wish to cancel your subscription, please email us at exaliodevelopment@gmail.com. We will refund the amount corresponding to any unused tokens.",mode:"subscription",price:"20.00",currency:"EUR"}];const No=({product:t=So[0],className:s="",buttonText:r="Subscribe Now",showPrice:i=!0})=>{const{user:n}=ba(),[a,o]=e.useState(!1);return C.jsx("button",{onClick:async()=>{if(n){o(!0);try{const{url:e}=await async function({priceId:e,mode:t,successUrl:s,cancelUrl:r}){try{const{data:i,error:n}=await ya.functions.invoke("stripe-checkout",{body:{price_id:e,mode:t,success_url:s,cancel_url:r}});if(n)throw new Error(n.message);if(!i||!i.sessionId||!i.url)throw new Error("Invalid response from checkout endpoint");return{sessionId:i.sessionId,url:i.url}}catch(i){return{error:i.message}}}({priceId:t.priceId,mode:t.mode,successUrl:`${window.location.origin}/?payment_success=true&session_id={CHECKOUT_SESSION_ID}`,cancelUrl:window.location.href});if(!e)throw new Error("Failed to create checkout session");window.location.href=e}catch(e){alert("Something went wrong. Please try again later.")}finally{o(!1)}}else window.location.href="/login?redirect="+encodeURIComponent(window.location.pathname)},disabled:a,className:`flex items-center justify-center px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-medium rounded-lg transition-colors duration-200 ${s}`,children:a?C.jsxs(C.Fragment,{children:[C.jsx(Qa,{size:18,className:"mr-2 animate-spin"}),"Processing..."]}):C.jsxs(C.Fragment,{children:[r,i&&t.price&&C.jsxs("span",{className:"ml-2",children:[t.price," ",t.currency]})]})})},Co=[{id:"hint-1",text:"Say what's on your mind, even the things you wouldn't ever say to anyone. Your chats are private and never seen by another human being."},{id:"hint-2",text:"Talk to me like you talk to yourself. Share even the deepest things you haven't shared with anyone. Everything is confidential."}],Eo=()=>{const[t,s]=e.useState(""),r=zs((e=>e.messages)),i=zs((e=>e.isLoading)),n=zs((e=>e.insights)),l=zs((e=>e.markInsightSeen)),c=zs((e=>e.sendMessage)),d=e.useRef(null),[h,u]=e.useState(!0),[m,g]=e.useState(!1),[p,f]=e.useState(null),[y,x]=e.useState((()=>{const e=localStorage.getItem("dismissedChatHints");return e?JSON.parse(e):[]})),[v,b]=e.useState(0),w=Co.filter((e=>!y.includes(e.id))),j=w[v];e.useEffect((()=>{localStorage.setItem("dismissedChatHints",JSON.stringify(y))}),[y]),e.useEffect((()=>{v>=w.length&&b(0)}),[w,v]),e.useEffect((()=>{var e;null==(e=d.current)||e.scrollIntoView({behavior:"smooth"})}),[r]),e.useEffect((()=>{const e=n.filter((e=>!e.shown));e.length>0&&!m&&(f(e[0].content),g(!0),l(e[0].id))}),[n,l]);const{user:k,hasPaid:_,chatCount:S}=ba(),N=null==k?void 0:k.id,E=!_&&S>=10,T=async()=>{""!==t.trim()&&N&&(await c(t.trim(),N),s(""))},I=async e=>{N&&await c(e,N)};return C.jsxs("div",{className:"flex flex-col h-full max-w-3xl mx-auto",children:[C.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-4 space-y-6",children:[0===r.length?C.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-4 space-y-4",children:[C.jsx(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"w-20 h-20 rounded-full bg-indigo-100 flex items-center justify-center mb-4",children:C.jsx(a.div,{animate:{scale:[1,1.1,1]},transition:{repeat:1/0,repeatType:"loop",duration:2},children:C.jsx(Ua,{size:36,className:"text-indigo-500"})})}),C.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Welcome to Soberi.ai"}),C.jsx("p",{className:"text-gray-600 max-w-md whitespace-pre-line",children:"Hey! So glad you're here.\n\nLife can throw some curveballs, right? And it's totally cool if you're not feeling 100% right now. We all have those days.\n\nI'm here to chat, listen, and help you figure things out, no pressure. What's up? What's on your mind or what have you been dealing with lately?\n\nFeel free to just vent, brainstorm, or whatever you need. My goal is to be that buddy in your corner, helping you see things a bit clearer or just being a sounding board.\n\nSo, what can I do for you today?"}),C.jsx("div",{className:"w-full max-w-md mt-2",children:C.jsx(_o,{onSelect:I})}),C.jsxs(a.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},className:"w-full max-w-md mt-4 p-4 bg-amber-50 border border-amber-100 rounded-lg",children:[C.jsx("h4",{className:"font-medium text-amber-800 mb-1",children:"About The Recovery Journey"}),C.jsx("p",{className:"text-sm text-amber-700",children:"Recovery often feels worse before it feels better as your brain heals and you learn to process emotions without substances. This discomfort isn't failureit's evidence of healing. Trust the process."})]})]}):C.jsxs(C.Fragment,{children:[C.jsx(o,{children:h&&C.jsxs(a.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-blue-50 border border-blue-100 rounded-lg p-4 mb-4 flex items-start",children:[C.jsx(Ha,{size:18,className:"text-blue-500 mr-3 mt-0.5 flex-shrink-0"}),C.jsxs("div",{className:"flex-1",children:[C.jsx("h4",{className:"font-medium text-blue-800 text-sm",children:"Privacy Assured"}),C.jsx("p",{className:"text-blue-700 text-xs mt-1",children:"Everything you share is private and confidential. I'm here to support your recovery without judgment."})]}),C.jsx("button",{onClick:()=>u(!1),className:"text-blue-500 hover:text-blue-700 ml-2 flex-shrink-0",children:C.jsx(uo,{size:16})})]})}),C.jsx(o,{children:m&&p&&C.jsxs(a.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-amber-50 border border-amber-100 rounded-lg p-4 mb-4 flex items-start",children:[C.jsx("div",{className:"w-8 h-8 rounded-full bg-white flex items-center justify-center mr-3 flex-shrink-0",children:C.jsx(qa,{size:16,className:"text-amber-500"})}),C.jsxs("div",{className:"flex-1",children:[C.jsx("h4",{className:"font-medium text-amber-800 text-sm",children:"Recovery Insight"}),C.jsx("p",{className:"text-amber-700 text-sm mt-1",children:p})]}),C.jsx("button",{onClick:()=>g(!1),className:"text-amber-500 hover:text-amber-700 ml-2 flex-shrink-0",children:C.jsx(uo,{size:16})})]})}),r.map((e=>C.jsx(wo,{message:e.content,sender:e.sender,timestamp:e.timestamp},e.id))),i&&C.jsx(ko,{}),!i&&r.length>0&&C.jsx("div",{className:"my-4",children:C.jsx(_o,{onSelect:I})})]}),C.jsx("div",{ref:d})]}),C.jsx(o,{children:j&&w.length>0&&C.jsxs(a.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-blue-50 border border-blue-100 rounded-lg p-3 mx-4 mb-2 flex items-start",children:[C.jsx(qa,{size:16,className:"text-blue-500 mr-2 mt-0.5 flex-shrink-0"}),C.jsx("div",{className:"flex-1",children:C.jsx("p",{className:"text-blue-700 text-sm",children:j.text})}),C.jsx("button",{onClick:()=>{j&&(x((e=>[...e,j.id])),b((e=>(e+1)%w.length)))},className:"text-blue-500 hover:text-blue-700 ml-2 flex-shrink-0","aria-label":"Dismiss hint",children:C.jsx(uo,{size:14})})]})}),C.jsxs("div",{className:"border-t bg-white p-4",children:[E?C.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 text-center",children:[C.jsx("h4",{className:"text-amber-800 font-semibold mb-2",children:"Free chat limit reached"}),C.jsx("p",{className:"text-amber-700 text-sm mb-4",children:"You've used your 10 free chats. Subscribe to unlock unlimited support and continue your recovery journey."}),C.jsx(No,{buttonText:"Subscribe Now",showPrice:!0})]}):C.jsxs("div",{className:"relative flex items-center",children:[C.jsx("textarea",{value:t,onChange:e=>s(e.target.value),onKeyDown:e=>{"Enter"===e.key&&e.ctrlKey&&(e.preventDefault(),T())},placeholder:"Type your message...",className:"flex-1 resize-none border border-gray-300 rounded-lg p-3 pr-12 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200 max-h-32",rows:1,"aria-label":"Message input",disabled:E||i||!N}),C.jsx("button",{onClick:T,disabled:""===t.trim()||i||E||!N,className:`absolute right-3 p-1 rounded-full \n                ${""===t.trim()||i||E||!N?"bg-gray-200 text-gray-400":"bg-indigo-600 text-white hover:bg-indigo-700"} transition-colors duration-200`,"aria-label":"Send message",children:i?C.jsx(Qa,{size:20,className:"animate-spin"}):C.jsx(to,{size:20})})]}),C.jsx("div",{className:"flex justify-center mt-2",children:C.jsxs("button",{onClick:()=>zs.getState().setActiveTab("resources"),className:"flex items-center text-xs text-orange-600 hover:text-orange-800",children:[C.jsx(Na,{size:12,className:"mr-1"}),C.jsx("span",{children:"Need urgent help? Access crisis resources"})]})})]})]})},To=({selectedMood:e,onSelectMood:t})=>C.jsx("div",{className:"grid grid-cols-5 gap-2",children:[{value:"terrible",emoji:"",label:"Terrible"},{value:"bad",emoji:"",label:"Bad"},{value:"neutral",emoji:"",label:"Neutral"},{value:"good",emoji:"",label:"Good"},{value:"great",emoji:"",label:"Great"}].map((s=>C.jsxs(a.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>t(s.value),className:"flex flex-col items-center justify-center p-3 rounded-2xl transition-all duration-200 hover:shadow-md "+(e===s.value?"bg-gradient-to-b from-indigo-100 to-indigo-50 border-2 border-indigo-500 shadow-inner":"bg-white/80 backdrop-blur-sm border border-gray-100 hover:bg-gray-50"),children:[C.jsx("span",{className:"text-2xl mb-1",children:s.emoji}),C.jsx("span",{className:"text-xs font-medium tracking-wide",children:s.label})]},s.value)))}),Io=({selectedCravingLevel:e,onSelectCravingLevel:t})=>C.jsx("div",{className:"space-y-3",children:[{value:"none",label:"None"},{value:"mild",label:"Mild"},{value:"moderate",label:"Moderate"},{value:"severe",label:"Severe"},{value:"extreme",label:"Extreme"}].map((s=>{const r=e===s.value;return C.jsxs(a.button,{whileTap:{scale:.98},onClick:()=>t(s.value),className:`relative w-full py-3 px-4 rounded-lg border-2 transition-colors duration-200 overflow-hidden text-left ${(()=>{if(r)switch(s.value){case"none":return"bg-green-100 border-green-500";case"mild":return"bg-emerald-100 border-emerald-500";case"moderate":return"bg-yellow-100 border-yellow-500";case"severe":return"bg-orange-100 border-orange-500";case"extreme":return"bg-red-100 border-red-500";default:return"bg-indigo-100 border-indigo-500"}return"bg-gray-50 border-gray-200 hover:bg-gray-100"})()}`,children:[C.jsx("div",{className:`absolute top-0 left-0 h-full ${(()=>{switch(s.value){case"none":return"w-[10%]";case"mild":return"w-[30%]";case"moderate":return"w-[50%]";case"severe":return"w-[75%]";case"extreme":return"w-[95%]";default:return"w-0"}})()} ${(()=>{switch(s.value){case"none":return"bg-green-200";case"mild":return"bg-emerald-200";case"moderate":return"bg-yellow-200";case"severe":return"bg-orange-200";case"extreme":return"bg-red-200";default:return"bg-gray-200"}})()} opacity-30 rounded-l-md`}),C.jsx("span",{className:"relative font-medium",children:s.label})]},s.value)}))}),Ao=({compact:e=!1})=>e?C.jsxs("div",{className:"text-sm",children:[C.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[C.jsx(Ya,{size:16,className:"text-orange-700"}),C.jsx("a",{href:"tel:18006624357",className:"text-orange-700 font-medium hover:underline",children:"SAMHSA Helpline: 1-800-662-4357"})]}),C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx(Ua,{size:16,className:"text-orange-700"}),C.jsx("a",{href:"sms:741741&body=HOME",className:"text-orange-700 font-medium hover:underline",children:"Crisis Text Line: Text HOME to 741741"})]})]}):C.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[C.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Emergency Resources"}),C.jsx("p",{className:"text-gray-600 mb-6",children:"If you're experiencing a crisis or need immediate support, these resources are available 24/7. Your conversation remains confidential, and your privacy is respected."}),C.jsx("div",{className:"space-y-6",children:[{name:"SAMHSA's National Helpline",description:"Treatment referral and information service for substance use disorders",phone:"1-800-662-4357",website:"https://www.samhsa.gov/find-help/national-helpline",available:"24/7, 365 days a year",languages:"English & Spanish"},{name:"National Suicide Prevention Lifeline",description:"Crisis support for mental health emergencies",phone:"988 or 1-800-273-8255",website:"https://988lifeline.org/",available:"24/7",languages:"Multiple languages available"},{name:"Crisis Text Line",description:"Crisis support via text message",phone:"Text HOME to 741741",website:"https://www.crisistextline.org/",available:"24/7",languages:"English"},{name:"FindTreatment.gov",description:"Locate substance use treatment facilities near you",website:"https://findtreatment.gov/",available:"24/7 for online resources",languages:"English"}].map((e=>C.jsxs("div",{className:"border-b border-gray-100 pb-5 last:border-b-0 last:pb-0",children:[C.jsx("h3",{className:"font-medium text-lg mb-1",children:e.name}),C.jsx("p",{className:"text-gray-600 text-sm mb-3",children:e.description}),C.jsxs("div",{className:"space-y-2",children:[e.phone&&C.jsxs("div",{className:"flex items-start",children:[C.jsx(Ya,{size:18,className:"text-indigo-500 mr-2 mt-0.5"}),C.jsx("div",{children:C.jsx("a",{href:`tel:${e.phone.replace(/\D/g,"")}`,className:"text-indigo-600 hover:text-indigo-800 hover:underline font-medium",children:e.phone})})]}),C.jsxs("div",{className:"flex items-start",children:[C.jsx(Ba,{size:18,className:"text-indigo-500 mr-2 mt-0.5"}),C.jsx("div",{children:C.jsx("a",{href:e.website,target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 hover:text-indigo-800 hover:underline",children:e.website.replace("https://","")})})]}),C.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Available: ",e.available,"  ",e.languages]})]})]},e.name)))}),C.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-100",children:[C.jsx("h3",{className:"font-medium mb-2 text-blue-800",children:"Your Privacy Matters"}),C.jsx("p",{className:"text-sm text-blue-700",children:"All helplines prioritize your confidentiality. Soberi.ai does not monitor or share any information about your calls or messages with these services. These are independent resources available to support you when needed."})]})]}),Po=()=>{const{user:t}=ba(),{submitCheckIn:s,sendMessage:r}=zs(),[i,n]=e.useState(null),[o,l]=e.useState(null),[c,d]=e.useState(""),[h,u]=e.useState(!1),[m,g]=e.useState(!1),[p,f]=e.useState(!1),[y,x]=e.useState(!1);e.useEffect((()=>{const e=us(),t=Cs(e);t&&(n(t.mood),l(t.cravingLevel),d(t.notes),u(!0))}),[]),e.useEffect((()=>{"extreme"===o||"severe"===o?(f(!0),x(!0)):(f(!1),x(!1))}),[o]);const v=async()=>{i&&o&&(s(i,o,c),"extreme"===o||"severe"===o?(g(!0),setTimeout((()=>{zs.getState().setActiveTab("chat")}),1500)):g(!0))},b=()=>{n(null),l(null),d(""),g(!1),u(!1)};return m?C.jsx(a.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"max-w-lg mx-auto bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:C.jsxs("div",{className:"text-center py-8",children:[C.jsx(a.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20,delay:.2},className:"w-16 h-16 bg-green-100 rounded-full mx-auto flex items-center justify-center mb-4",children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),C.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Check-In Complete!"}),"extreme"===o||"severe"===o?C.jsxs("div",{children:[C.jsx("p",{className:"text-gray-600 mb-3",children:"I've noticed you're experiencing strong cravings right now."}),C.jsx("p",{className:"text-gray-600 mb-6",children:"Taking you to the chat for immediate support..."})]}):C.jsx("p",{className:"text-gray-600 mb-6",children:"Thank you for checking in today. Your honesty helps build self-awareness, a key skill in recovery."}),C.jsx("button",{onClick:b,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors duration-200",children:"Check In Again"})]})}):C.jsx("div",{className:"max-w-lg mx-auto",children:h?C.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[C.jsxs("div",{className:"flex items-center mb-4",children:[C.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center mr-3",children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),C.jsxs("div",{children:[C.jsx("h3",{className:"text-lg font-medium",children:"You've already checked in today"}),C.jsx("p",{className:"text-sm text-gray-500",children:"Want to update your check-in?"})]})]}),C.jsx("button",{onClick:b,className:"w-full px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-lg transition-colors duration-200",children:"Update Today's Check-In"})]}):C.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[C.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Daily Check-In"}),C.jsx("p",{className:"text-gray-600 text-sm mb-6",children:"Tracking your mood and cravings helps build self-awareness and identifies patterns in your recovery journey."}),C.jsxs("div",{className:"space-y-8",children:[C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"How are you feeling today?"}),C.jsx(To,{selectedMood:i,onSelectMood:n})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Rate your cravings today"}),C.jsx(Io,{selectedCravingLevel:o,onSelectCravingLevel:l})]}),C.jsxs(a.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"bg-indigo-50 border border-indigo-100 rounded-lg p-4",children:[C.jsx("h3",{className:"text-indigo-900 font-medium mb-2",children:"Recovery Context"}),C.jsx("p",{className:"text-indigo-700 text-sm mb-3",children:"Recovery often feels worse before it gets better as your brain heals and you learn to process emotions. This discomfort isn't failureit's evidence of healing."}),C.jsx("p",{className:"text-indigo-700 text-sm",children:"You're developing the strength to feel difficult emotions without substances. This skill takes time but becomes easier with practice."})]}),p&&C.jsxs(a.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[C.jsx("h3",{className:"text-orange-800 font-medium mb-2",children:"Need immediate help?"}),C.jsx("p",{className:"text-orange-700 text-sm mb-3",children:"Strong cravings are temporary and will pass. You're not alone in this moment."}),C.jsx(Ao,{compact:!0}),C.jsx("p",{className:"text-orange-700 text-sm mt-3",children:"After submitting your check-in, we'll provide personalized strategies and connect you with immediate support."})]}),C.jsxs("div",{children:[C.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (optional)"}),C.jsx("textarea",{id:"notes",rows:3,value:c,onChange:e=>d(e.target.value),placeholder:"What's affecting your mood or cravings today? Any triggers or victories to note?",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition"})]}),y?C.jsxs("div",{className:"flex flex-col space-y-3",children:[C.jsx("button",{onClick:async()=>{if(i&&o){s(i,o,c);const e=`I'm having ${o} cravings right now and feeling ${i}.`;if(zs.getState().setActiveTab("chat"),!t||!t.id){const e={id:(zs.getState().messages.length>0?zs.getState().messages[0].id:"temp-error-id")+"error",content:"You need to be logged in to talk to Soberi.ai. Please log in and try again.",sender:"ai",timestamp:Date.now()};return void zs.setState((t=>({messages:[...t.messages,e]})))}setTimeout((()=>{r(e,t.id)}),100)}},className:"w-full py-3 px-4 rounded-lg font-medium bg-indigo-600 hover:bg-indigo-700 text-white transition-colors duration-200",children:"Talk to Soberi Now"}),C.jsx("button",{onClick:v,className:"w-full py-3 px-4 rounded-lg font-medium bg-white border border-indigo-300 text-indigo-700 hover:bg-indigo-50 transition-colors duration-200",children:"Submit Check-In Only"})]}):C.jsx("button",{onClick:v,disabled:!i||!o,className:"w-full py-3 px-4 rounded-lg font-medium transition-colors duration-200\n                  "+(i&&o?"bg-indigo-600 hover:bg-indigo-700 text-white":"bg-gray-200 text-gray-400 cursor-not-allowed"),children:"Submit Check-In"})]})]})})},Oo=({entry:t,onDelete:s,onSelectTag:r})=>{const[i,n]=e.useState(!1),[l,c]=e.useState(!1);return C.jsx(a.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:l?0:1,y:l?-20:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:C.jsxs("div",{className:"p-5",children:[C.jsxs("div",{className:"flex justify-between items-start mb-3",children:[C.jsx("div",{className:"text-sm text-gray-500",children:ds(t.date)}),C.jsxs("div",{className:"relative",children:[C.jsx("button",{onClick:()=>{n(!i)},className:"p-1 hover:bg-gray-100 rounded-full transition-colors duration-200","aria-label":"Entry actions",children:C.jsx(Va,{size:16,className:"text-gray-500"})}),C.jsx(o,{children:i&&C.jsx(a.div,{initial:{opacity:0,scale:.95,y:-5},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-5},transition:{duration:.1},className:"absolute right-0 mt-1 w-32 bg-white rounded-md shadow-lg z-10 overflow-hidden",children:C.jsxs("button",{onClick:()=>{c(!0),setTimeout((()=>{s(t.id)}),300)},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center",children:[C.jsx(no,{size:14,className:"mr-2"}),"Delete"]})})})]})]}),C.jsx("div",{className:"prose prose-sm max-w-none mb-4",children:C.jsx("p",{className:"whitespace-pre-wrap",children:t.content})}),t.tags.length>0&&C.jsx("div",{className:"flex flex-wrap gap-1 mt-3",children:t.tags.map((e=>C.jsx("button",{onClick:()=>r(e),className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800 hover:bg-gray-200 transition-colors duration-200",children:e},e)))})]})})},Ro=({onComplete:t})=>{const{addJournalEntry:s}=zs(),[r,i]=e.useState(""),[n,a]=e.useState(""),[o,l]=e.useState([]),c=()=>{const e=n.trim();e&&!o.includes(e)&&(l([...o,e]),a(""))};return C.jsxs("div",{children:[C.jsx("textarea",{value:r,onChange:e=>i(e.target.value),placeholder:"What's on your mind today?",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition",rows:5}),C.jsxs("div",{className:"mt-4",children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags (optional)"}),C.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-2 border border-gray-300 rounded-lg focus-within:ring-2 focus-within:ring-indigo-500 focus-within:border-transparent mb-3",children:[o.map((e=>C.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:[e,C.jsx("button",{type:"button",onClick:()=>{return t=e,void l(o.filter((e=>e!==t)));var t},className:"ml-1.5 text-indigo-600 hover:text-indigo-900 focus:outline-none",children:C.jsx(uo,{size:14})})]},e))),C.jsx("input",{type:"text",value:n,onChange:e=>a(e.target.value),onKeyDown:e=>{"Enter"===e.key&&n.trim()?(e.preventDefault(),c()):"Backspace"===e.key&&!n&&o.length>0&&l(o.slice(0,-1))},placeholder:0===o.length?"Add tags...":"",className:"flex-1 min-w-[120px] outline-none text-sm"}),n&&C.jsx("button",{type:"button",onClick:c,className:"inline-flex items-center p-1 border border-transparent text-xs font-medium rounded text-indigo-700 bg-indigo-100 hover:bg-indigo-200 transition-colors duration-200",children:C.jsx(Za,{size:14})})]}),C.jsxs("div",{className:"flex flex-wrap gap-1 mb-6",children:[C.jsx("span",{className:"text-xs text-gray-500 mr-1",children:"Suggestions:"}),["progress","challenge","victory","trigger","coping","gratitude"].map((e=>C.jsx("button",{type:"button",onClick:()=>!o.includes(e)&&l([...o,e]),disabled:o.includes(e),className:"text-xs px-2 py-0.5 rounded-full transition-colors duration-200 \n                "+(o.includes(e)?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:e},e)))]})]}),C.jsxs("div",{className:"flex justify-end space-x-3",children:[C.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:"Cancel"}),C.jsx("button",{type:"button",onClick:()=>{r.trim()&&(s(r,o),i(""),l([]),t())},disabled:!r.trim(),className:"px-4 py-2 rounded-lg transition-colors duration-200 "+(r.trim()?"bg-indigo-600 hover:bg-indigo-700 text-white":"bg-gray-200 text-gray-400 cursor-not-allowed"),children:"Save Entry"})]})]})},Do=()=>{const{journalEntries:t,removeJournalEntry:s}=zs(),[r,i]=e.useState(!1),[n,l]=e.useState(""),[c,d]=e.useState(null),h=()=>{i(!r)},u=()=>{i(!1)},m=Array.from(new Set(t.flatMap((e=>e.tags)))),g=t.filter((e=>{const t=""===n||e.content.toLowerCase().includes(n.toLowerCase()),s=null===c||e.tags.includes(c);return t&&s})).sort(((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()));return C.jsxs("div",{className:"max-w-3xl mx-auto",children:[C.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[C.jsxs("div",{className:"relative flex-1",children:[C.jsx("input",{type:"text",placeholder:"Search journal entries...",value:n,onChange:e=>l(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition"}),C.jsx(eo,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),n&&C.jsx("button",{onClick:()=>l(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:C.jsx(uo,{size:16})})]}),C.jsxs(a.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:h,className:"flex items-center justify-center gap-1 bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg transition-colors duration-200 shadow-sm",children:[C.jsx(Za,{size:18}),C.jsx("span",{children:"New Entry"})]})]}),m.length>0&&C.jsxs("div",{className:"mb-6 flex flex-wrap gap-2",children:[C.jsxs("div",{className:"flex items-center mr-1",children:[C.jsx(ro,{size:16,className:"text-gray-500 mr-1"}),C.jsx("span",{className:"text-sm text-gray-600",children:"Filter:"})]}),null!==c&&C.jsxs("button",{onClick:()=>d(null),className:"text-xs flex items-center gap-1 px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded-full transition-colors duration-200",children:["Clear",C.jsx(uo,{size:12})]}),m.map((e=>C.jsx(a.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>d(c===e?null:e),className:"text-xs px-3 py-1 rounded-full transition-colors duration-200 "+(c===e?"bg-indigo-100 text-indigo-800":"bg-gray-100 text-gray-800 hover:bg-gray-200"),children:e},e)))]}),C.jsx(o,{children:r&&C.jsxs(a.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},className:"mb-8 bg-white rounded-xl shadow-md border border-gray-200 p-5",children:[C.jsxs("div",{className:"flex justify-between items-center mb-4",children:[C.jsx("h3",{className:"text-lg font-medium",children:"New Journal Entry"}),C.jsx("button",{onClick:u,className:"text-gray-500 hover:text-gray-700",children:C.jsx(uo,{size:20})})]}),C.jsx(Ro,{onComplete:u})]})}),0===g.length?C.jsxs("div",{className:"text-center py-12",children:[C.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full mx-auto flex items-center justify-center mb-4",children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:C.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),C.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-1",children:"No journal entries yet"}),C.jsx("p",{className:"text-gray-500 mb-4",children:"Start writing to record your thoughts and progress"}),C.jsx("button",{onClick:h,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors duration-200",children:"Create Your First Entry"})]}):C.jsx("div",{className:"space-y-4",children:g.map((e=>C.jsx(Oo,{entry:e,onDelete:s,onSelectTag:d},e.id)))})]})},$o=({title:t,value:s,unit:r,icon:i,color:n,accentColor:o,animate:c=!1})=>{const d=l(),h=e.useRef(s);return e.useEffect((()=>{c&&s>h.current&&d.start({scale:[1,1.1,1],transition:{duration:.5}}),h.current=s}),[s,c,d]),C.jsxs(a.div,{animate:d,className:`${n} rounded-xl p-5 border border-gray-100`,children:[C.jsxs("div",{className:"flex items-center mb-3",children:[C.jsx("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center mr-3",children:i}),C.jsx("h3",{className:"text-gray-700 font-medium",children:t})]}),C.jsxs("div",{className:`text-3xl font-bold ${o}`,children:[s,C.jsx("span",{className:"text-sm font-normal text-gray-500 ml-1",children:r})]})]})},Lo=({checkIns:e})=>{const t=new Date,s=u(t),r=m(t),i=g({start:s,end:r}),n=p(s),a=t=>{const s=e.find((e=>f(new Date(e.date),t)));if(!s)return"bg-gray-100";switch(s.mood){case"great":return"bg-green-500";case"good":return"bg-emerald-400";case"neutral":return"bg-yellow-300";case"bad":return"bg-orange-400";case"terrible":return"bg-red-500";default:return"bg-gray-100"}};return C.jsxs("div",{className:"bg-white rounded-lg",children:[C.jsx("div",{className:"text-center mb-4",children:C.jsx("h3",{className:"text-lg font-medium",children:c(t,"MMMM yyyy")})}),C.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map((e=>C.jsx("div",{className:"text-xs text-center text-gray-500 font-medium",children:e},e)))}),C.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[Array.from({length:n}).map(((e,t)=>C.jsx("div",{className:"aspect-square"},`empty-${t}`))),i.map((s=>{const r=f(s,t),i=e.some((e=>f(new Date(e.date),s)));return C.jsx("div",{className:"aspect-square flex items-center justify-center rounded-full relative "+(r?"border-2 border-indigo-500":""),children:C.jsx("div",{className:`\n                  w-3/4 h-3/4 rounded-full flex items-center justify-center\n                  ${i?a(s):"bg-gray-100"}\n                  ${r?"border-2 border-white":""}\n                `,children:C.jsx("span",{className:"text-xs font-medium "+(i?"text-white":"text-gray-700"),children:c(s,"d")})})},s.toString())}))]}),C.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[C.jsx("div",{className:"text-xs text-gray-600 mr-1",children:"Mood:"}),C.jsxs("div",{className:"flex items-center gap-1",children:[C.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),C.jsx("span",{className:"text-xs text-gray-600",children:"Great"})]}),C.jsxs("div",{className:"flex items-center gap-1",children:[C.jsx("div",{className:"w-3 h-3 rounded-full bg-emerald-400"}),C.jsx("span",{className:"text-xs text-gray-600",children:"Good"})]}),C.jsxs("div",{className:"flex items-center gap-1",children:[C.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-300"}),C.jsx("span",{className:"text-xs text-gray-600",children:"Neutral"})]}),C.jsxs("div",{className:"flex items-center gap-1",children:[C.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-400"}),C.jsx("span",{className:"text-xs text-gray-600",children:"Bad"})]}),C.jsxs("div",{className:"flex items-center gap-1",children:[C.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),C.jsx("span",{className:"text-xs text-gray-600",children:"Terrible"})]})]})]})},Mo=({isOpen:t,onClose:s})=>{const{markRelapse:r,sendMessage:i}=zs(),[n,l]=e.useState(""),[c,d]=e.useState(!1);return C.jsx(o,{children:t&&C.jsx(a.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:C.jsxs(a.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-xl shadow-xl max-w-md w-full overflow-hidden",children:[C.jsxs("div",{className:"flex justify-between items-center border-b p-4",children:[C.jsx("h3",{className:"text-lg font-semibold",children:"Record a Relapse"}),C.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-gray-100",children:C.jsx(uo,{size:20,className:"text-gray-500"})})]}),C.jsxs("div",{className:"p-6",children:[C.jsx("p",{className:"mb-4 text-gray-700",children:"Recording a relapse will reset your current streak, but it's an important part of the recovery process. Soberi is here to support you through this moment."}),C.jsxs("div",{className:"mb-4",children:[C.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-700 mb-1",children:"What happened? (optional)"}),C.jsx("textarea",{id:"reason",rows:3,value:n,onChange:e=>l(e.target.value),placeholder:"Share what led to this moment if you'd like...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition"})]}),C.jsxs("div",{className:"flex space-x-3 justify-end",children:[C.jsx("button",{onClick:s,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:"Cancel"}),C.jsx("button",{onClick:async()=>{d(!0),r(),n.trim()?await i(`I had a relapse. ${n.trim()}`):await i("I had a relapse and could use some support."),d(!1),l(""),s(),zs.getState().setActiveTab("chat")},disabled:c,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors duration-200 flex items-center",children:c?C.jsxs(C.Fragment,{children:[C.jsx("span",{className:"mr-2",children:"Processing"}),C.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[C.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),C.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})]}):"Record & Get Support"})]})]})]})})})},Bo=()=>{const{triggerLogs:t,addTriggerLog:s,removeTriggerLog:r}=zs(),[i,n]=e.useState(!1),[l,c]=e.useState(""),[d,h]=e.useState(5),[u,m]=e.useState(""),[g,p]=e.useState(!0),[f,y]=e.useState(""),x=()=>{c(""),h(5),m(""),p(!0),y(""),n(!1)},v=[...t].sort(((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()));return C.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[C.jsxs("div",{className:"flex justify-between items-center mb-6",children:[C.jsxs("div",{children:[C.jsx("h3",{className:"text-lg font-medium",children:"Trigger Tracker"}),C.jsx("p",{className:"text-sm text-gray-600",children:"Log triggers and strategies to learn what works for you"})]}),C.jsxs("button",{onClick:()=>n(!0),className:"flex items-center px-3 py-1.5 bg-indigo-100 text-indigo-700 rounded-lg hover:bg-indigo-200 transition-colors duration-200",children:[C.jsx(Xa,{size:16,className:"mr-1"}),C.jsx("span",{className:"text-sm",children:"Add New"})]})]}),C.jsx(o,{children:i&&C.jsxs(a.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mb-6 border border-gray-200 rounded-lg p-4",children:[C.jsxs("div",{className:"flex justify-between items-center mb-4",children:[C.jsx("h4",{className:"font-medium",children:"Record a Trigger"}),C.jsx("button",{onClick:x,className:"text-gray-400 hover:text-gray-600",children:C.jsx(uo,{size:18})})]}),C.jsxs("div",{className:"space-y-4",children:[C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"What triggered you?"}),C.jsx("input",{type:"text",value:l,onChange:e=>c(e.target.value),placeholder:"Describe what triggered your craving",className:"w-full p-2 border border-gray-300 rounded-lg"}),C.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:["Stress","Negative emotions","Social pressure","Being around users","Certain locations","Celebrations","Boredom","Arguments"].map((e=>C.jsx("button",{type:"button",onClick:()=>c(e),className:"text-xs px-2 py-0.5 bg-gray-100 hover:bg-gray-200 rounded-full transition-colors duration-200",children:e},e)))})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Intensity (1-10)"}),C.jsxs("div",{className:"flex items-center",children:[C.jsx("input",{type:"range",min:"1",max:"10",value:d,onChange:e=>h(parseInt(e.target.value)),className:"w-full"}),C.jsx("span",{className:"ml-2 text-sm font-medium w-6 text-center",children:d})]}),C.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[C.jsx("span",{children:"Mild"}),C.jsx("span",{children:"Moderate"}),C.jsx("span",{children:"Severe"})]})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Strategy Used"}),C.jsx("input",{type:"text",value:u,onChange:e=>m(e.target.value),placeholder:"What did you do to cope?",className:"w-full p-2 border border-gray-300 rounded-lg"}),C.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:["Called support person","Used urge surfing","Distraction technique","Physical exercise","Mindfulness meditation","Left the situation","Delayed decision (waited it out)","Used HALT check"].map((e=>C.jsx("button",{type:"button",onClick:()=>m(e),className:"text-xs px-2 py-0.5 bg-gray-100 hover:bg-gray-200 rounded-full transition-colors duration-200",children:e},e)))})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Was it successful?"}),C.jsxs("div",{className:"flex space-x-2",children:[C.jsx("button",{type:"button",onClick:()=>p(!0),className:"px-3 py-1 rounded-lg text-sm "+(g?"bg-green-100 text-green-700 border border-green-200":"bg-gray-100 text-gray-700 border border-gray-200"),children:"Yes"}),C.jsx("button",{type:"button",onClick:()=>p(!1),className:"px-3 py-1 rounded-lg text-sm "+(g?"bg-gray-100 text-gray-700 border border-gray-200":"bg-red-100 text-red-700 border border-red-200"),children:"No"})]})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (optional)"}),C.jsx("textarea",{value:f,onChange:e=>y(e.target.value),rows:2,placeholder:"Any additional details about this experience",className:"w-full p-2 border border-gray-300 rounded-lg"})]}),C.jsxs("div",{className:"flex justify-end space-x-2",children:[C.jsx("button",{type:"button",onClick:x,className:"px-3 py-1.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-200 text-sm",children:"Cancel"}),C.jsx("button",{type:"button",onClick:()=>{l&&u&&(s(l,d,u,g,f),x())},disabled:!l||!u,className:"px-3 py-1.5 rounded-lg text-sm "+(l&&u?"bg-indigo-600 text-white hover:bg-indigo-700":"bg-gray-200 text-gray-400 cursor-not-allowed"),children:"Save Trigger"})]})]})]})}),0===v.length?C.jsxs("div",{className:"text-center py-8",children:[C.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center mx-auto mb-3",children:C.jsx(Na,{size:20,className:"text-gray-500"})}),C.jsx("h4",{className:"text-gray-700 font-medium mb-1",children:"No triggers logged yet"}),C.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Track what triggers your cravings and which strategies help"}),C.jsx("button",{onClick:()=>n(!0),className:"px-3 py-1.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-200 text-sm",children:"Log Your First Trigger"})]}):C.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:v.map((e=>C.jsxs(a.div,{initial:{opacity:0},animate:{opacity:1},className:"p-3 rounded-lg border "+(e.successful?"border-green-100 bg-green-50":"border-red-100 bg-red-50"),children:[C.jsxs("div",{className:"flex justify-between",children:[C.jsx("h5",{className:"font-medium text-sm",children:e.trigger}),C.jsxs("div",{className:"flex items-center",children:[C.jsx("span",{className:"text-xs text-gray-500 mr-2",children:ds(e.date)}),C.jsx("button",{onClick:()=>r(e.id),className:"text-gray-400 hover:text-gray-600",children:C.jsx(uo,{size:14})})]})]}),C.jsxs("div",{className:"mt-1 text-xs text-gray-600 flex items-center",children:[C.jsxs("div",{className:"mr-3",children:["Intensity:",C.jsxs("span",{className:"font-medium ml-1",children:[e.intensity,"/10"]})]}),C.jsxs("div",{children:["Strategy:",C.jsx("span",{className:"font-medium ml-1",children:e.strategy})]})]}),e.notes&&C.jsx("p",{className:"mt-2 text-xs text-gray-600 border-t border-gray-200 pt-1",children:e.notes})]},e.id)))})]})},zo=({milestones:e})=>{const t=[...e].sort(((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())),s=e=>{switch(e){case"streak":default:return C.jsx(Ea,{className:"text-indigo-500"});case"relapse":return C.jsx(Na,{className:"text-orange-500"});case"achievement":return C.jsx(oo,{className:"text-yellow-500"})}},r=e=>{switch(e){case"streak":return"bg-indigo-50 border-indigo-100";case"relapse":return"bg-orange-50 border-orange-100";case"achievement":return"bg-yellow-50 border-yellow-100";default:return"bg-gray-50 border-gray-100"}};return C.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[C.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Your Recovery Journey"}),C.jsx("p",{className:"text-gray-600 mb-6",children:"Every step matters - celebrate your progress and learn from setbacks."}),0===t.length?C.jsxs("div",{className:"text-center py-12",children:[C.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full mx-auto flex items-center justify-center mb-4",children:C.jsx(oo,{size:24,className:"text-gray-400"})}),C.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-1",children:"No milestones yet"}),C.jsx("p",{className:"text-gray-500 mb-4",children:"Keep going! Your first milestone will appear when you reach a streak of 7 days."})]}):C.jsxs("div",{className:"relative",children:[C.jsx("div",{className:"absolute top-0 bottom-0 left-6 w-0.5 bg-gray-200 z-0"}),C.jsx("div",{className:"space-y-8 relative z-10",children:t.map(((e,t)=>C.jsxs(a.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1*t},className:"flex gap-4",children:[C.jsx("div",{className:"w-12 h-12 rounded-full border-2 border-white bg-white shadow-sm flex items-center justify-center flex-shrink-0",children:s(e.type)}),C.jsxs("div",{className:`flex-1 p-4 rounded-lg border ${r(e.type)}`,children:[C.jsxs("div",{className:"flex justify-between items-start",children:[C.jsxs("h4",{className:"font-medium",children:["streak"===e.type&&`${e.value} Day Streak`,"relapse"===e.type&&"Relapse Recovery","achievement"===e.type&&"Achievement Unlocked"]}),C.jsx("span",{className:"text-xs text-gray-500",children:ds(e.date)})]}),C.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),"relapse"===e.type&&C.jsx("p",{className:"text-xs text-orange-700 mt-2",children:"Remember, recovery isn't linear. Each relapse is an opportunity to learn and grow stronger."}),"streak"===e.type&&e.value>=30&&C.jsxs("div",{className:"mt-2 text-xs text-indigo-600 bg-indigo-50 p-2 rounded",children:[C.jsx("span",{className:"font-medium",children:"Amazing work!"})," You've reached a significant milestone in your recovery journey."]})]})]},e.id)))})]})]})},Uo=e.createContext({value:"",onValueChange:()=>{}}),Ho=({value:e,onValueChange:t,children:s,className:r=""})=>C.jsx(Uo.Provider,{value:{value:e,onValueChange:t},children:C.jsx("div",{className:r,children:s})}),Fo=({children:e,className:t=""})=>C.jsx("div",{className:`flex space-x-4 ${t}`,children:e}),qo=({value:t,children:s,className:r=""})=>{const{value:i,onValueChange:n}=e.useContext(Uo),a=i===t;return C.jsx("button",{className:`px-3 py-1.5 text-sm font-medium transition-all relative rounded-full\n        ${a?"bg-gradient-to-r from-indigo-500 to-indigo-600 text-white shadow-md":"text-gray-600 hover:text-gray-800 hover:bg-gray-100/50 bg-white/80 backdrop-blur-sm"}\n        ${r}`,onClick:()=>n(t),role:"tab","aria-selected":a,children:s})},Wo=({value:t,children:s,className:r=""})=>{const{value:i}=e.useContext(Uo);return i===t?C.jsx("div",{className:r,role:"tabpanel",children:s}):null},Jo=()=>{const{userProgress:t,checkIns:s}=zs(),[r,i]=e.useState(!1),[n,o]=e.useState("progress");return null!==t.startDate?C.jsxs("div",{className:"max-w-4xl mx-auto",children:[C.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[C.jsx($o,{title:"Current Streak",value:t.currentStreak,unit:"days",icon:C.jsx(Ea,{size:20,className:"text-indigo-500"}),color:"bg-indigo-50",accentColor:"text-indigo-600",animate:!0}),C.jsx($o,{title:"Longest Streak",value:t.longestStreak,unit:"days",icon:C.jsx(Oa,{size:20,className:"text-emerald-500"}),color:"bg-emerald-50",accentColor:"text-emerald-600"}),C.jsx($o,{title:"Total Clean Days",value:t.totalDaysClean,unit:"days",icon:C.jsx(Ea,{size:20,className:"text-blue-500"}),color:"bg-blue-50",accentColor:"text-blue-600"})]}),C.jsxs(Ho,{value:n,onValueChange:o,children:[C.jsxs(Fo,{className:"mb-6",children:[C.jsx(qo,{value:"progress",children:"Calendar"}),C.jsx(qo,{value:"triggers",children:"Trigger Tracker"}),C.jsx(qo,{value:"milestones",children:"Milestones"})]}),C.jsx(Wo,{value:"progress",children:C.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[C.jsxs("div",{className:"lg:col-span-2 bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[C.jsx("h3",{className:"text-lg font-medium mb-4",children:"Your Progress Calendar"}),C.jsx(Lo,{checkIns:s})]}),C.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 flex flex-col",children:[C.jsx("h3",{className:"text-lg font-medium mb-4",children:"Recovery Tools"}),C.jsx("p",{className:"text-gray-600 text-sm mb-6",children:"These tools help you manage your recovery journey effectively."}),C.jsxs("div",{className:"space-y-4 mt-auto",children:[C.jsxs("button",{onClick:()=>i(!0),className:"w-full py-3 px-4 flex items-center justify-center gap-2 bg-white border border-gray-300 hover:bg-gray-50 rounded-lg transition-colors duration-200",children:[C.jsx(Na,{size:18,className:"text-orange-500"}),C.jsx("span",{children:"Record a Relapse"})]}),C.jsxs("button",{onClick:()=>{zs.getState().resetProgress()},className:"w-full py-3 px-4 flex items-center justify-center gap-2 bg-white border border-gray-300 hover:bg-gray-50 rounded-lg transition-colors duration-200",children:[C.jsx(Qa,{size:18,className:"text-gray-600"}),C.jsx("span",{children:"Reset Progress"})]})]})]})]})}),C.jsx(Wo,{value:"triggers",children:C.jsx(Bo,{})}),C.jsx(Wo,{value:"milestones",children:C.jsx(zo,{milestones:t.milestones||[]})})]}),C.jsx(Mo,{isOpen:r,onClose:()=>i(!1)})]}):C.jsx("div",{className:"flex flex-col items-center justify-center h-full py-16 text-center",children:C.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 max-w-md",children:[C.jsx("div",{className:"w-16 h-16 bg-indigo-100 rounded-full mx-auto flex items-center justify-center mb-5",children:C.jsx(Oa,{size:32,className:"text-indigo-600"})}),C.jsx("h2",{className:"text-xl font-semibold mb-3",children:"Start Your Journey"}),C.jsx("p",{className:"text-gray-600 mb-6",children:"Begin tracking your recovery progress by completing your first daily check-in."}),C.jsx("button",{onClick:()=>{zs.getState().setActiveTab("checkin")},className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors duration-200",children:"Go to Daily Check-In"})]})})},Ko=()=>C.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[C.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Recovery Resources"}),C.jsx("p",{className:"text-gray-600 mb-6",children:"Recovery is stronger with support. Here are evidence-based resources to help you on your journey."}),C.jsxs("div",{className:"mb-8",children:[C.jsxs("div",{className:"flex items-center mb-4",children:[C.jsx("div",{className:"w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center mr-3",children:C.jsx(ho,{size:18,className:"text-indigo-600"})}),C.jsx("h3",{className:"text-lg font-medium",children:"Support Groups"})]}),C.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{name:"Alcoholics Anonymous",description:"12-step recovery program for alcohol addiction",website:"https://www.aa.org/",features:["Find local meetings","Online meetings available","Free to join"]},{name:"Narcotics Anonymous",description:"12-step program for drug addiction recovery",website:"https://www.na.org/",features:["Global community","Peer support","Free to join"]},{name:"SMART Recovery",description:"Science-based addiction recovery support group",website:"https://www.smartrecovery.org/",features:["Alternative to 12-step","CBT-based approach","Online & in-person options"]},{name:"Refuge Recovery",description:"Buddhist-inspired approach to recovery",website:"https://refugerecovery.org/",features:["Mindfulness-based","Meditation-focused","Compassionate community"]}].map((e=>C.jsxs("div",{className:"border border-gray-100 rounded-lg p-4 hover:border-indigo-200 transition-colors duration-200",children:[C.jsx("h4",{className:"font-medium mb-1",children:e.name}),C.jsx("p",{className:"text-gray-600 text-sm mb-2",children:e.description}),C.jsx("ul",{className:"text-xs text-gray-500 mb-3",children:e.features.map(((e,t)=>C.jsxs("li",{className:"flex items-center mb-1",children:[C.jsx("span",{className:"w-1.5 h-1.5 bg-indigo-400 rounded-full mr-2"}),e]},t)))}),C.jsxs("a",{href:e.website,target:"_blank",rel:"noopener noreferrer",className:"text-xs flex items-center text-indigo-600 hover:text-indigo-800 hover:underline",children:[C.jsx(Ba,{size:12,className:"mr-1"}),"Visit Website"]})]},e.name)))})]}),C.jsxs("div",{className:"mb-8",children:[C.jsxs("div",{className:"flex items-center mb-4",children:[C.jsx("div",{className:"w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center mr-3",children:C.jsx(Ia,{size:18,className:"text-indigo-600"})}),C.jsx("h3",{className:"text-lg font-medium",children:"Educational Resources"})]}),C.jsx("div",{className:"space-y-3",children:[{name:"NIDA - National Institute on Drug Abuse",description:"Research-based information on drug use and addiction",website:"https://nida.nih.gov/"},{name:"Recovery Research Institute",description:"Non-profit research institute for addiction recovery",website:"https://www.recoveryanswers.org/"},{name:"In The Rooms",description:"Online recovery meetings and community",website:"https://www.intherooms.com/"}].map((e=>C.jsxs("div",{className:"flex justify-between items-center p-3 border border-gray-100 rounded-lg hover:border-indigo-200 transition-colors duration-200",children:[C.jsxs("div",{children:[C.jsx("h4",{className:"font-medium text-sm",children:e.name}),C.jsx("p",{className:"text-gray-600 text-xs",children:e.description})]}),C.jsxs("a",{href:e.website,target:"_blank",rel:"noopener noreferrer",className:"text-xs flex items-center text-indigo-600 hover:text-indigo-800 hover:underline",children:[C.jsx(Ba,{size:12,className:"mr-1"}),"Visit"]})]},e.name)))})]}),C.jsxs("div",{children:[C.jsxs("div",{className:"flex items-center mb-4",children:[C.jsx("div",{className:"w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center mr-3",children:C.jsx(Ea,{size:18,className:"text-indigo-600"})}),C.jsx("h3",{className:"text-lg font-medium",children:"Recovery Skills"})]}),C.jsxs("div",{className:"space-y-3",children:[C.jsxs("div",{className:"p-4 border border-gray-100 rounded-lg",children:[C.jsx("h4",{className:"font-medium mb-2",children:"H.A.L.T."}),C.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"When cravings hit, check if you're:"}),C.jsxs("ul",{className:"grid grid-cols-2 gap-2 text-sm",children:[C.jsxs("li",{className:"flex items-center",children:[C.jsx("span",{className:"w-1.5 h-1.5 bg-red-400 rounded-full mr-2"}),C.jsx("span",{className:"font-medium",children:"H"}),"ungry"]}),C.jsxs("li",{className:"flex items-center",children:[C.jsx("span",{className:"w-1.5 h-1.5 bg-amber-400 rounded-full mr-2"}),C.jsx("span",{className:"font-medium",children:"A"}),"ngry"]}),C.jsxs("li",{className:"flex items-center",children:[C.jsx("span",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full mr-2"}),C.jsx("span",{className:"font-medium",children:"L"}),"onely"]}),C.jsxs("li",{className:"flex items-center",children:[C.jsx("span",{className:"w-1.5 h-1.5 bg-purple-400 rounded-full mr-2"}),C.jsx("span",{className:"font-medium",children:"T"}),"ired"]})]}),C.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Address these basic needs first as they often trigger cravings or emotional distress."})]}),C.jsxs("div",{className:"p-4 border border-gray-100 rounded-lg",children:[C.jsx("h4",{className:"font-medium mb-2",children:"U.R.G.E. Surfing"}),C.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"A technique to manage cravings:"}),C.jsxs("ul",{className:"space-y-2 text-sm",children:[C.jsxs("li",{className:"flex items-start",children:[C.jsx("span",{className:"w-5 h-5 bg-indigo-100 rounded-full flex items-center justify-center mr-2 mt-0.5",children:"U"}),C.jsxs("div",{children:[C.jsx("span",{className:"font-medium",children:"Understand"})," that urges are temporary"]})]}),C.jsxs("li",{className:"flex items-start",children:[C.jsx("span",{className:"w-5 h-5 bg-indigo-100 rounded-full flex items-center justify-center mr-2 mt-0.5",children:"R"}),C.jsxs("div",{children:[C.jsx("span",{className:"font-medium",children:"Recognize"})," what you're feeling"]})]}),C.jsxs("li",{className:"flex items-start",children:[C.jsx("span",{className:"w-5 h-5 bg-indigo-100 rounded-full flex items-center justify-center mr-2 mt-0.5",children:"G"}),C.jsxs("div",{children:[C.jsx("span",{className:"font-medium",children:"Get"})," support or use coping skills"]})]}),C.jsxs("li",{className:"flex items-start",children:[C.jsx("span",{className:"w-5 h-5 bg-indigo-100 rounded-full flex items-center justify-center mr-2 mt-0.5",children:"E"}),C.jsxs("div",{children:[C.jsx("span",{className:"font-medium",children:"Expect"})," the urge to pass"]})]})]})]})]})]})]}),Go=()=>{const[t,s]=e.useState("immediate"),r=[{id:"immediate",label:"Immediate Relief",icon:La,color:"bg-red-50 text-red-700 border-red-100"},{id:"cognitive",label:"Thought Strategies",icon:Aa,color:"bg-blue-50 text-blue-700 border-blue-100"},{id:"physical",label:"Physical Techniques",icon:_a,color:"bg-green-50 text-green-700 border-green-100"},{id:"social",label:"Social Support",icon:co,color:"bg-purple-50 text-purple-700 border-purple-100"},{id:"longterm",label:"Long-term Strategies",icon:io,color:"bg-amber-50 text-amber-700 border-amber-100"}],i={immediate:[{title:"HALT Check",description:"Ask yourself if you're Hungry, Angry, Lonely, or Tired. Address these basic needs first.",steps:["Identify which of these needs might be triggering cravings","Take immediate action (eat, calm down, call someone, or rest)","Reassess your craving level after addressing the need"]},{title:"Urge Surfing",description:"Visualize your craving as a wave that will rise, peak, and eventually subside.",steps:["Notice the physical sensations of the craving","Breathe deeply and observe these sensations without judgment","Visualize riding the wave until it naturally subsides","Remember: most urges peak at 20-30 minutes, then decrease"]},{title:"5-4-3-2-1 Grounding",description:"Use your senses to ground yourself in the present moment.",steps:["Name 5 things you can see","Name 4 things you can physically feel","Name 3 things you can hear","Name 2 things you can smell","Name 1 thing you can taste"]},{title:"Cold Water Technique",description:"Using temperature to interrupt craving patterns.",steps:["Fill a bowl with cold water or grab an ice cube","Dip your face in the water or hold the ice in your hand","Focus intently on the physical sensation","This activates the parasympathetic nervous system to calm your body"]}],cognitive:[{title:"Thought Challenging",description:"Identify and challenge unhelpful thoughts that contribute to cravings.",steps:["Write down your craving-related thought (e.g., 'One use won't hurt')","Identify the thinking distortion (e.g., minimizing consequences)","Challenge with evidence ('Previous 'just once' led to relapse')","Create a more realistic thought ('Using now will threaten my progress')"]},{title:"Playing the Tape Forward",description:"Visualize the full consequences of giving in to the craving.",steps:["Imagine in detail what would happen if you use","Include both immediate aftermath and longer-term effects","Visualize how you'll feel tomorrow, next week, next month","Focus on specific consequences to relationships, work, health"]},{title:"Values Reconnection",description:"Remind yourself of your deeper values and why recovery matters.",steps:["Keep a list of your core values (e.g., health, family, integrity)","Review how sobriety aligns with these values","Write about how substance use conflicts with these values","Visualize your future self thanking you for staying strong now"]}],physical:[{title:"Progressive Muscle Relaxation",description:"Systematically tensing and relaxing muscle groups to reduce physical tension.",steps:["Find a quiet place to sit or lie down","Tense each muscle group for 5-10 seconds, then release","Work from toes to head, noticing the difference between tension and relaxation","Focus on your breathing between each muscle group"]},{title:"Intense Exercise Burst",description:"Quick, intense physical activity to change your physiological state.",steps:["Choose a simple exercise (jumping jacks, push-ups, brisk walk)","Do it intensely for 1-5 minutes","Focus completely on the physical sensations","This releases endorphins and changes brain chemistry"]},{title:"4-7-8 Breathing",description:"A breathing pattern to activate relaxation response.",steps:["Inhale quietly through your nose for 4 seconds","Hold your breath for 7 seconds","Exhale completely through your mouth for 8 seconds","Repeat 4 times"]}],social:[{title:"Call Your Support Person",description:"Reach out to someone who understands your recovery journey.",steps:["Keep 2-3 support contacts in your favorites list","Tell them honestly: 'I'm having strong cravings right now'","Ask them to listen, distract you, or remind you of your progress","Stay on the phone until the urge decreases"]},{title:"Online Support Group",description:"Connect with recovery communities available 24/7.",steps:["Bookmark online meeting resources (AA/NA online, SMART Recovery)","Join a meeting even if it's already in progress","Share that you're struggling right now","Listen to others' experiences with cravings and how they cope"]},{title:"Accountable Messaging",description:"Text your accountability partner about your craving.",steps:["Establish a person you can text anytime about cravings","Send a message describing your craving level and situation","Commit to checking in again in 30 minutes","Knowing you'll report back increases your commitment to resist"]}],longterm:[{title:"Trigger Identification & Planning",description:"Map your personal triggers and develop specific response plans.",steps:["List all your known triggers (people, places, emotions, situations)","Rate each trigger by intensity (1-10)","Develop a specific plan for each high-intensity trigger","Practice your response plans through visualization or role-play"]},{title:"Daily Meditation Practice",description:"Build mindfulness skills to observe cravings without acting on them.",steps:["Start with just 5 minutes of meditation daily","Focus on observing thoughts without judgment","Gradually increase duration as your skills improve","Use guided meditation apps focused on addiction recovery"]},{title:"H.O.W. Program",description:"A framework for daily recovery maintenance.",steps:["Honesty: Daily self-check about thoughts, feelings, and behaviors","Open-mindedness: Consider new recovery strategies and perspectives","Willingness: Take concrete actions each day that support your recovery"]},{title:"Lifestyle Redesign",description:"Gradually reshape your environment and activities to support sobriety.",steps:["Identify aspects of your lifestyle that supported addiction","Create substitute activities that provide similar benefits","Gradually build new social connections through healthy activities","Redesign your physical spaces to remove triggers and add positive cues"]}]}[t],n=r.find((e=>e.id===t));return C.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[C.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Coping Skills Library"}),C.jsx("p",{className:"text-gray-600 mb-6",children:"Evidence-based techniques to manage cravings and build recovery skills."}),C.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2 mb-6",children:r.map((e=>{const r=e.id===t,i=e.icon;return C.jsxs("button",{onClick:()=>s(e.id),className:`p-3 rounded-lg border flex flex-col items-center text-center transition-colors duration-200\n                ${r?e.color:"bg-gray-50 text-gray-700 border-gray-200 hover:bg-gray-100"}\n              `,children:[C.jsx(i,{size:20,className:"mb-1"}),C.jsx("span",{className:"text-xs font-medium",children:e.label})]},e.id)}))}),C.jsx("div",{className:"space-y-6",children:i.map(((e,s)=>C.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*s},className:"border border-gray-200 rounded-lg overflow-hidden",children:[C.jsxs("div",{className:`${null==n?void 0:n.color} p-4`,children:[C.jsx("h3",{className:"font-medium",children:e.title}),C.jsx("p",{className:"text-sm mt-1",children:e.description})]}),C.jsxs("div",{className:"p-4 bg-white",children:[C.jsx("h4",{className:"text-sm font-medium mb-2",children:"How to practice:"}),C.jsx("ol",{className:"space-y-2",children:e.steps.map(((e,t)=>C.jsxs("li",{className:"text-sm flex items-start",children:[C.jsx("span",{className:"w-5 h-5 bg-gray-100 rounded-full flex items-center justify-center mr-2 flex-shrink-0 mt-0.5",children:t+1}),C.jsx("span",{className:"text-gray-700",children:e})]},t)))})]})]},`${t}-${s}`)))}),C.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg border border-gray-100",children:[C.jsx("h3",{className:"font-medium mb-1",children:"Practice makes progress"}),C.jsx("p",{className:"text-sm text-gray-600",children:"These skills become more effective with regular practice. Try to work with these techniques when your cravings are at a 3-4 out of 10, so you can build your skills before facing more intense urges."})]})]})},Vo=({type:e,onBack:t})=>C.jsxs("div",{className:"max-w-3xl mx-auto bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[C.jsxs("div",{className:"flex items-center mb-6",children:[C.jsx("button",{onClick:t,className:"p-2 mr-2 rounded-full hover:bg-gray-100","aria-label":"Go back",children:C.jsx(Ca,{size:20,className:"text-gray-600"})}),C.jsxs("h1",{className:"text-2xl font-semibold",children:["terms"===e&&"Terms of Service","privacy"===e&&"Privacy Policy","ai"===e&&"AI Transparency"]})]}),C.jsxs("div",{className:"prose max-w-none",children:["terms"===e&&C.jsxs(C.Fragment,{children:[C.jsx("h2",{children:"1. Introduction"}),C.jsx("p",{children:'These Terms of Service ("Terms") govern your access to and use of Soberi.ai, including any content, functionality, and services offered through Soberi.ai (the "Service").'}),C.jsx("h2",{children:"2. Medical Disclaimer"}),C.jsx("p",{children:"Soberi.ai is an informational and self-help tool only. The content and conversations provided by the service do not constitute medical advice, diagnosis, or treatment and do not create a clinicianpatient relationship. Always seek the advice of a qualified health-care professional with any questions you may have regarding a medical condition or mental-health concern."}),C.jsx("h2",{children:"3. Emergency Disclaimer"}),C.jsx("p",{children:"If you believe you may harm yourself or others, or are having a medical emergency, call your local emergency number (e.g., 112 in the EU/UK, 911 in the US) immediately. Soberi.ai is not a crisis-response service and cannot contact emergency services on your behalf."}),C.jsx("h2",{children:"4. AI & Accuracy Disclaimer"}),C.jsx("p",{children:"Conversations are generated by an artificial-intelligence system and may occasionally produce inaccurate, incomplete, or biased information. You are solely responsible for how you interpret and act on the content."}),C.jsx("h2",{children:"5. No Warranties / Limitation of Liability"}),C.jsx("p",{children:'The service is provided "as is" and "as available," without warranties of any kind, express or implied. To the maximum extent permitted by law, the company disclaims all liability for losses or damages arising from your use of Soberi.ai.'}),C.jsx("h2",{children:"6. Age Restriction"}),C.jsx("p",{children:"Soberi.ai is intended for users 18 years and older. If you are under 18, please do not use the service."}),C.jsx("h2",{children:"7. User-Generated Content & Moderation"}),C.jsx("p",{children:"We reserve the right to remove any content that violates these Terms or that we find objectionable for any reason. You are responsible for all content you submit to the Service."}),C.jsx("h2",{children:"8. Intellectual Property"}),C.jsx("p",{children:'"Soberi.ai" and all related logos, trademarks, and service marks are owned by us. All other trademarks, service marks, and logos used in connection with our Service are the property of their respective owners.'}),C.jsx("h2",{children:"9. Changes to Terms"}),C.jsx("p",{children:"We may modify these Terms at any time. It is your responsibility to review these Terms periodically. Your continued use of the Service constitutes acceptance of any changes."})]}),"privacy"===e&&C.jsxs(C.Fragment,{children:[C.jsx("h2",{children:"1. Introduction"}),C.jsx("p",{children:'This Privacy Policy describes how we collect, use, and share your personal information when you use Soberi.ai (the "Service").'}),C.jsx("h2",{children:"2. Information We Collect"}),C.jsx("p",{children:"We collect information you provide directly to us, including:"}),C.jsxs("ul",{children:[C.jsx("li",{children:"Chat messages and interactions with the AI"}),C.jsx("li",{children:"Journal entries"}),C.jsx("li",{children:"Check-in data regarding your mood and cravings"}),C.jsx("li",{children:"Progress tracking information"}),C.jsx("li",{children:"Task information"}),C.jsx("li",{children:"Device information and usage data"})]}),C.jsx("h2",{children:"3. How We Use Your Information"}),C.jsx("p",{children:"We use your information to:"}),C.jsxs("ul",{children:[C.jsx("li",{children:"Provide, maintain, and improve the Service"}),C.jsx("li",{children:"Personalize your experience"}),C.jsx("li",{children:"Monitor and analyze usage trends"}),C.jsx("li",{children:"Enhance the safety and security of the Service"}),C.jsx("li",{children:"Communicate with you about the Service"})]}),C.jsx("h2",{children:"4. Data Storage and Security"}),C.jsx("p",{children:"Your data is stored locally on your device and synchronized with secure cloud storage when you are online. We implement appropriate technical and organizational measures to protect your personal data."}),C.jsx("h2",{children:"5. GDPR Compliance"}),C.jsx("p",{children:"For users in the European Economic Area (EEA), we process your personal data in accordance with the General Data Protection Regulation (GDPR)."}),C.jsx("p",{children:"Lawful basis for processing:"}),C.jsxs("ul",{children:[C.jsx("li",{children:"Consent: For processing health-related data"}),C.jsx("li",{children:"Contract: To provide you with the Service"}),C.jsx("li",{children:"Legitimate Interests: To improve our Service"})]}),C.jsx("h2",{children:"6. Your Rights"}),C.jsx("p",{children:"Depending on your location, you may have certain rights regarding your personal information, including:"}),C.jsxs("ul",{children:[C.jsx("li",{children:"Access to your personal data"}),C.jsx("li",{children:"Correction of inaccurate data"}),C.jsx("li",{children:"Deletion of your data"}),C.jsx("li",{children:"Data portability"}),C.jsx("li",{children:"Withdrawal of consent"})]}),C.jsx("h2",{children:"7. Changes to This Privacy Policy"}),C.jsx("p",{children:"We may update this Privacy Policy from time to time. We will notify you of any changes by posting the new Privacy Policy on this page."}),C.jsx("h2",{children:"8. Contact Us"}),C.jsx("p",{children:"If you have any questions about this Privacy Policy, please contact us at: privacy@Soberi.ai"})]}),"ai"===e&&C.jsxs(C.Fragment,{children:[C.jsx("h2",{children:"1. AI Technology"}),C.jsx("p",{children:"Soberi.ai uses advanced artificial intelligence technology to provide recovery support through conversations. Our AI system is designed to offer encouragement, information, and coping strategies for addiction recovery."}),C.jsx("h2",{children:"2. How Our AI Works"}),C.jsx("p",{children:"Our AI uses natural language processing to understand your messages and generate helpful responses. The system is trained on a wide range of recovery-related information but does not provide medical advice or treatment."}),C.jsx("h2",{children:"3. AI Limitations"}),C.jsx("p",{children:"While our AI strives to provide accurate and helpful information, it has several limitations:"}),C.jsxs("ul",{children:[C.jsx("li",{children:"It may occasionally generate incorrect or incomplete information"}),C.jsx("li",{children:"It cannot diagnose medical conditions or provide personalized medical advice"}),C.jsx("li",{children:"It cannot contact emergency services if you are in crisis"}),C.jsx("li",{children:"It may not always understand complex emotional states or nuanced situations"})]}),C.jsx("h2",{children:"4. EU AI Act Compliance"}),C.jsx("p",{children:"Soberi.ai is designed to comply with the EU AI Act requirements for high-risk AI systems, including risk assessment, bias monitoring, and technical documentation."})]})]})]}),Yo=()=>{const{memories:t,removeMemory:s,addMemory:r}=zs(),[i,n]=e.useState(""),[l,d]=e.useState("all"),[h,u]=e.useState(!1),[m,g]=e.useState({content:"",type:"personal_detail",importance:5,tags:""}),p=t.filter((e=>{const t=""===i||e.content.toLowerCase().includes(i.toLowerCase())||e.tags.some((e=>e.toLowerCase().includes(i.toLowerCase()))),s="all"===l||e.type===l;return t&&s})).sort(((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())),f=e=>{switch(e){case"personal_detail":return"bg-blue-100 text-blue-800";case"preference":return"bg-purple-100 text-purple-800";case"breakthrough":return"bg-green-100 text-green-800";case"trigger":return"bg-red-100 text-red-800";case"coping_strategy":return"bg-teal-100 text-teal-800";case"goal":return"bg-amber-100 text-amber-800";case"relapse":return"bg-orange-100 text-orange-800";case"conversation_summary":return"bg-indigo-100 text-indigo-800";default:return"bg-gray-100 text-gray-800"}},y=["personal_detail","preference","breakthrough","trigger","coping_strategy","goal","relapse","conversation_summary"];return C.jsxs("div",{className:"max-w-4xl mx-auto",children:[C.jsxs("div",{className:"mb-6",children:[C.jsx("h1",{className:"text-2xl font-semibold mb-2",children:"Memory System Debug View"}),C.jsx("p",{className:"text-gray-600",children:"This view allows you to inspect and manage Soberi.ai's memory system, which helps the AI provide more personalized responses."})]}),C.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4 items-start",children:[C.jsxs("div",{className:"relative flex-1",children:[C.jsx("input",{type:"text",placeholder:"Search memories...",value:i,onChange:e=>n(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition"}),C.jsx(eo,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),i&&C.jsx("button",{onClick:()=>n(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:C.jsx(uo,{size:16})})]}),C.jsx("div",{children:C.jsxs("select",{value:l,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition",children:[C.jsx("option",{value:"all",children:"All Memory Types"}),y.map((e=>C.jsx("option",{value:e,children:e.replace("_"," ").replace(/\b\w/g,(e=>e.toUpperCase()))},e)))]})}),C.jsxs("button",{onClick:()=>u(!h),className:"flex items-center justify-center gap-1 bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg transition-colors duration-200 shadow-sm whitespace-nowrap",children:[C.jsx(Za,{size:18}),C.jsx("span",{children:"Add Memory"})]})]}),C.jsx(o,{children:h&&C.jsxs(a.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mb-8 bg-white rounded-xl shadow-md border border-gray-200 p-5",children:[C.jsxs("div",{className:"flex justify-between items-center mb-4",children:[C.jsx("h3",{className:"text-lg font-medium",children:"Add New Memory"}),C.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:C.jsx(uo,{size:20})})]}),C.jsxs("div",{className:"space-y-4",children:[C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Memory Content"}),C.jsx("textarea",{value:m.content,onChange:e=>g({...m,content:e.target.value}),placeholder:"Enter memory content...",rows:3,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition"})]}),C.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Memory Type"}),C.jsx("select",{value:m.type,onChange:e=>g({...m,type:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition",children:y.map((e=>C.jsx("option",{value:e,children:e.replace("_"," ").replace(/\b\w/g,(e=>e.toUpperCase()))},e)))})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Importance (1-10)"}),C.jsxs("div",{className:"flex items-center",children:[C.jsx("input",{type:"range",min:"1",max:"10",value:m.importance,onChange:e=>g({...m,importance:parseInt(e.target.value)}),className:"w-full"}),C.jsx("span",{className:"ml-2 text-sm font-medium w-6 text-center",children:m.importance})]})]})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tags (comma separated)"}),C.jsx("input",{type:"text",value:m.tags,onChange:e=>g({...m,tags:e.target.value}),placeholder:"mood, recovery, trigger, etc.",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition"})]}),C.jsxs("div",{className:"flex justify-end space-x-3",children:[C.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:"Cancel"}),C.jsx("button",{onClick:()=>{if(""===m.content.trim())return;const e={id:crypto.randomUUID(),date:(new Date).toISOString(),content:m.content,type:m.type,importance:m.importance,tags:m.tags.split(",").map((e=>e.trim())).filter(Boolean),accessCount:0};r(e),g({content:"",type:"personal_detail",importance:5,tags:""}),u(!1)},disabled:!m.content.trim(),className:"px-4 py-2 rounded-lg transition-colors duration-200 "+(m.content.trim()?"bg-indigo-600 hover:bg-indigo-700 text-white":"bg-gray-200 text-gray-400 cursor-not-allowed"),children:"Save Memory"})]})]})]})}),C.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[C.jsxs("h2",{className:"text-lg font-medium mb-4",children:["Memory Entries (",p.length,")"]}),0===p.length?C.jsx("div",{className:"text-center py-8",children:C.jsx("p",{className:"text-gray-500",children:"No memories found matching your criteria."})}):C.jsx("div",{className:"space-y-4",children:p.map((e=>C.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:border-indigo-200 transition-colors duration-200",children:[C.jsxs("div",{className:"flex justify-between",children:[C.jsxs("div",{className:"flex items-center",children:[C.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${f(e.type)}`,children:e.type.replace("_"," ")}),C.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["Importance: ",e.importance,"/10"]})]}),C.jsxs("div",{className:"flex items-center",children:[C.jsxs("span",{className:"text-xs text-gray-500 flex items-center",children:[C.jsx(La,{size:12,className:"mr-1"}),c(new Date(e.date),"MMM d, yyyy")]}),C.jsx("button",{onClick:()=>s(e.id),className:"ml-3 text-gray-400 hover:text-red-500",children:C.jsx(no,{size:16})})]})]}),C.jsx("p",{className:"mt-2 text-gray-700",children:e.content}),e.tags.length>0&&C.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:e.tags.map(((e,t)=>C.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 text-gray-700 rounded-full",children:e},t)))}),C.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["Accessed ",e.accessCount," times",e.lastAccessed&&`  Last accessed: ${c(new Date(e.lastAccessed),"MMM d, yyyy")}`]})]},e.id)))})]})]})},Xo=()=>{const[t,s]=e.useState(""),[r,i]=e.useState(""),[n,a]=e.useState(!1),{generateContextFromMemories:o}=zs();return C.jsxs("div",{className:"max-w-3xl mx-auto",children:[C.jsxs("div",{className:"mb-6",children:[C.jsx("h1",{className:"text-2xl font-semibold mb-2",children:"Memory Context Demo"}),C.jsx("p",{className:"text-gray-600",children:"This demo shows how the AI generates context from past memories to provide more personalized responses. Type a message and see what memories the AI would retrieve."})]}),C.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[C.jsx("h2",{className:"text-lg font-medium mb-4",children:"Test Memory Retrieval"}),C.jsxs("div",{className:"mb-4",children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Enter a message to generate context"}),C.jsx("textarea",{value:t,onChange:e=>s(e.target.value),placeholder:"Type a message like you would in chat...",rows:3,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition"})]}),C.jsx("div",{className:"flex justify-end",children:C.jsx("button",{onClick:async()=>{if(!t.trim())return;a(!0);const e=await o(t);i(e),a(!1)},disabled:!t.trim()||n,className:"flex items-center px-4 py-2 rounded-lg transition-colors duration-200\n              "+(!t.trim()||n?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700 text-white"),children:n?C.jsxs(C.Fragment,{children:[C.jsx(Qa,{size:18,className:"mr-2 animate-spin"}),"Generating..."]}):C.jsxs(C.Fragment,{children:[C.jsx(to,{size:18,className:"mr-2"}),"Generate Context"]})})})]}),r&&C.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[C.jsx("h2",{className:"text-lg font-medium mb-4",children:"Retrieved Memory Context"}),""===r.trim()?C.jsxs("div",{className:"bg-amber-50 border border-amber-100 rounded-lg p-4 mb-4",children:[C.jsx("p",{className:"text-amber-800",children:"No relevant memories found for this message. This could be because:"}),C.jsxs("ul",{className:"list-disc pl-5 mt-2 text-amber-700 text-sm",children:[C.jsx("li",{children:"The AI doesn't have enough memories stored yet"}),C.jsx("li",{children:"The message doesn't contain topics that match any stored memories"}),C.jsx("li",{children:"The message is too generic or doesn't contain personal information"})]})]}):C.jsxs(C.Fragment,{children:[C.jsx("div",{className:"bg-indigo-50 border border-indigo-100 rounded-lg p-4 mb-4",children:C.jsx("p",{className:"text-indigo-800 text-sm",children:"This is the context the AI would use to generate a more personalized response. This information isn't shown to you during normal conversations but helps the AI remember important details about your recovery journey."})}),C.jsx("pre",{className:"bg-gray-50 p-4 rounded-lg text-gray-700 text-sm overflow-x-auto whitespace-pre-wrap",children:r})]})]})]})},Zo=()=>{const[t,s]=e.useState("emergency"),[r,i]=e.useState(null),[n,a]=e.useState(!1);return e.useEffect((()=>{const e=()=>{const e=window.location.hash;"#terms"===e?i("terms"):"#privacy"===e?i("privacy"):"#ai"===e?i("ai"):"#memory-debug"===e&&a(!0)};return e(),window.addEventListener("hashchange",e),()=>{window.removeEventListener("hashchange",e)}}),[]),r?C.jsx(Vo,{type:r,onBack:()=>{i(null),window.history.pushState("",document.title,window.location.pathname+window.location.search)}}):n?C.jsxs("div",{children:[C.jsx("div",{className:"mb-4",children:C.jsxs("button",{onClick:()=>{a(!1),window.history.pushState("",document.title,window.location.pathname+window.location.search)},className:"flex items-center text-indigo-600 hover:text-indigo-800",children:[C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:C.jsx("path",{fillRule:"evenodd",d:"M9.707 14.707a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 1.414L7.414 9H15a1 1 0 110 2H7.414l2.293 2.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Back to Resources"]})}),C.jsxs(Ho,{value:"memory-debug",onValueChange:e=>{},children:[C.jsxs(Fo,{className:"mb-6",children:[C.jsx(qo,{value:"memory-debug",children:"Memory Debug"}),C.jsx(qo,{value:"memory-context",children:"Context Demo"})]}),C.jsx(Wo,{value:"memory-debug",children:C.jsx(Yo,{})}),C.jsx(Wo,{value:"memory-context",children:C.jsx(Xo,{})})]})]}):C.jsxs("div",{className:"max-w-4xl mx-auto",children:[C.jsxs("div",{className:"mb-6",children:[C.jsx("h1",{className:"text-2xl font-semibold mb-2",children:"Recovery Resources"}),C.jsx("p",{className:"text-gray-600",children:"Access helplines, support groups, and coping strategies to strengthen your recovery journey."})]}),C.jsxs(Ho,{value:t,onValueChange:s,children:[C.jsxs(Fo,{className:"mb-6",children:[C.jsx(qo,{value:"emergency",children:"Emergency Help"}),C.jsx(qo,{value:"resources",children:"Support Groups"}),C.jsx(qo,{value:"coping",children:"Coping Skills"}),C.jsx(qo,{value:"legal",children:"Legal"})]}),C.jsx(Wo,{value:"emergency",children:C.jsx(Ao,{})}),C.jsx(Wo,{value:"resources",children:C.jsx(Ko,{})}),C.jsx(Wo,{value:"coping",children:C.jsx(Go,{})}),C.jsx(Wo,{value:"legal",children:C.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[C.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Legal Information"}),C.jsx("p",{className:"text-gray-600 mb-6",children:"Review our legal documents and policies:"}),C.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[C.jsxs("button",{onClick:()=>i("terms"),className:"p-5 border border-gray-200 rounded-lg hover:border-indigo-200 transition-colors duration-200",children:[C.jsx("h3",{className:"font-medium text-lg mb-2",children:"Terms of Service"}),C.jsx("p",{className:"text-sm text-gray-600",children:"Review the terms and conditions for using Soberi.ai"})]}),C.jsxs("button",{onClick:()=>i("privacy"),className:"p-5 border border-gray-200 rounded-lg hover:border-indigo-200 transition-colors duration-200",children:[C.jsx("h3",{className:"font-medium text-lg mb-2",children:"Privacy Policy"}),C.jsx("p",{className:"text-sm text-gray-600",children:"Learn how we collect, use, and protect your data"})]}),C.jsxs("button",{onClick:()=>i("ai"),className:"p-5 border border-gray-200 rounded-lg hover:border-indigo-200 transition-colors duration-200",children:[C.jsx("h3",{className:"font-medium text-lg mb-2",children:"AI Transparency"}),C.jsx("p",{className:"text-sm text-gray-600",children:"Information about how our AI technology works"})]})]}),C.jsxs("div",{className:"mt-8 pt-4 border-t border-gray-100",children:[C.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Developer Options"}),C.jsx("button",{onClick:()=>a(!0),className:"text-xs text-gray-500 hover:text-indigo-600",children:"Memory System Debug"})]})]})})]})]})},Qo=({onClose:t,selectedDate:s=us()})=>{const{addTask:r}=zs(),[i,n]=e.useState(""),[a,o]=e.useState(""),[l,c]=e.useState("medium"),[d,h]=e.useState("self-care"),[u,m]=e.useState(void 0),[g,p]=e.useState(s);return C.jsxs("div",{className:"bg-white rounded-xl shadow-md border border-gray-200 p-5",children:[C.jsxs("div",{className:"flex justify-between items-center mb-4",children:[C.jsx("h3",{className:"font-medium text-lg",children:"Add New Task"}),C.jsx("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded-full",children:C.jsx(uo,{size:18,className:"text-gray-500"})})]}),C.jsxs("div",{className:"space-y-4",children:[C.jsxs("div",{children:[C.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Task Title *"}),C.jsx("input",{id:"title",type:"text",value:i,onChange:e=>n(e.target.value),placeholder:"What do you need to do?",className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),C.jsxs("div",{children:[C.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (optional)"}),C.jsx("textarea",{id:"description",value:a,onChange:e=>o(e.target.value),placeholder:"Add any details or steps",rows:2,className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),C.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),C.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:[{value:"self-care",label:"Self-care",emoji:""},{value:"physical",label:"Physical",emoji:""},{value:"social",label:"Social",emoji:""},{value:"productive",label:"Productive",emoji:""},{value:"recovery",label:"Recovery",emoji:""}].map((e=>C.jsxs("button",{type:"button",onClick:()=>h(e.value),className:"px-3 py-2 text-center text-sm rounded-lg border transition-colors duration-200 flex items-center justify-center\n                    "+(d===e.value?"border-indigo-300 bg-indigo-50 text-indigo-800":"border-gray-200 hover:border-gray-300"),children:[C.jsx("span",{className:"mr-1",children:e.emoji}),e.label]},e.value)))})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),C.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{value:"high",label:"High",color:"bg-red-100 text-red-800 border-red-200"},{value:"medium",label:"Medium",color:"bg-amber-100 text-amber-800 border-amber-200"},{value:"low",label:"Low",color:"bg-blue-100 text-blue-800 border-blue-200"}].map((e=>C.jsx("button",{type:"button",onClick:()=>c(e.value),className:`px-3 py-2 text-center text-sm rounded-lg border transition-colors duration-200\n                    ${l===e.value?e.color:"border-gray-200 hover:border-gray-300"}`,children:e.label},e.value)))})]})]}),C.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[C.jsxs("div",{children:[C.jsx("label",{htmlFor:"timeEstimate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Estimate (minutes)"}),C.jsx("input",{id:"timeEstimate",type:"number",min:"1",value:u||"",onChange:e=>m(e.target.value?parseInt(e.target.value):void 0),placeholder:"How long will this take?",className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),C.jsxs("div",{children:[C.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),C.jsxs("div",{className:"relative",children:[C.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:C.jsx(Oa,{size:16,className:"text-gray-500"})}),C.jsx("input",{id:"date",type:"date",value:g,onChange:e=>p(e.target.value),className:"w-full pl-10 p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})]})]}),C.jsxs("div",{className:"flex justify-end space-x-3 mt-2",children:[C.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:"Cancel"}),C.jsx("button",{type:"button",onClick:()=>{i.trim()&&(r(i,a,g,l,d,u),t())},disabled:!i.trim(),className:"px-4 py-2 rounded-lg transition-colors duration-200 "+(i.trim()?"bg-indigo-600 hover:bg-indigo-700 text-white":"bg-gray-200 text-gray-400 cursor-not-allowed"),children:"Save Task"})]})]})]})},el=({task:t})=>{const{markTaskComplete:s,removeTask:r}=zs(),[i,n]=e.useState(!1),l=()=>{s(t.id)};return C.jsx(a.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,height:0},className:"relative bg-white rounded-lg shadow-sm border overflow-hidden "+(t.completed?"border-gray-100":"border-gray-200"),children:C.jsxs("div",{className:"flex items-start p-4",children:[C.jsx("button",{onClick:l,disabled:t.completed,className:"flex-shrink-0 w-6 h-6 mr-3 mt-0.5 rounded-full flex items-center justify-center border "+(t.completed?"bg-green-500 border-green-500 text-white cursor-default":"border-gray-300 hover:border-indigo-500 hover:bg-indigo-50"),"aria-label":t.completed?"Task completed":"Mark as complete",children:t.completed&&C.jsx($a,{size:14})}),C.jsxs("div",{className:"flex-1 mr-3",children:[C.jsx("div",{className:"flex items-center mb-1",children:C.jsx("h4",{className:"font-medium "+(t.completed?"line-through text-gray-500":"text-gray-800"),children:t.title})}),C.jsx("p",{className:"text-sm mb-2 "+(t.completed?"line-through text-gray-400":"text-gray-600"),children:t.description}),C.jsxs("div",{className:"flex items-center text-xs text-gray-500 space-x-3",children:[t.timeEstimate&&C.jsxs("div",{className:"flex items-center",children:[C.jsx(La,{size:12,className:"mr-1"}),C.jsxs("span",{children:[t.timeEstimate," min"]})]}),C.jsxs("div",{className:"flex items-center",children:[(e=>{switch(e){case"self-care":return C.jsx("span",{className:"text-purple-500",children:""});case"physical":return C.jsx("span",{className:"text-green-500",children:""});case"social":return C.jsx("span",{className:"text-blue-500",children:""});case"productive":return C.jsx("span",{className:"text-amber-500",children:""});case"recovery":return C.jsx("span",{className:"text-red-500",children:""});default:return C.jsx("span",{className:"text-gray-500",children:""})}})(t.category),C.jsx("span",{className:"ml-1 capitalize",children:t.category})]}),C.jsx("div",{className:`px-2 py-0.5 rounded-full text-xs ${(e=>{switch(e){case"high":return"bg-red-100 text-red-800 border-red-200";case"medium":return"bg-amber-100 text-amber-800 border-amber-200";case"low":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(t.priority)}`,children:t.priority})]})]}),C.jsxs("div",{className:"relative flex-shrink-0",children:[C.jsx("button",{onClick:()=>{n(!i)},className:"p-1 rounded-full hover:bg-gray-100",children:C.jsx(Va,{size:16,className:"text-gray-500"})}),C.jsx(o,{children:i&&C.jsxs(a.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"absolute right-0 top-full mt-1 bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden z-10 w-32",children:[!t.completed&&C.jsxs("button",{onClick:l,className:"w-full px-3 py-2 text-left text-sm flex items-center hover:bg-gray-50",children:[C.jsx(Ra,{size:14,className:"mr-2 text-green-500"}),"Complete"]}),C.jsxs("button",{onClick:()=>{r(t.id)},className:"w-full px-3 py-2 text-left text-sm flex items-center text-red-600 hover:bg-red-50",children:[C.jsx(no,{size:14,className:"mr-2"}),"Delete"]})]})})]})]})})},tl=()=>{const{tasks:t,insights:s,markInsightSeen:r}=zs(),[i,n]=e.useState(!1),[l,d]=e.useState(us()),[h,u]=e.useState([]),[m,g]=e.useState(0);e.useEffect((()=>{const e=s.filter((e=>!e.shown));u(e)}),[s]);const p=t.filter((e=>e.date===l)).sort(((e,t)=>{if(e.completed!==t.completed)return e.completed?1:-1;const s={high:0,medium:1,low:2};return s[e.priority]-s[t.priority]})),f=p.filter((e=>e.completed)),y=p.filter((e=>!e.completed));return C.jsxs("div",{className:"max-w-3xl mx-auto",children:[C.jsx(o,{children:h.length>0&&C.jsx(a.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"mb-6",children:C.jsx(xo,{insight:h[m],onDismiss:()=>{h.length>0&&m<h.length&&r(h[m].id),m<h.length-1?g(m+1):(g(0),u(h.filter((e=>!e.shown))))},total:h.length,current:m+1})})}),C.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[C.jsxs("div",{children:[C.jsx("h2",{className:"text-xl font-semibold",children:"Daily Structure"}),C.jsx("p",{className:"text-gray-600 text-sm",children:"Having a structured day helps build recovery momentum"})]}),C.jsxs("div",{className:"flex items-center space-x-2",children:[C.jsx("button",{onClick:()=>d(us()),className:"px-3 py-1.5 text-sm rounded-lg transition-colors duration-200 "+(l===us()?"bg-indigo-100 text-indigo-700 font-medium":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"Today"}),C.jsxs("button",{onClick:()=>n(!0),className:"flex items-center gap-1 px-3 py-1.5 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors duration-200 shadow-sm text-sm",children:[C.jsx(Za,{size:16}),C.jsx("span",{children:"Add Task"})]})]})]}),C.jsx(o,{children:i&&C.jsx(a.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mb-8",children:C.jsx(Qo,{onClose:()=>n(!1),selectedDate:l})})}),0===p.length?C.jsxs("div",{className:"text-center py-12 bg-white rounded-xl shadow-sm border border-gray-200",children:[C.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full mx-auto flex items-center justify-center mb-4",children:C.jsx(Oa,{size:24,className:"text-gray-400"})}),C.jsxs("h3",{className:"text-lg font-medium text-gray-800 mb-1",children:["No tasks for ",l===us()?"today":c(new Date(l),"MMMM d, yyyy")]}),C.jsx("p",{className:"text-gray-500 mb-4",children:"Structure your day with meaningful activities"}),C.jsx("button",{onClick:()=>n(!0),className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors duration-200",children:"Add Your First Task"})]}):C.jsxs("div",{className:"space-y-6",children:[y.length>0&&C.jsxs("div",{children:[C.jsx("h3",{className:"text-lg font-medium mb-3",children:"Pending Tasks"}),C.jsx("div",{className:"space-y-2",children:y.map((e=>C.jsx(el,{task:e},e.id)))})]}),f.length>0&&C.jsxs("div",{children:[C.jsx("h3",{className:"text-lg font-medium mb-3",children:"Completed Tasks"}),C.jsx("div",{className:"space-y-2 opacity-75",children:f.map((e=>C.jsx(el,{task:e},e.id)))})]})]}),C.jsxs("div",{className:"mt-8 p-5 bg-indigo-50 rounded-lg border border-indigo-100",children:[C.jsx("h3",{className:"font-medium text-indigo-900 mb-2",children:"Recovery Perspective"}),C.jsx("p",{className:"text-indigo-700 text-sm italic",children:"\"Recovery isn't about reaching a destination of constant happiness. It's about building the capacity to experience the full range of human emotions without being overwhelmed by them or needing to escape them.\""})]})]})};class sl extends e.Component{constructor(){super(...arguments),this.state={hasError:!1,error:null},this.handleReset=()=>{this.setState({hasError:!1,error:null}),window.location.reload()}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){}render(){return this.state.hasError?C.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:C.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6 text-center",children:[C.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:C.jsx(Na,{className:"w-8 h-8 text-red-600"})}),C.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Oops! Something went wrong"}),C.jsx("p",{className:"text-gray-600 mb-6",children:"We're sorry, but something unexpected happened. Don't worry, your data is safe."}),C.jsxs("button",{onClick:this.handleReset,className:"inline-flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:[C.jsx(Qa,{className:"w-4 h-4 mr-2"}),"Reload App"]}),!1]})}):this.props.children}}const rl=()=>{const[t,s]=e.useState(null),[r,i]=e.useState(!1);e.useEffect((()=>{const e=e=>{e.preventDefault(),s(e),i(!0)};return window.addEventListener("beforeinstallprompt",e),()=>{window.removeEventListener("beforeinstallprompt",e)}}),[]);const n=()=>{i(!1),localStorage.setItem("installPromptDismissed","true")};return r?C.jsx(o,{children:C.jsx(a.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:50},className:"fixed bottom-20 left-4 right-4 bg-white rounded-lg shadow-lg border border-gray-200 p-4 z-50 md:left-auto md:right-4 md:bottom-4 md:max-w-sm",children:C.jsxs("div",{className:"flex justify-between items-start",children:[C.jsxs("div",{className:"flex-1",children:[C.jsx("h3",{className:"font-medium text-gray-800 mb-1",children:"Install Soberi.ai"}),C.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Add Soberi to your home screen for easier access and a better experience."}),C.jsxs("div",{className:"flex space-x-2",children:[C.jsxs("button",{onClick:()=>{t&&(t.prompt(),t.userChoice.then((e=>{e.outcome,s(null),i(!1)})))},className:"flex items-center px-3 py-1.5 bg-indigo-600 text-white rounded-lg text-sm",children:[C.jsx(Ma,{size:16,className:"mr-1"}),"Install"]}),C.jsx("button",{onClick:n,className:"px-3 py-1.5 border border-gray-300 text-gray-700 rounded-lg text-sm",children:"Maybe Later"})]})]}),C.jsx("button",{onClick:n,className:"ml-2 text-gray-400 hover:text-gray-600",children:C.jsx(uo,{size:18})})]})})}):null},il=({isOpen:e,onClose:t})=>C.jsx(o,{children:e&&C.jsx(a.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:C.jsxs(a.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-xl shadow-xl max-w-lg w-full max-h-[80vh] overflow-hidden",children:[C.jsx("div",{className:"flex justify-between items-center border-b p-4",children:C.jsx("h3",{className:"text-lg font-semibold",children:"Before You Begin"})}),C.jsxs("div",{className:"p-4 overflow-y-auto max-h-[calc(80vh-120px)]",children:[C.jsx("p",{className:"text-gray-600 mb-4",children:"Soberi.ai is a supportive companion for your recovery journey. Please note:"}),C.jsx(go,{type:"full",onClose:t}),C.jsx("div",{className:"mt-4 text-xs text-gray-500",children:'By clicking "I Understand", you confirm that you are at least 18 years old and agree to these terms.'})]})]})})}),nl=({children:e,fallback:t=C.jsx("div",{className:"flex items-center justify-center min-h-screen",children:C.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md max-w-md w-full",children:[C.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Please Sign In"}),C.jsx("p",{className:"text-gray-600 mb-6",children:"You need to be signed in to access this page."})]})})})=>{const{user:s,loading:r}=ba();return r?C.jsx("div",{className:"flex items-center justify-center min-h-screen",children:C.jsx("div",{className:"animate-pulse text-lg text-gray-600",children:"Loading..."})}):s?C.jsx(C.Fragment,{children:e}):C.jsx(C.Fragment,{children:t})},al=()=>{var t;const{user:s,loading:r}=ba(),[i,n]=e.useState("none");return r?C.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-50 p-4",children:[C.jsx("div",{className:"w-16 h-16 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),C.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]}):s?C.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-50 p-4",children:C.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-md max-w-md w-full",children:[C.jsxs("div",{className:"text-center mb-6",children:[C.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"Welcome Back!"}),C.jsxs("p",{className:"text-gray-600 mt-2",children:["You're already signed in as ",(null==(t=s.user_metadata)?void 0:t.full_name)||s.email]})]}),C.jsx("div",{className:"flex justify-center",children:C.jsx("button",{onClick:()=>window.location.href="/",className:"bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-6 rounded-lg transition-colors duration-200",children:"Go to Dashboard"})})]})}):C.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gradient-to-br from-indigo-50 via-white to-indigo-100 p-4",children:C.jsxs("div",{className:"bg-white/90 p-8 rounded-2xl shadow-xl max-w-md w-full border border-indigo-100 relative",children:[C.jsxs("div",{className:"text-center mb-8",children:[C.jsx("div",{className:"flex justify-center mb-4",children:C.jsx("span",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-indigo-100",children:C.jsx(so,{size:36,className:"text-indigo-500"})})}),C.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 mb-2",children:"Welcome to Soberi.ai"}),C.jsx("p",{className:"text-gray-600 text-base mb-2",children:"Your private, AI-powered recovery companion."}),C.jsx("p",{className:"text-indigo-700 text-sm font-medium",children:"First 10 insights and chats are free. No personal data stored except your email and payment status."})]}),C.jsxs("div",{className:"grid grid-cols-1 gap-4 mb-8",children:[C.jsxs("div",{className:"flex items-center gap-3 bg-indigo-50 rounded-lg p-3",children:[C.jsx(Ga,{size:20,className:"text-indigo-500"}),C.jsx("span",{className:"text-gray-700 text-sm",children:"Chat with a supportive AI, anytime"})]}),C.jsxs("div",{className:"flex items-center gap-3 bg-indigo-50 rounded-lg p-3",children:[C.jsx(lo,{size:20,className:"text-indigo-500"}),C.jsx("span",{className:"text-gray-700 text-sm",children:"Track your progress and daily check-ins"})]}),C.jsxs("div",{className:"flex items-center gap-3 bg-indigo-50 rounded-lg p-3",children:[C.jsx(Ja,{size:20,className:"text-indigo-500"}),C.jsx("span",{className:"text-gray-700 text-sm",children:"Your data is encrypted and stays on your device"})]})]}),C.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[C.jsx(po,{className:"w-full text-lg py-3"}),C.jsxs("div",{className:"text-xs text-gray-500 text-center",children:["By signing in, you agree to our"," ",C.jsx("button",{className:"text-indigo-600 hover:underline focus:outline-none",onClick:()=>n("tos"),type:"button",children:"Terms of Service"})," ","and"," ",C.jsx("button",{className:"text-indigo-600 hover:underline focus:outline-none",onClick:()=>n("privacy"),type:"button",children:"Privacy Policy"}),"."]})]}),"none"!==i&&C.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30",children:C.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-xs w-full text-sm relative",children:[C.jsx("button",{className:"absolute top-2 right-2 text-gray-400 hover:text-gray-600",onClick:()=>n("none"),"aria-label":"Close",children:""}),"tos"===i&&C.jsxs("div",{children:[C.jsx("h3",{className:"font-semibold mb-2",children:"Terms of Service"}),C.jsx("p",{children:"By using Soberi.ai, you agree to use the app for personal recovery support only. Do not use the app for unlawful or harmful purposes. Continued use means you accept any changes to these terms."})]}),"privacy"===i&&C.jsxs("div",{children:[C.jsx("h3",{className:"font-semibold mb-2",children:"Privacy Policy"}),C.jsx("p",{children:"Soberi.ai only stores your email and payment status on our servers. All other data is encrypted and stays on your device. We do not sell or share your personal information."})]})]})})]})})},ol=({children:t})=>{const[s,r]=e.useState(!1),[i,n]=e.useState(null),[a,o]=e.useState("");return e.useEffect((()=>{(async()=>{try{o("Initializing storage...");const e=localStorage.getItem("Soberi_userId");if(!e)return await Yt.init(),void r(!0);await Yt.init();const t=null!==localStorage.getItem("Soberiai-storage"),s=null!==await Yt.getAppState(e);if(t&&!s){o("Migrating data to improved storage..."),await(e=>Yt.migrateFromLocalStorage(e))(e);const t=["Soberi_userId","sb-auth-token"];Object.keys(localStorage).forEach((e=>{t.some((t=>e.includes(t)))||localStorage.removeItem(e)})),o("Migration complete!")}await zs.getState().initializeStore(),r(!0)}catch(e){n(e instanceof Error?e.message:"Failed to initialize storage")}})()}),[]),i?C.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center p-4",children:C.jsxs("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-6 max-w-md w-full",children:[C.jsx("h2",{className:"text-xl font-semibold text-red-400 mb-2",children:"Storage Error"}),C.jsx("p",{className:"text-gray-300 mb-4",children:i}),C.jsx("button",{onClick:()=>window.location.reload(),className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors",children:"Reload Page"})]})}):s?C.jsx(C.Fragment,{children:t}):C.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:C.jsxs("div",{className:"text-center",children:[C.jsx(Wa,{className:"w-12 h-12 text-purple-400 animate-spin mx-auto mb-4"}),C.jsx("p",{className:"text-gray-300",children:a||"Loading..."})]})})};
/*! Capacitor: https://capacitorjs.com/ - MIT License */
var ll,cl;(cl=ll||(ll={})).Unimplemented="UNIMPLEMENTED",cl.Unavailable="UNAVAILABLE";class dl extends Error{constructor(e,t,s){super(e),this.message=e,this.code=t,this.data=s}}const hl=e=>{const t=e.CapacitorCustomPlatform||null,s=e.Capacitor||{},r=s.Plugins=s.Plugins||{},i=()=>null!==t?t.name:(e=>{var t,s;return(null==e?void 0:e.androidBridge)?"android":(null===(s=null===(t=null==e?void 0:e.webkit)||void 0===t?void 0:t.messageHandlers)||void 0===s?void 0:s.bridge)?"ios":"web"})(e),n=e=>{var t;return null===(t=s.PluginHeaders)||void 0===t?void 0:t.find((t=>t.name===e))},a=new Map;return s.convertFileSrc||(s.convertFileSrc=e=>e),s.getPlatform=i,s.handleError=t=>e.console.error(t),s.isNativePlatform=()=>"web"!==i(),s.isPluginAvailable=e=>{const t=a.get(e);return!!(null==t?void 0:t.platforms.has(i()))||!!n(e)},s.registerPlugin=(e,o={})=>{const l=a.get(e);if(l)return l.proxy;const c=i(),d=n(e);let h;const u=r=>{let i;const n=(...n)=>{const a=(async()=>(!h&&c in o?h=h="function"==typeof o[c]?await o[c]():o[c]:null!==t&&!h&&"web"in o&&(h=h="function"==typeof o.web?await o.web():o.web),h))().then((t=>{const a=((t,r)=>{var i,n;if(!d){if(t)return null===(n=t[r])||void 0===n?void 0:n.bind(t);throw new dl(`"${e}" plugin is not implemented on ${c}`,ll.Unimplemented)}{const n=null==d?void 0:d.methods.find((e=>r===e.name));if(n)return"promise"===n.rtype?t=>s.nativePromise(e,r.toString(),t):(t,i)=>s.nativeCallback(e,r.toString(),t,i);if(t)return null===(i=t[r])||void 0===i?void 0:i.bind(t)}})(t,r);if(a){const e=a(...n);return i=null==e?void 0:e.remove,e}throw new dl(`"${e}.${r}()" is not implemented on ${c}`,ll.Unimplemented)}));return"addListener"===r&&(a.remove=async()=>i()),a};return n.toString=()=>`${r.toString()}() { [capacitor code] }`,Object.defineProperty(n,"name",{value:r,writable:!1,configurable:!1}),n},m=u("addListener"),g=u("removeListener"),p=(e,t)=>{const s=m({eventName:e},t),r=async()=>{const r=await s;g({eventName:e,callbackId:r},t)},i=new Promise((e=>s.then((()=>e({remove:r})))));return i.remove=async()=>{await r()},i},f=new Proxy({},{get(e,t){switch(t){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return d?p:m;case"removeListener":return g;default:return u(t)}}});return r[e]=f,a.set(e,{name:e,proxy:f,platforms:new Set([...Object.keys(o),...d?[c]:[]])}),f},s.Exception=dl,s.DEBUG=!!s.DEBUG,s.isLoggingEnabled=!!s.isLoggingEnabled,s},ul=(e=>e.Capacitor=hl(e))("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}),ml=ul.registerPlugin;class gl{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let s=!1;this.listeners[e]||(this.listeners[e]=[],s=!0),this.listeners[e].push(t);const r=this.windowListeners[e];r&&!r.registered&&this.addWindowListener(r),s&&this.sendRetainedArgumentsForEvent(e);return Promise.resolve({remove:async()=>this.removeListener(e,t)})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,s){const r=this.listeners[e];if(r)r.forEach((e=>e(t)));else if(s){let s=this.retainedEventArguments[e];s||(s=[]),s.push(t),this.retainedEventArguments[e]=s}}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:e=>{this.notifyListeners(t,e)}}}unimplemented(e="not implemented"){return new ul.Exception(e,ll.Unimplemented)}unavailable(e="not available"){return new ul.Exception(e,ll.Unavailable)}async removeListener(e,t){const s=this.listeners[e];if(!s)return;const r=s.indexOf(t);this.listeners[e].splice(r,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach((t=>{this.notifyListeners(e,t)})))}}const pl=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),fl=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class yl extends gl{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach((e=>{if(e.length<=0)return;let[s,r]=e.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=fl(s).trim(),r=fl(r).trim(),t[s]=r})),t}async setCookie(e){try{const t=pl(e.key),s=pl(e.value),r=`; expires=${(e.expires||"").replace("expires=","")}`,i=(e.path||"/").replace("path=",""),n=null!=e.url&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${s||""}${r}; path=${i}; ${n};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}ml("CapacitorCookies",{web:()=>new yl});const xl=(e,t={})=>{const s=Object.assign({method:e.method||"GET",headers:e.headers},t),r=((e={})=>{const t=Object.keys(e);return Object.keys(e).map((e=>e.toLocaleLowerCase())).reduce(((s,r,i)=>(s[r]=e[t[i]],s)),{})})(e.headers)["content-type"]||"";if("string"==typeof e.data)s.body=e.data;else if(r.includes("application/x-www-form-urlencoded")){const t=new URLSearchParams;for(const[s,r]of Object.entries(e.data||{}))t.set(s,r);s.body=t.toString()}else if(r.includes("multipart/form-data")||e.data instanceof FormData){const t=new FormData;if(e.data instanceof FormData)e.data.forEach(((e,s)=>{t.append(s,e)}));else for(const s of Object.keys(e.data))t.append(s,e.data[s]);s.body=t;const r=new Headers(s.headers);r.delete("content-type"),s.headers=r}else(r.includes("application/json")||"object"==typeof e.data)&&(s.body=JSON.stringify(e.data));return s};class vl extends gl{async request(e){const t=xl(e,e.webFetchExtra),s=((e,t=!0)=>e?Object.entries(e).reduce(((e,s)=>{const[r,i]=s;let n,a;return Array.isArray(i)?(a="",i.forEach((e=>{n=t?encodeURIComponent(e):e,a+=`${r}=${n}&`})),a.slice(0,-1)):(n=t?encodeURIComponent(i):i,a=`${r}=${n}`),`${e}&${a}`}),"").substr(1):null)(e.params,e.shouldEncodeUrlParams),r=s?`${e.url}?${s}`:e.url,i=await fetch(r,t),n=i.headers.get("content-type")||"";let a,o,{responseType:l="text"}=i.ok?e:{};switch(n.includes("application/json")&&(l="json"),l){case"arraybuffer":case"blob":o=await i.blob(),a=await(async e=>new Promise(((t,s)=>{const r=new FileReader;r.onload=()=>{const e=r.result;t(e.indexOf(",")>=0?e.split(",")[1]:e)},r.onerror=e=>s(e),r.readAsDataURL(e)})))(o);break;case"json":a=await i.json();break;default:a=await i.text()}const c={};return i.headers.forEach(((e,t)=>{c[t]=e})),{data:a,headers:c,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}ml("CapacitorHttp",{web:()=>new vl});const bl=ml("App",{web:()=>I((()=>import("./web-CR1bmKxy.js")),__vite__mapDeps([2,1,3])).then((e=>new e.AppWeb))});function wl(){const{activeTab:t,setActiveTab:s}=zs(),{refreshUserStatus:r}=ba(),[i,n]=e.useState(!1);e.useEffect((()=>{if(document.title="Soberi.ai - Your Recovery Companion",ul.isNativePlatform()){const e=bl.addListener("appStateChange",(({isActive:e})=>{e&&r()})),t=bl.addListener("backButton",(({canGoBack:e})=>{e||bl.exitApp()}));return()=>{e.remove(),t.remove()}}const e=new URLSearchParams(window.location.search),t=e.get("tab");if("true"===e.get("payment_success")&&(r(),window.history.replaceState({},document.title,window.location.pathname)),t){["chat","checkin","journal","progress","resources","tasks"].includes(t)&&s(t)}"true"===localStorage.getItem("Soberi_has_seen_disclaimer")||n(!0)}),[s,r]);return C.jsx(sl,{children:C.jsx(ol,{children:C.jsx(nl,{fallback:C.jsx(al,{}),children:C.jsxs("div",{className:"font-sans bg-gray-50 flex flex-col min-h-screen w-full "+(ul.isNativePlatform()?"safe-area-inset":""),children:[C.jsx(bo,{children:(()=>{switch(t){case"chat":default:return C.jsx(Eo,{});case"checkin":return C.jsx(Po,{});case"journal":return C.jsx(Do,{});case"progress":return C.jsx(Jo,{});case"resources":return C.jsx(Zo,{});case"tasks":return C.jsx(tl,{})}})()}),!ul.isNativePlatform()&&C.jsx(rl,{}),C.jsx(il,{isOpen:i,onClose:()=>{n(!1),localStorage.setItem("Soberi_has_seen_disclaimer","true")}})]})})})})}N(document.getElementById("root")).render(C.jsx(e.StrictMode,{children:C.jsx(wa,{children:C.jsx(wl,{})})})),"serviceWorker"in navigator&&(window.addEventListener("load",(async()=>{try{const e=await navigator.serviceWorker.register("/service-worker.js",{scope:"/"});e.addEventListener("updatefound",(()=>{const t=e.installing;t&&t.addEventListener("statechange",(()=>{"installed"===t.state&&navigator.serviceWorker.controller&&function(){var e;const t=document.createElement("div");t.className="update-notification",t.innerHTML="\n  \n  ",document.body.appendChild(t),null==(e=document.getElementById("update-app"))||e.addEventListener("click",(()=>{window.location.reload()}))}()}))})),async function(){"Notification"in window&&"granted"===await Notification.requestPermission()&&async function(){try{await navigator.serviceWorker.ready}catch(e){}}()}()}catch(e){}})),navigator.serviceWorker.addEventListener("message",(e=>{e.data.type})),window.addEventListener("online",(()=>{navigator.serviceWorker.controller&&navigator.serviceWorker.ready.then((e=>{if("sync"in e){const s=e;try{s.sync.register("sync-checkins"),s.sync.register("sync-journal"),s.sync.register("sync-tasks")}catch(t){}}}))})),window.addEventListener("offline",(()=>{!function(){const e=document.createElement("div");e.className="offline-notification",e.innerHTML='\n    <div class="p-3 bg-amber-600 text-white fixed top-0 left-0 right-0 text-center z-50">\n      <p>You\'re offline. Some features may be limited.</p>\n    </div>\n  ',document.querySelector(".offline-notification")||(document.body.appendChild(e),setTimeout((()=>{e.remove()}),5e3))}()})));export{gl as W};
//# sourceMappingURL=index-CvKR66Vo.js.map
